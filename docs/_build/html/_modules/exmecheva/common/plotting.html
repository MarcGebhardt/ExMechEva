<!DOCTYPE html>
<html class="writer-html5" lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>exmecheva.common.plotting &mdash; ExMechEva 0.1.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css" />
      <link rel="stylesheet" type="text/css" href="../../../_static/css/theme.css" />

  
  <!--[if lt IE 9]>
    <script src="../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
        <script src="../../../_static/jquery.js"></script>
        <script src="../../../_static/underscore.js"></script>
        <script src="../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../../../_static/doctools.js"></script>
        <script src="../../../_static/sphinx_highlight.js"></script>
    <script src="../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../../index.html" class="icon icon-home">
            ExMechEva
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../modules.html">ExMechEva</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">ExMechEva</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../../index.html">Module code</a></li>
      <li class="breadcrumb-item active">exmecheva.common.plotting</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for exmecheva.common.plotting</h1><div class="highlight"><pre>
<span></span><span class="c1"># -*- coding: utf-8 -*-</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Plotting functionality.</span>

<span class="sd">@author: MarcGebhardt</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>

<span class="kn">from</span> <span class="nn">.analyze</span> <span class="kn">import</span> <span class="p">(</span><span class="n">normalize</span><span class="p">,</span> <span class="n">threshhold_setter</span><span class="p">)</span>

<span class="c1">#%% core</span>
<div class="viewcode-block" id="plt_handle_suffix"><a class="viewcode-back" href="../../../exmecheva.common.html#exmecheva.common.plotting.plt_handle_suffix">[docs]</a><span class="k">def</span> <span class="nf">plt_handle_suffix</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="s1">&#39;foo&#39;</span><span class="p">,</span> <span class="n">tight</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">show</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> 
                      <span class="n">save</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">s_types</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;pdf&quot;</span><span class="p">,</span><span class="s2">&quot;png&quot;</span><span class="p">],</span> 
                      <span class="n">clear</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">close</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Handler for end of plotting procedure.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    fig : matplotlib.pyplot.figure</span>
<span class="sd">        Figure instance.</span>
<span class="sd">    path : str, optional</span>
<span class="sd">        Save path. The default is &#39;foo&#39;.</span>
<span class="sd">    tight : bool, optional</span>
<span class="sd">        Tight the layout. The default is True.</span>
<span class="sd">    show : bool, optional</span>
<span class="sd">        Show figure. The default is True.</span>
<span class="sd">    save : bool, optional</span>
<span class="sd">        Save figure. The default is True.</span>
<span class="sd">    s_types : list of str, optional</span>
<span class="sd">        Types in which the figure is saved. The default is [&quot;pdf&quot;,&quot;png&quot;].</span>
<span class="sd">    clear : bool, optional</span>
<span class="sd">        Clear figure instance. The default is True.</span>
<span class="sd">    close : bool, optional</span>
<span class="sd">        Close figure window. The default is True.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    None.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">tight</span><span class="p">:</span> <span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>  <span class="c1"># otherwise the right y-label is slightly clipped</span>
    <span class="k">if</span> <span class="n">show</span><span class="p">:</span>  <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">save</span> <span class="ow">and</span> <span class="ow">not</span> <span class="p">(</span><span class="n">path</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">st</span> <span class="ow">in</span> <span class="n">s_types</span><span class="p">:</span>
            <span class="c1"># plt.savefig(path+&#39;.&#39;+st)</span>
            <span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">path</span><span class="o">+</span><span class="s1">&#39;.&#39;</span><span class="o">+</span><span class="n">st</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">clear</span><span class="p">:</span> <span class="n">fig</span><span class="o">.</span><span class="n">clf</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">close</span><span class="p">:</span> <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span></div>

<div class="viewcode-block" id="tick_label_renamer"><a class="viewcode-back" href="../../../exmecheva.common.html#exmecheva.common.plotting.tick_label_renamer">[docs]</a><span class="k">def</span> <span class="nf">tick_label_renamer</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">renamer</span><span class="o">=</span><span class="p">{},</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Renames labels on axis (can be switched [&#39;both&#39;,&#39;x&#39;,&#39;y&#39;]).&quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">get_ren_label</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">renamer</span><span class="p">,</span> <span class="n">axis</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">axis</span><span class="o">==</span><span class="s1">&#39;x&#39;</span><span class="p">:</span>
            <span class="n">label</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_xticklabels</span><span class="p">()</span>
        <span class="k">elif</span> <span class="n">axis</span><span class="o">==</span><span class="s1">&#39;y&#39;</span><span class="p">:</span>
            <span class="n">label</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_yticklabels</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s1">&#39;Axis </span><span class="si">%s</span><span class="s1"> not implemented!&#39;</span><span class="o">%</span><span class="n">axis</span><span class="p">)</span>
        <span class="n">label</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="n">item</span><span class="o">.</span><span class="n">get_text</span><span class="p">()</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">label</span><span class="p">])</span>
        <span class="n">label</span> <span class="o">=</span> <span class="n">label</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">renamer</span><span class="p">)</span><span class="o">.</span><span class="n">values</span>
        <span class="k">if</span> <span class="n">axis</span><span class="o">==</span><span class="s1">&#39;x&#39;</span><span class="p">:</span>
            <span class="n">label</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="n">label</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">axis</span><span class="o">==</span><span class="s1">&#39;y&#39;</span><span class="p">:</span>
            <span class="n">label</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">(</span><span class="n">label</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s1">&#39;Axis </span><span class="si">%s</span><span class="s1"> not implemented!&#39;</span><span class="o">%</span><span class="n">axis</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">axis</span><span class="o">==</span><span class="s1">&#39;both&#39;</span><span class="p">:</span>
        <span class="n">get_ren_label</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">renamer</span><span class="o">=</span><span class="n">renamer</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
        <span class="n">get_ren_label</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">renamer</span><span class="o">=</span><span class="n">renamer</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">axis</span><span class="o">==</span><span class="s1">&#39;x&#39;</span><span class="p">:</span>
        <span class="n">get_ren_label</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">renamer</span><span class="o">=</span><span class="n">renamer</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">axis</span><span class="o">==</span><span class="s1">&#39;y&#39;</span><span class="p">:</span>
        <span class="n">get_ren_label</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">renamer</span><span class="o">=</span><span class="n">renamer</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s1">&#39;Axis </span><span class="si">%s</span><span class="s1"> not implemented!&#39;</span><span class="o">%</span><span class="n">axis</span><span class="p">)</span></div>
        
<div class="viewcode-block" id="tick_legend_renamer"><a class="viewcode-back" href="../../../exmecheva.common.html#exmecheva.common.plotting.tick_legend_renamer">[docs]</a><span class="k">def</span> <span class="nf">tick_legend_renamer</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">renamer</span><span class="o">=</span><span class="p">{},</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Renames legend entries on axis and optionally insert a title&quot;&quot;&quot;</span>
    <span class="n">legend</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">get_legend</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">title</span> <span class="o">!=</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
        <span class="n">legend</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">legend</span><span class="o">.</span><span class="n">texts</span><span class="p">:</span>
        <span class="n">i</span><span class="o">.</span><span class="n">set_text</span><span class="p">(</span><span class="n">renamer</span><span class="p">[</span><span class="n">i</span><span class="o">.</span><span class="n">get_text</span><span class="p">()])</span></div>
    
<div class="viewcode-block" id="tick_label_inserter"><a class="viewcode-back" href="../../../exmecheva.common.html#exmecheva.common.plotting.tick_label_inserter">[docs]</a><span class="k">def</span> <span class="nf">tick_label_inserter</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">ins</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Inserts a string to tick labels on axis (can be switched [&#39;both&#39;,&#39;x&#39;,&#39;y&#39;]).&quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">get_ren_label</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="n">ins</span><span class="p">,</span> <span class="n">axis</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">axis</span><span class="o">==</span><span class="s1">&#39;x&#39;</span><span class="p">:</span>
            <span class="n">label</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_xticklabels</span><span class="p">()</span>
        <span class="k">elif</span> <span class="n">axis</span><span class="o">==</span><span class="s1">&#39;y&#39;</span><span class="p">:</span>
            <span class="n">label</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_yticklabels</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s1">&#39;Axis </span><span class="si">%s</span><span class="s1"> not implemented!&#39;</span><span class="o">%</span><span class="n">axis</span><span class="p">)</span>
        <span class="n">label</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="n">item</span><span class="o">.</span><span class="n">get_text</span><span class="p">()</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">label</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">pos</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">label</span> <span class="o">=</span> <span class="n">label</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="s1">&#39;</span><span class="si">{}{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ins</span><span class="p">,</span><span class="n">x</span><span class="p">))</span>
        <span class="k">elif</span> <span class="n">pos</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
            <span class="n">label</span> <span class="o">=</span> <span class="n">label</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="s1">&#39;</span><span class="si">{}{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">ins</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">label</span> <span class="o">=</span> <span class="n">label</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="s1">&#39;</span><span class="si">{}{}{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">x</span><span class="p">[:</span><span class="n">pos</span><span class="p">],</span><span class="n">ins</span><span class="p">,</span><span class="n">x</span><span class="p">[</span><span class="n">pos</span><span class="p">:]))</span>
        <span class="n">label</span> <span class="o">=</span> <span class="n">label</span><span class="o">.</span><span class="n">values</span>
        <span class="k">if</span> <span class="n">axis</span><span class="o">==</span><span class="s1">&#39;x&#39;</span><span class="p">:</span>
            <span class="n">label</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="n">label</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">axis</span><span class="o">==</span><span class="s1">&#39;y&#39;</span><span class="p">:</span>
            <span class="n">label</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">(</span><span class="n">label</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s1">&#39;Axis </span><span class="si">%s</span><span class="s1"> not implemented!&#39;</span><span class="o">%</span><span class="n">axis</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">axis</span><span class="o">==</span><span class="s1">&#39;both&#39;</span><span class="p">:</span>
        <span class="n">get_ren_label</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="n">pos</span><span class="p">,</span> <span class="n">ins</span><span class="o">=</span><span class="n">ins</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
        <span class="n">get_ren_label</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="n">pos</span><span class="p">,</span> <span class="n">ins</span><span class="o">=</span><span class="n">ins</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">axis</span><span class="o">==</span><span class="s1">&#39;x&#39;</span><span class="p">:</span>
        <span class="n">get_ren_label</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="n">pos</span><span class="p">,</span> <span class="n">ins</span><span class="o">=</span><span class="n">ins</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">axis</span><span class="o">==</span><span class="s1">&#39;y&#39;</span><span class="p">:</span>
        <span class="n">get_ren_label</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="n">pos</span><span class="p">,</span> <span class="n">ins</span><span class="o">=</span><span class="n">ins</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s1">&#39;Axis </span><span class="si">%s</span><span class="s1"> not implemented!&#39;</span><span class="o">%</span><span class="n">axis</span><span class="p">)</span></div>
        
<div class="viewcode-block" id="plt_add_DaAnno"><a class="viewcode-back" href="../../../exmecheva.common.html#exmecheva.common.plotting.plt_add_DaAnno">[docs]</a><span class="k">def</span> <span class="nf">plt_add_DaAnno</span><span class="p">(</span><span class="n">mdf</span><span class="p">,</span> <span class="n">x_n</span><span class="p">,</span> <span class="n">y_n</span><span class="p">,</span> <span class="n">VIP</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">xy_standard</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">6</span><span class="p">,</span><span class="mi">6</span><span class="p">),</span>
                   <span class="n">xy_ded</span> <span class="o">=</span> <span class="p">{</span><span class="mi">1</span><span class="p">:(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="mi">2</span><span class="p">:(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="mi">3</span><span class="p">:(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span><span class="mi">4</span><span class="p">:(</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)},</span>
                   <span class="n">pkwargs</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;marker&#39;</span><span class="p">:</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;linestyle&#39;</span><span class="p">:</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="s1">&#39;color&#39;</span><span class="p">:</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> 
                            <span class="s1">&#39;label&#39;</span><span class="p">:</span><span class="s1">&#39;Points of interest&#39;</span><span class="p">},</span>
                   <span class="n">akwargs</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;xycoords&#39;</span><span class="p">:</span><span class="s1">&#39;data&#39;</span><span class="p">,</span> <span class="s1">&#39;textcoords&#39;</span><span class="p">:</span><span class="s1">&#39;offset points&#39;</span><span class="p">,</span>
                            <span class="s1">&#39;ha&#39;</span><span class="p">:</span><span class="s2">&quot;center&quot;</span><span class="p">,</span> <span class="s1">&#39;va&#39;</span><span class="p">:</span><span class="s2">&quot;center&quot;</span><span class="p">}):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Adds data annotations to curve.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    mdf : pd.DataFrame</span>
<span class="sd">        DataFrame of measured data.</span>
<span class="sd">    x_n : string</span>
<span class="sd">        Column name of data to plot on x-axis.</span>
<span class="sd">    y_n : string</span>
<span class="sd">        Column name of data to plot on y-axis.</span>
<span class="sd">    VIP : pd.Series</span>
<span class="sd">        Points of interest (name as index and index of mdf as values).</span>
<span class="sd">    ax : plt.subplot axis, optional</span>
<span class="sd">        Matplotlib axis object to plot. The default is None.</span>
<span class="sd">    xy_standard : tuple of int, optional</span>
<span class="sd">        Standard position of text, coordinates related to data. </span>
<span class="sd">        The default is (-6,6).</span>
<span class="sd">    xy_ded : dict, optional</span>
<span class="sd">        Dictionary with positiioning multipliers to apply to xy_standard. </span>
<span class="sd">        The default is {1:(1,1),2:(-1,1),3:(-1,-1),4:(1,-1)}.</span>
<span class="sd">    pkwargs : dict, optional</span>
<span class="sd">        Keyword arguments for plt.plot. </span>
<span class="sd">        The default is {&#39;marker&#39;:&#39;x&#39;, &#39;linestyle&#39;:&#39;&#39;,&#39;color&#39;:&#39;red&#39;, </span>
<span class="sd">                        &#39;label&#39;:&#39;Points of interest&#39;}.</span>
<span class="sd">    akwargs : TYPE, optional</span>
<span class="sd">        Keyword arguments for plt.annotate. </span>
<span class="sd">        The default is {&#39;xycoords&#39;:&#39;data&#39;, &#39;textcoords&#39;:&#39;offset points&#39;,</span>
<span class="sd">                        &#39;ha&#39;:&quot;center&quot;, &#39;va&#39;:&quot;center&quot;}.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    pd.DataFrame</span>
<span class="sd">        Combined postion and text (for control purposes).</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">recalc_xy</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">xy_ded</span><span class="p">):</span>
        <span class="n">d</span><span class="p">,</span><span class="n">r</span> <span class="o">=</span> <span class="nb">divmod</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="nb">max</span><span class="p">(</span><span class="n">xy_ded</span><span class="o">.</span><span class="n">keys</span><span class="p">()))</span>
        <span class="n">d</span><span class="o">+=</span><span class="mi">1</span>
        <span class="n">mult</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">xy_ded</span><span class="p">[</span><span class="n">r</span><span class="p">],</span><span class="n">d</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">mult</span>
    <span class="n">udf</span><span class="o">=</span><span class="n">mdf</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">VIP</span><span class="p">,[</span><span class="n">x_n</span><span class="p">,</span><span class="n">y_n</span><span class="p">]]</span>
    <span class="n">udf</span><span class="p">[</span><span class="s1">&#39;VIP&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">VIP</span><span class="o">.</span><span class="n">index</span>
    <span class="n">udfg</span><span class="o">=</span><span class="n">udf</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="n">x_n</span><span class="p">,</span><span class="n">y_n</span><span class="p">])</span>
    <span class="n">t2</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([])</span>
    <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">udfg</span><span class="p">:</span>
        <span class="n">tg</span><span class="o">=</span><span class="n">g</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">tg</span><span class="p">[</span><span class="s1">&#39;n&#39;</span><span class="p">]</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">tg</span><span class="p">))</span>
        <span class="n">t2</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">t2</span><span class="p">,</span><span class="n">tg</span><span class="p">])</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">t2</span><span class="p">[</span><span class="s1">&#39;n&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">recalc_xy</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">xy_ded</span><span class="p">),</span><span class="n">xy_standard</span><span class="p">))</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">)</span>
    <span class="n">udf</span><span class="p">[[</span><span class="s1">&#39;xtext&#39;</span><span class="p">,</span><span class="s1">&#39;ytext&#39;</span><span class="p">]]</span><span class="o">=</span><span class="n">t</span>

    <span class="k">if</span> <span class="n">ax</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">udf</span><span class="p">[</span><span class="n">x_n</span><span class="p">],</span> <span class="n">udf</span><span class="p">[</span><span class="n">y_n</span><span class="p">],</span> <span class="o">**</span><span class="n">pkwargs</span><span class="p">)</span>
    <span class="n">j</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int64</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">udf</span><span class="p">[</span><span class="s1">&#39;VIP&#39;</span><span class="p">]:</span>
        <span class="n">j</span><span class="o">+=</span><span class="mi">1</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1">&#39;</span><span class="o">%</span><span class="n">x</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="n">udf</span><span class="p">[</span><span class="n">x_n</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">j</span><span class="p">],</span><span class="n">udf</span><span class="p">[</span><span class="n">y_n</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">j</span><span class="p">]),</span>
                     <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="n">udf</span><span class="p">[</span><span class="s1">&#39;xtext&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">j</span><span class="p">],</span><span class="n">udf</span><span class="p">[</span><span class="s1">&#39;ytext&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">j</span><span class="p">]),</span> <span class="o">**</span><span class="n">akwargs</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">udf</span></div>

<span class="c1">#%% plot analyse</span>
<div class="viewcode-block" id="curve_char_plotter"><a class="viewcode-back" href="../../../exmecheva.common.html#exmecheva.common.plotting.curve_char_plotter">[docs]</a><span class="k">def</span> <span class="nf">curve_char_plotter</span><span class="p">(</span><span class="n">cps</span><span class="p">,</span> <span class="n">cip</span><span class="p">,</span> <span class="n">dfp</span><span class="p">,</span> <span class="n">df</span><span class="p">,</span>
                       <span class="n">head</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> 
                       <span class="n">xlabel</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ylabel_l</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ylabel_r</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> 
                       <span class="n">cco</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;y&#39;</span><span class="p">:</span><span class="s1">&#39;m&#39;</span><span class="p">},</span>
                       <span class="n">cco_sc</span><span class="o">=</span><span class="p">{},</span>
                       <span class="n">ccd</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;DQ1&#39;</span><span class="p">:</span><span class="s1">&#39;b&#39;</span><span class="p">,</span><span class="s1">&#39;DQ2&#39;</span><span class="p">:</span><span class="s1">&#39;g&#39;</span><span class="p">,</span><span class="s1">&#39;DQ3&#39;</span><span class="p">:</span><span class="s1">&#39;y&#39;</span><span class="p">},</span>
                       <span class="n">ccd_sc</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;DQ1_sc&#39;</span><span class="p">:</span><span class="s1">&#39;b&#39;</span><span class="p">,</span><span class="s1">&#39;DQ2_sc&#39;</span><span class="p">:</span><span class="s1">&#39;g&#39;</span><span class="p">,</span><span class="s1">&#39;DQ3_sc&#39;</span><span class="p">:</span><span class="s1">&#39;y&#39;</span><span class="p">},</span>
                       <span class="n">cc</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;Const&#39;</span><span class="p">:</span><span class="s1">&#39;b&#39;</span><span class="p">,</span><span class="s1">&#39;Rise&#39;</span><span class="p">:</span><span class="s1">&#39;g&#39;</span><span class="p">,</span><span class="s1">&#39;Fall&#39;</span><span class="p">:</span><span class="s1">&#39;r&#39;</span><span class="p">,</span><span class="s1">&#39;Pos&#39;</span><span class="p">:</span><span class="s1">&#39;m&#39;</span><span class="p">,</span><span class="s1">&#39;Neg&#39;</span><span class="p">:</span><span class="s1">&#39;y&#39;</span><span class="p">},</span>
                       <span class="n">disp_opt_DQ</span><span class="o">=</span><span class="s1">&#39;Normalized&#39;</span><span class="p">,</span> 
                       <span class="n">do_kwargs</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;norm&#39;</span><span class="p">:</span><span class="s1">&#39;absmax&#39;</span><span class="p">,</span> <span class="s1">&#39;normadd&#39;</span><span class="p">:</span><span class="mf">0.5</span><span class="p">,</span>
                                  <span class="s1">&#39;th&#39;</span><span class="p">:</span><span class="mf">0.05</span><span class="p">,</span> <span class="s1">&#39;th_option&#39;</span><span class="p">:</span><span class="s1">&#39;abs&#39;</span><span class="p">,</span> <span class="s1">&#39;th_set_val&#39;</span><span class="p">:</span><span class="mi">0</span><span class="p">},</span>
                       <span class="n">limDQ</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">limDQvals</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mf">1.1</span><span class="p">,</span><span class="mf">1.1</span><span class="p">]):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Plotting method for mc_char.curve_characterizer results.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    cps : pd.Dataframe (mc_char.curve_characterizer output)</span>
<span class="sd">        Characterization of input (for linear parts: linearisation and</span>
<span class="sd">                                   intersection to previous included).</span>
<span class="sd">    cip : pd.Series (mc_char.curve_characterizer output)</span>
<span class="sd">        Points of first characteriation (S=Start, E=End, I=Increase, D=Decrease).</span>
<span class="sd">    dfp : pd.Dataframe (mc_char.curve_characterizer output)</span>
<span class="sd">        Maxima and minima of input, as well as differential quotients.</span>
<span class="sd">    df : pd.Dataframe (mc_char.curve_characterizer output)</span>
<span class="sd">		Input, as well as differential quotients.</span>
<span class="sd">    head : string or None, optional</span>
<span class="sd">        Figure title. The default is None.</span>
<span class="sd">    xlabel : string or None, optional</span>
<span class="sd">        Label on x-axis. The default is None.</span>
<span class="sd">    ylabel_l : string or None, optional</span>
<span class="sd">        Label on left y-axis. The default is None.</span>
<span class="sd">    ylabel_r : string or None, optional</span>
<span class="sd">        Label on right y-axis. The default is None.</span>
<span class="sd">    cco : dict, optional</span>
<span class="sd">        Color codes for Max and Min markers in accordance with dfp column name.</span>
<span class="sd">        The default is {&#39;y&#39;:&#39;m&#39;}.</span>
<span class="sd">    cco_sc : dict, optional</span>
<span class="sd">        Color codes for changes in sign markers in accordance with dfp column </span>
<span class="sd">        name. The default is {}.</span>
<span class="sd">    ccd : dict, optional</span>
<span class="sd">        Color codes for differential quotient plotting.</span>
<span class="sd">        The default is {&#39;DQ1&#39;:&#39;b&#39;,&#39;DQ2&#39;:&#39;g&#39;,&#39;DQ3&#39;:&#39;y&#39;}.</span>
<span class="sd">    ccd_sc : dict, optional</span>
<span class="sd">        Color codes for plotting of differential quotient sign changes. </span>
<span class="sd">        The default is {&#39;DQ1_sc&#39;:&#39;b&#39;,&#39;DQ2_sc&#39;:&#39;g&#39;,&#39;DQ3_sc&#39;:&#39;y&#39;}.</span>
<span class="sd">    cc : ict, optional</span>
<span class="sd">        Color codes for plotting of curve description in cps.</span>
<span class="sd">        The default is {&#39;Const&#39;:&#39;b&#39;,&#39;Rise&#39;:&#39;g&#39;,&#39;Fall&#39;:&#39;r&#39;,&#39;Pos&#39;:&#39;m&#39;,&#39;Neg&#39;:&#39;y&#39;}.</span>
<span class="sd">    disp_opt_DQ : string, optional</span>
<span class="sd">        Normalization of differential quotients. The default is &#39;Normalized&#39;.</span>
<span class="sd">    do_kwargs : dict, optional</span>
<span class="sd">        Keyword arguments for normalization of differential quotients.</span>
<span class="sd">        The default is {&#39;norm&#39;:&#39;absmax&#39;, &#39;normadd&#39;:0.5,</span>
<span class="sd">                        &#39;th&#39;:0.05, &#39;th_option&#39;:&#39;abs&#39;, &#39;th_set_val&#39;:0}.</span>
<span class="sd">    limDQ : bool, optional</span>
<span class="sd">        Limit plot on y-axis to limDQvals. The default is False.</span>
<span class="sd">    limDQvals : list of float, optional</span>
<span class="sd">        Lower and upper limits on y-axis for limDQ. The default is [-1.1,1.1].</span>

<span class="sd">    Raises</span>
<span class="sd">    ------</span>
<span class="sd">    NotImplementedError</span>
<span class="sd">        DESCRIPTION.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    None.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">disp_opt_DQ</span> <span class="o">==</span> <span class="s1">&#39;True&#39;</span><span class="p">:</span>
        <span class="n">df_u_DQ</span> <span class="o">=</span> <span class="n">df</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">df_n</span> <span class="o">=</span> <span class="n">normalize</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)[</span><span class="o">~</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s1">&#39;_s.*&#39;</span><span class="p">,</span><span class="n">regex</span><span class="o">=</span><span class="kc">True</span><span class="p">)],</span>
                         <span class="n">norm</span><span class="o">=</span><span class="n">do_kwargs</span><span class="p">[</span><span class="s1">&#39;norm&#39;</span><span class="p">],</span> 
                         <span class="n">normadd</span><span class="o">=</span><span class="n">do_kwargs</span><span class="p">[</span><span class="s1">&#39;normadd&#39;</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">disp_opt_DQ</span> <span class="o">==</span> <span class="s1">&#39;Normalized&#39;</span><span class="p">:</span>
            <span class="n">df_u_DQ</span> <span class="o">=</span> <span class="n">df_n</span>
        <span class="k">elif</span> <span class="n">disp_opt_DQ</span> <span class="o">==</span> <span class="s1">&#39;Normalized_th&#39;</span><span class="p">:</span>
            <span class="n">df_u_DQ</span> <span class="o">=</span> <span class="n">threshhold_setter</span><span class="p">(</span><span class="n">pdo</span><span class="o">=</span><span class="n">df_n</span><span class="p">,</span> <span class="n">th</span><span class="o">=</span><span class="n">do_kwargs</span><span class="p">[</span><span class="s1">&#39;th&#39;</span><span class="p">],</span>
                                        <span class="n">option</span><span class="o">=</span><span class="n">do_kwargs</span><span class="p">[</span><span class="s1">&#39;th_option&#39;</span><span class="p">],</span>
                                        <span class="n">set_val</span><span class="o">=</span><span class="n">do_kwargs</span><span class="p">[</span><span class="s1">&#39;th_set_val&#39;</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;Display option </span><span class="si">%s</span><span class="s2"> not implemented!&quot;</span><span class="o">%</span><span class="n">disp_opt_DQ</span><span class="p">)</span>
    
    <span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="n">ax1</span><span class="p">,</span><span class="n">ax3</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> 
                                  <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> 
                                  <span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mf">6.3</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="mf">3.54</span><span class="p">))</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="n">head</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Curve, difference quotients and extrema&#39;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">df</span><span class="o">.</span><span class="n">y</span><span class="p">,</span><span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;x-y&#39;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">cco</span><span class="p">:</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">dfp</span><span class="p">[</span><span class="n">dfp</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;Max&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">index</span>
        <span class="n">b</span> <span class="o">=</span> <span class="n">dfp</span><span class="p">[</span><span class="n">dfp</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;Min&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">index</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">a</span><span class="p">,</span><span class="s1">&#39;x&#39;</span><span class="p">],</span>  <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">a</span><span class="p">,</span><span class="s1">&#39;y&#39;</span><span class="p">],</span> 
                 <span class="n">color</span><span class="o">=</span><span class="n">cco</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;^&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">b</span><span class="p">,</span><span class="s1">&#39;x&#39;</span><span class="p">],</span>  <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">b</span><span class="p">,</span><span class="s1">&#39;y&#39;</span><span class="p">],</span> 
                 <span class="n">color</span><span class="o">=</span><span class="n">cco</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;v&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">cco_sc</span><span class="p">:</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="s1">&#39;x&#39;</span><span class="p">],</span>  <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">i</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;_sc&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)],</span> 
                 <span class="n">color</span><span class="o">=</span><span class="n">cco_sc</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">ylabel_l</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">=</span><span class="n">ax1</span><span class="o">.</span><span class="n">twinx</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">ccd</span><span class="p">:</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">dfp</span><span class="p">[</span><span class="n">dfp</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;Max&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">index</span>
        <span class="n">b</span> <span class="o">=</span> <span class="n">dfp</span><span class="p">[</span><span class="n">dfp</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;Min&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">index</span>
        <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">df_u_DQ</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
                 <span class="n">ccd</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">i</span><span class="p">)</span>
        <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">a</span><span class="p">,</span><span class="s1">&#39;x&#39;</span><span class="p">],</span> <span class="n">df_u_DQ</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">a</span><span class="p">,</span><span class="n">i</span><span class="p">],</span>  
                 <span class="n">color</span><span class="o">=</span><span class="n">ccd</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;^&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
        <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">b</span><span class="p">,</span><span class="s1">&#39;x&#39;</span><span class="p">],</span> <span class="n">df_u_DQ</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">b</span><span class="p">,</span><span class="n">i</span><span class="p">],</span>  
                 <span class="n">color</span><span class="o">=</span><span class="n">ccd</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;v&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">ccd_sc</span><span class="p">:</span>
        <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="s1">&#39;x&#39;</span><span class="p">],</span> <span class="n">df_u_DQ</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">i</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;_sc&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)],</span> 
                 <span class="n">color</span><span class="o">=</span><span class="n">ccd_sc</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">)</span> 
    <span class="k">if</span> <span class="n">limDQ</span><span class="p">:</span>
        <span class="n">ax2</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">limDQvals</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">ylabel_r</span><span class="p">)</span> 
    
    <span class="n">ax3</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Curve characterisation&#39;</span><span class="p">)</span>
    <span class="n">ax3</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">df</span><span class="o">.</span><span class="n">y</span><span class="p">,</span><span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;x-y&#39;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">cps</span><span class="o">.</span><span class="n">index</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
        <span class="n">i_S</span><span class="o">=</span><span class="n">cps</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="s1">&#39;Start&#39;</span><span class="p">]</span>
        <span class="n">i_E</span><span class="o">=</span><span class="n">cps</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="s1">&#39;End&#39;</span><span class="p">]</span>
        <span class="n">ax3</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i_S</span><span class="p">:</span><span class="n">i_E</span><span class="p">]</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i_S</span><span class="p">:</span><span class="n">i_E</span><span class="p">]</span><span class="o">.</span><span class="n">y</span><span class="p">,</span>
                 <span class="n">cc</span><span class="p">[</span><span class="n">cps</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="s1">&#39;Type&#39;</span><span class="p">]]</span><span class="o">+</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
                 <span class="n">solid_capstyle</span><span class="o">=</span><span class="s1">&#39;butt&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span>
                 <span class="n">label</span><span class="o">=</span><span class="n">cps</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="s1">&#39;Type&#39;</span><span class="p">])</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">cip</span><span class="o">.</span><span class="n">index</span><span class="p">:</span>
        <span class="n">ax3</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;$</span><span class="si">%s</span><span class="s1">$&#39;</span><span class="o">%</span><span class="n">cip</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    <span class="n">cps_i_crf</span><span class="o">=</span><span class="n">cps</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">cps</span><span class="o">.</span><span class="n">Type</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;Const&#39;</span><span class="p">,</span><span class="s1">&#39;Rise&#39;</span><span class="p">,</span><span class="s1">&#39;Fall&#39;</span><span class="p">,</span><span class="s1">&#39;Last&#39;</span><span class="p">])]</span><span class="o">.</span><span class="n">index</span>
    <span class="n">ax3</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">cps</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">cps_i_crf</span><span class="p">,</span><span class="s1">&#39;IntP_x&#39;</span><span class="p">],</span> <span class="n">cps</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">cps_i_crf</span><span class="p">,</span><span class="s1">&#39;IntP_y&#39;</span><span class="p">],</span>
             <span class="s1">&#39;b:&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;lin&#39;</span><span class="p">)</span>
    <span class="n">ax3</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
    <span class="n">ax3</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">ylabel_l</span><span class="p">)</span>
    <span class="n">ax3</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">xlabel</span><span class="p">)</span>
    <span class="c1"># handles, labels = fig.gca().get_legend_handles_labels()</span>
    <span class="c1"># by_label = dict(zip(labels, handles))</span>
    <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="p">[</span><span class="n">ax1</span><span class="p">,</span><span class="n">ax2</span><span class="p">,</span><span class="n">ax3</span><span class="p">]:</span>
        <span class="n">handles</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">get_legend_handles_labels</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">a</span><span class="o">==</span><span class="n">ax1</span><span class="p">:</span>
            <span class="n">by_label</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">labels</span><span class="p">,</span> <span class="n">handles</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">by_label</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">labels</span><span class="p">,</span> <span class="n">handles</span><span class="p">)))</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">by_label</span><span class="o">.</span><span class="n">values</span><span class="p">(),</span> <span class="n">by_label</span><span class="o">.</span><span class="n">keys</span><span class="p">(),</span>
               <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;lower right&#39;</span><span class="p">,</span> <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">))</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>  <span class="c1"># otherwise the right y-label is slightly clipped</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">block</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span></div>
    
<span class="c1">#%% Seaborn extra</span>
<div class="viewcode-block" id="sns_pointplot_MMeb"><a class="viewcode-back" href="../../../exmecheva.common.html#exmecheva.common.plotting.sns_pointplot_MMeb">[docs]</a><span class="k">def</span> <span class="nf">sns_pointplot_MMeb</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                       <span class="n">dodge</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">join</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">palette</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                       <span class="n">markers</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;o&#39;</span><span class="p">,</span><span class="s1">&#39;P&#39;</span><span class="p">],</span> <span class="n">scale</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">barsabove</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">capsize</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>
                       <span class="n">controlout</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Generate Pointplot with errorbars marking minimum and maximum instead of CI.&quot;&quot;&quot;</span>
    <span class="n">axt</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">pointplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> 
                         <span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="n">hue</span><span class="p">,</span>
                         <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">join</span><span class="o">=</span><span class="n">join</span><span class="p">,</span> <span class="n">dodge</span><span class="o">=</span><span class="n">dodge</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">scale</span><span class="o">=</span><span class="n">scale</span><span class="p">,</span>
                         <span class="n">markers</span><span class="o">=</span><span class="n">markers</span><span class="p">,</span> <span class="n">palette</span><span class="o">=</span><span class="n">palette</span><span class="p">,</span>
                         <span class="n">ci</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">errwidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">capsize</span><span class="o">=</span><span class="mf">.1</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">hue</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># erragg = data.groupby(x).agg([&#39;mean&#39;,&#39;min&#39;,&#39;max&#39;])[y]</span>
        <span class="n">erragg</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">agg</span><span class="p">([</span><span class="s1">&#39;mean&#39;</span><span class="p">,</span><span class="s1">&#39;min&#39;</span><span class="p">,</span><span class="s1">&#39;max&#39;</span><span class="p">],</span><span class="n">sort</span><span class="o">=</span><span class="kc">False</span><span class="p">)[</span><span class="n">y</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># erragg = data.groupby([hue,x]).agg([&#39;mean&#39;,&#39;min&#39;,&#39;max&#39;])[y]</span>
        <span class="n">erragg</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="n">hue</span><span class="p">,</span><span class="n">x</span><span class="p">])</span><span class="o">.</span><span class="n">agg</span><span class="p">([</span><span class="s1">&#39;mean&#39;</span><span class="p">,</span><span class="s1">&#39;min&#39;</span><span class="p">,</span><span class="s1">&#39;max&#39;</span><span class="p">],</span><span class="n">sort</span><span class="o">=</span><span class="kc">False</span><span class="p">)[</span><span class="n">y</span><span class="p">]</span>
    <span class="c1"># very qnd!!! (sonst falsch zugeordnet, prüfen!!!)</span>
    <span class="k">if</span> <span class="n">hue</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">orgind</span><span class="o">=</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="n">hue</span><span class="p">]</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">()</span><span class="o">.</span><span class="n">to_list</span><span class="p">(),</span><span class="n">data</span><span class="p">[</span><span class="n">x</span><span class="p">]</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">()</span><span class="o">.</span><span class="n">to_list</span><span class="p">()]</span>
        <span class="n">erragg</span><span class="o">=</span><span class="n">erragg</span><span class="o">.</span><span class="n">sort_index</span><span class="p">()</span><span class="o">.</span><span class="n">loc</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)[</span><span class="n">pd</span><span class="o">.</span><span class="n">MultiIndex</span><span class="o">.</span><span class="n">from_product</span><span class="p">(</span><span class="n">orgind</span><span class="p">)]</span>
        
    <span class="n">errors</span><span class="o">=</span><span class="n">erragg</span><span class="o">.</span><span class="n">rename</span><span class="p">({</span><span class="s1">&#39;mean&#39;</span><span class="p">:</span><span class="s1">&#39;M&#39;</span><span class="p">,</span><span class="s1">&#39;min&#39;</span><span class="p">:</span><span class="s1">&#39;I&#39;</span><span class="p">,</span><span class="s1">&#39;max&#39;</span><span class="p">:</span><span class="s1">&#39;A&#39;</span><span class="p">},</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">errors</span><span class="o">=</span><span class="n">errors</span><span class="o">.</span><span class="n">eval</span><span class="p">(</span><span class="s1">&#39;&#39;&#39;Min = M-I</span>
<span class="s1">                          Max = A-M&#39;&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">loc</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)[[</span><span class="s1">&#39;Min&#39;</span><span class="p">,</span><span class="s1">&#39;Max&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">T</span>
    <span class="n">i</span><span class="o">=</span><span class="mi">0</span>
    <span class="k">for</span> <span class="n">point_pair</span> <span class="ow">in</span> <span class="n">axt</span><span class="o">.</span><span class="n">collections</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">hue</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">i</span><span class="o">&lt;</span><span class="mi">1</span><span class="p">:</span>
                <span class="n">i</span><span class="o">+=</span><span class="mi">1</span>
                <span class="n">colors</span><span class="o">=</span><span class="n">point_pair</span><span class="o">.</span><span class="n">get_facecolor</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">x_coords</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="n">y_coords</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">point_pair</span><span class="o">.</span><span class="n">get_offsets</span><span class="p">():</span>
                    <span class="n">x_coords</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
                    <span class="n">y_coords</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span><span class="n">x_coords</span><span class="p">,</span> <span class="n">y_coords</span><span class="p">,</span> <span class="n">yerr</span><span class="o">=</span><span class="n">errors</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
                            <span class="n">c</span><span class="o">=</span><span class="n">colors</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">barsabove</span><span class="o">=</span><span class="n">barsabove</span><span class="p">,</span> <span class="n">capsize</span><span class="o">=</span><span class="n">capsize</span><span class="p">)</span>
        <span class="k">elif</span> <span class="p">(</span><span class="n">i</span><span class="o">&lt;=</span><span class="nb">len</span><span class="p">(</span><span class="n">errors</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">get_level_values</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">())</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
            <span class="n">errcol</span><span class="o">=</span><span class="n">errors</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">get_level_values</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">()[</span><span class="n">i</span><span class="p">]</span>
            <span class="n">i</span><span class="o">+=</span><span class="mi">1</span>
            <span class="n">colors</span><span class="o">=</span><span class="n">point_pair</span><span class="o">.</span><span class="n">get_facecolor</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">x_coords</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">y_coords</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">point_pair</span><span class="o">.</span><span class="n">get_offsets</span><span class="p">():</span>
                <span class="n">x_coords</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
                <span class="n">y_coords</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span><span class="n">x_coords</span><span class="p">,</span> <span class="n">y_coords</span><span class="p">,</span> <span class="n">yerr</span><span class="o">=</span><span class="n">errors</span><span class="o">.</span><span class="n">loc</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)[</span><span class="n">errcol</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
                        <span class="n">c</span><span class="o">=</span><span class="n">colors</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">barsabove</span><span class="o">=</span><span class="n">barsabove</span><span class="p">,</span> <span class="n">capsize</span><span class="o">=</span><span class="n">capsize</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">controlout</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">erragg</span></div>
</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, MarcGebhardt.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>