<!DOCTYPE html>
<html class="writer-html5" lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>exmecheva.Eva_TBT &mdash; ExMechEva 0.1.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/theme.css" />

  
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/sphinx_highlight.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html" class="icon icon-home">
            ExMechEva
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../modules.html">ExMechEva</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">ExMechEva</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../index.html">Module code</a></li>
      <li class="breadcrumb-item active">exmecheva.Eva_TBT</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for exmecheva.Eva_TBT</h1><div class="highlight"><pre>
<span></span><span class="c1"># -*- coding: utf-8 -*-</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Three point bending test evaluation.</span>

<span class="sd">@author: MarcGebhardt</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="c1">#%% 0 Imports</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">lmfit</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">datetime</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">import</span> <span class="nn">warnings</span>

<span class="kn">import</span> <span class="nn">exmecheva.common</span> <span class="k">as</span> <span class="nn">emec</span>
<span class="kn">import</span> <span class="nn">exmecheva.bending</span> <span class="k">as</span> <span class="nn">emeb</span>

<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">,</span><span class="n">category</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">pytables</span><span class="o">.</span><span class="n">PerformanceWarning</span><span class="p">)</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">,</span><span class="n">category</span><span class="o">=</span><span class="ne">FutureWarning</span><span class="p">)</span>

<span class="n">log_custom</span> <span class="o">=</span> <span class="n">emec</span><span class="o">.</span><span class="n">output</span><span class="o">.</span><span class="n">str_log</span>
<span class="n">log_cind</span> <span class="o">=</span> <span class="n">emec</span><span class="o">.</span><span class="n">output</span><span class="o">.</span><span class="n">str_indent</span>

<span class="n">plt_hsuf</span> <span class="o">=</span>  <span class="n">emec</span><span class="o">.</span><span class="n">plotting</span><span class="o">.</span><span class="n">plt_handle_suffix</span>
<span class="n">figsize</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;figure.figsize&#39;</span><span class="p">]</span>

<span class="c1">#%% 1.0 Evaluation</span>
<div class="viewcode-block" id="TBT_single"><a class="viewcode-back" href="../../exmecheva.html#exmecheva.Eva_TBT.TBT_single">[docs]</a><span class="k">def</span> <span class="nf">TBT_single</span><span class="p">(</span><span class="n">prot_ser</span><span class="p">,</span> <span class="n">paths</span><span class="p">,</span> <span class="n">mfile_add</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span>
               <span class="n">log_scopt</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;logfp&#39;</span><span class="p">:</span><span class="kc">None</span><span class="p">,</span> <span class="s1">&#39;output_lvl&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
                          <span class="s1">&#39;logopt&#39;</span><span class="p">:</span><span class="kc">True</span><span class="p">,</span> <span class="s1">&#39;printopt&#39;</span><span class="p">:</span><span class="kc">False</span><span class="p">},</span>
               <span class="n">plt_scopt</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;tight&#39;</span><span class="p">:</span><span class="kc">True</span><span class="p">,</span> <span class="s1">&#39;show&#39;</span><span class="p">:</span><span class="kc">True</span><span class="p">,</span> 
                          <span class="s1">&#39;save&#39;</span><span class="p">:</span><span class="kc">True</span><span class="p">,</span> <span class="s1">&#39;s_types&#39;</span><span class="p">:[</span><span class="s2">&quot;pdf&quot;</span><span class="p">],</span> 
                          <span class="s1">&#39;clear&#39;</span><span class="p">:</span><span class="kc">True</span><span class="p">,</span> <span class="s1">&#39;close&#39;</span><span class="p">:</span><span class="kc">True</span><span class="p">}):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Evaluate single three point bending measurement form protocol table and </span>
<span class="sd">    path collection. Using common options wich are overwritten by protocol </span>
<span class="sd">    variables starting with &#39;OPT_&#39;. Produce evaluated measurements, </span>
<span class="sd">    material parameters and plots and safe them as table (.csv), unstructured </span>
<span class="sd">    database (.h5) and document (.pdf), using the designation of the specimen </span>
<span class="sd">    for distinction.</span>
<span class="sd">    Procedure:</span>
<span class="sd">        - 1: Read in options and presetting</span>
<span class="sd">        - 2: Determining geometrical values</span>
<span class="sd">        - 3: Read in measurements (conventional and optical (optinal))</span>
<span class="sd">        - 4: Merging measurements (time offset of conventional to optical </span>
<span class="sd">                                   (if available), downsampling and merging)</span>
<span class="sd">        - 5: Determine evaluation space (start and end)</span>
<span class="sd">        - 6: Evaluation (curves (stress/strain), importent points on curves,</span>
<span class="sd">                         elastic moduli (different types implemented))</span>
<span class="sd">        - 7: Generating output (tables, database and plots)</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    prot_ser : pd.Series</span>
<span class="sd">        Input data as pandas series with specimen information </span>
<span class="sd">        (identifier, origin, geometrical data, </span>
<span class="sd">         assessment codes, evaluation options).</span>
<span class="sd">    paths : pd.DataFrame</span>
<span class="sd">        Path collection for in- and output paths. </span>
<span class="sd">        Needs indexes: </span>
<span class="sd">            - &quot;opts&quot;: Common evaluation options</span>
<span class="sd">            - &quot;prot&quot;: Protocol</span>
<span class="sd">            - &quot;meas&quot;: Conventional measured data</span>
<span class="sd">            - &quot;dic&quot;: Optical measured data</span>
<span class="sd">            - &quot;out&quot;: Output</span>
<span class="sd">    mfile_add : string, optional</span>
<span class="sd">        Suffix of variants of measurements </span>
<span class="sd">        (p.E. diffferent moistures [&quot;A&quot;,&quot;B&quot;,...]). </span>
<span class="sd">        The default is &#39;&#39;.</span>
<span class="sd">    log_scopt : dict, optional</span>
<span class="sd">        Options for custom logging. Determining file path, </span>
<span class="sd">        output level (0=none, 1=normal, 2=special), logging enabled and </span>
<span class="sd">        printing enabled.</span>
<span class="sd">        The default is {&#39;logfp&#39;:None, &#39;output_lvl&#39;: 1,</span>
<span class="sd">                        &#39;logopt&#39;:True, &#39;printopt&#39;:False}.</span>
<span class="sd">    plt_scopt : dict, optional</span>
<span class="sd">        Options for plotting. </span>
<span class="sd">        The default is {&#39;tight&#39;:True, &#39;show&#39;:True, </span>
<span class="sd">                        &#39;save&#39;:True, &#39;s_types&#39;:[&quot;pdf&quot;],</span>
<span class="sd">                        &#39;clear&#39;:True, &#39;close&#39;:True}.</span>

<span class="sd">    Raises</span>
<span class="sd">    ------</span>
<span class="sd">    ValueError</span>
<span class="sd">        Input value not correct.</span>
<span class="sd">    NotImplementedError</span>
<span class="sd">        Method not implemented.</span>

<span class="sd">    Yields</span>
<span class="sd">    ------</span>
<span class="sd">    timings : pd.Series</span>
<span class="sd">        Timings of procedure steps.</span>
<span class="sd">    cout : string</span>
<span class="sd">        Special text output for control purposes.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">out_name</span> <span class="o">=</span> <span class="n">prot_ser</span><span class="p">[</span><span class="s1">&#39;Designation&#39;</span><span class="p">]</span><span class="o">+</span><span class="n">mfile_add</span>
    <span class="n">out_full</span> <span class="o">=</span> <span class="n">paths</span><span class="p">[</span><span class="s1">&#39;out&#39;</span><span class="p">]</span><span class="o">+</span><span class="n">out_name</span>
    <span class="k">if</span> <span class="n">log_scopt</span><span class="p">[</span><span class="s1">&#39;output_lvl&#39;</span><span class="p">]</span><span class="o">&gt;=</span><span class="mi">1</span><span class="p">:</span> 
        <span class="k">if</span> <span class="n">log_scopt</span><span class="p">[</span><span class="s1">&#39;logfp&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="p">(</span><span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">log_scopt</span><span class="p">[</span><span class="s1">&#39;logfp&#39;</span><span class="p">],</span><span class="nb">str</span><span class="p">)):</span>
            <span class="n">log_scopt</span><span class="p">[</span><span class="s1">&#39;logfp&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">out_full</span><span class="o">+</span><span class="s1">&#39;.log&#39;</span>
        <span class="n">log_scopt</span><span class="p">[</span><span class="s1">&#39;logfp&#39;</span><span class="p">]</span><span class="o">=</span><span class="nb">open</span><span class="p">(</span><span class="n">log_scopt</span><span class="p">[</span><span class="s1">&#39;logfp&#39;</span><span class="p">],</span><span class="s1">&#39;w&#39;</span><span class="p">)</span>
    <span class="n">log_scoptf</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;logfp&#39;</span><span class="p">:</span><span class="n">log_scopt</span><span class="p">[</span><span class="s1">&#39;logfp&#39;</span><span class="p">],</span> 
                <span class="s1">&#39;output_lvl&#39;</span><span class="p">:</span> <span class="n">log_scopt</span><span class="p">[</span><span class="s1">&#39;output_lvl&#39;</span><span class="p">],</span> 
                <span class="s1">&#39;logopt&#39;</span><span class="p">:</span><span class="n">log_scopt</span><span class="p">[</span><span class="s1">&#39;logopt&#39;</span><span class="p">],</span> 
                <span class="s1">&#39;printopt&#39;</span><span class="p">:</span><span class="kc">True</span><span class="p">}</span>
    
    <span class="n">_opts</span><span class="o">=</span><span class="n">emec</span><span class="o">.</span><span class="n">eva_opt_hand</span><span class="o">.</span><span class="n">option_reader_sel</span><span class="p">(</span>
        <span class="n">prot_ser</span><span class="o">=</span><span class="n">prot_ser</span><span class="p">,</span> <span class="n">paths</span><span class="o">=</span><span class="n">paths</span><span class="p">,</span> 
        <span class="n">search_inds</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Number&#39;</span><span class="p">,</span><span class="s1">&#39;Designation&#39;</span><span class="p">,</span><span class="s1">&#39;name&#39;</span><span class="p">],</span> 
        <span class="n">variant</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span>
        <span class="n">option</span><span class="o">=</span><span class="s1">&#39;JFile+Prot&#39;</span><span class="p">,</span>
        <span class="n">sheet_name</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
        <span class="n">re_rkws</span><span class="o">=</span><span class="nb">dict</span><span class="p">()</span>
        <span class="p">)</span>
    
    <span class="n">path_meas</span> <span class="o">=</span> <span class="n">paths</span><span class="p">[</span><span class="s1">&#39;meas&#39;</span><span class="p">]</span><span class="o">+</span><span class="n">_opts</span><span class="p">[</span><span class="s1">&#39;OPT_File_Meas&#39;</span><span class="p">]</span><span class="o">+</span><span class="n">mfile_add</span><span class="o">+</span><span class="s2">&quot;.xlsx&quot;</span>
    <span class="n">path_dic</span> <span class="o">=</span> <span class="n">paths</span><span class="p">[</span><span class="s1">&#39;dic&#39;</span><span class="p">]</span><span class="o">+</span><span class="n">_opts</span><span class="p">[</span><span class="s1">&#39;OPT_File_DIC&#39;</span><span class="p">]</span><span class="o">+</span><span class="n">mfile_add</span><span class="o">+</span><span class="s2">&quot;.csv&quot;</span>
    
    <span class="n">plt_name</span> <span class="o">=</span> <span class="n">prot_ser</span><span class="p">[</span><span class="s1">&#39;Designation&#39;</span><span class="p">]</span><span class="o">+</span><span class="n">mfile_add</span>
    <span class="n">timings</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([],</span><span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;float64&#39;</span><span class="p">)</span>
    <span class="n">timings</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mf">0.0</span><span class="p">]</span><span class="o">=</span><span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span>
    
    <span class="n">Length</span> <span class="o">=</span> <span class="n">prot_ser</span><span class="p">[</span><span class="s1">&#39;Length_test&#39;</span><span class="p">]</span>
    <span class="n">Bo_Le</span> <span class="o">=</span> <span class="o">-</span><span class="n">Length</span><span class="o">/</span><span class="mi">2</span>
    <span class="n">Bo_Ri</span> <span class="o">=</span>  <span class="n">Length</span><span class="o">/</span><span class="mi">2</span>
    <span class="n">xlin</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="n">Length</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="n">Length</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="mi">101</span><span class="p">)</span>
    
    <span class="c1"># rel_time_digs = emec.helper.sigdig(_opts[&#39;OPT_Resampling_Frequency&#39;], 4)</span>
    <span class="n">rel_time_digs</span> <span class="o">=</span> <span class="mi">2</span>
    
    <span class="n">bl</span> <span class="o">=</span> <span class="n">emeb</span><span class="o">.</span><span class="n">bfunc_class</span><span class="o">.</span><span class="n">Bend_func_legion</span><span class="p">(</span>
        <span class="n">name</span><span class="o">=</span><span class="n">_opts</span><span class="p">[</span><span class="s1">&#39;OPT_DIC_Fitting&#39;</span><span class="p">][</span><span class="s1">&#39;Bending_Legion_Name&#39;</span><span class="p">]</span>
        <span class="p">)</span>
    <span class="n">bl</span><span class="o">.</span><span class="n">Builder</span><span class="p">(</span><span class="n">option</span><span class="o">=</span><span class="n">_opts</span><span class="p">[</span><span class="s1">&#39;OPT_DIC_Fitting&#39;</span><span class="p">][</span><span class="s1">&#39;Bending_Legion_Builder&#39;</span><span class="p">])</span>
    
    <span class="n">pwargs</span><span class="o">=</span><span class="n">_opts</span><span class="p">[</span><span class="s1">&#39;OPT_DIC_Fitting&#39;</span><span class="p">][</span><span class="s1">&#39;pwargs&#39;</span><span class="p">]</span>
    <span class="c1"># krücke</span>
    <span class="n">pwargs</span><span class="p">[</span><span class="s1">&#39;param_val&#39;</span><span class="p">][</span><span class="s1">&#39;xmin&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">Bo_Le</span>
    <span class="n">pwargs</span><span class="p">[</span><span class="s1">&#39;param_val&#39;</span><span class="p">][</span><span class="s1">&#39;xmax&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">Bo_Ri</span>
        
    <span class="n">dic_used_Strain</span><span class="o">=</span><span class="s2">&quot;Strain_opt_&quot;</span><span class="o">+</span><span class="n">_opts</span><span class="p">[</span><span class="s1">&#39;OPT_YM_Determination_refinement&#39;</span><span class="p">][</span><span class="mi">3</span><span class="p">]</span>
    <span class="n">tmp_in</span> <span class="o">=</span> <span class="n">_opts</span><span class="p">[</span><span class="s1">&#39;OPT_YM_Determination_refinement&#39;</span><span class="p">][</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">dic_used_Disp</span><span class="o">=</span><span class="s2">&quot;Disp_opt_&quot;</span><span class="o">+</span><span class="n">tmp_in</span>
    
    <span class="k">if</span> <span class="n">_opts</span><span class="p">[</span><span class="s1">&#39;OPT_YM_Determination_refinement&#39;</span><span class="p">][</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;d&#39;</span><span class="p">:</span>
        <span class="n">tmp_md</span> <span class="o">=</span> <span class="s1">&#39;2&#39;</span>
    <span class="k">elif</span> <span class="n">_opts</span><span class="p">[</span><span class="s1">&#39;OPT_YM_Determination_refinement&#39;</span><span class="p">][</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;c&#39;</span><span class="p">:</span>
        <span class="n">tmp_md</span> <span class="o">=</span> <span class="s1">&#39;4&#39;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;OPT_YM_Determination_refinement seams to be wrong&#39;</span><span class="p">)</span>
    <span class="c1"># loc_Yd_tmp = &#39;E_lsq_R_A%s%sl&#39;%(tmp_md,tmp_in)</span>
    <span class="n">loc_Yd_tmp</span> <span class="o">=</span> <span class="s1">&#39;E_inc_R_D</span><span class="si">%s%s</span><span class="s1">gwt&#39;</span><span class="o">%</span><span class="p">(</span><span class="n">tmp_md</span><span class="p">,</span><span class="n">tmp_in</span><span class="p">)</span>
            
    <span class="n">cout</span> <span class="o">=</span><span class="s1">&#39;&#39;</span>
    <span class="n">ftxt</span><span class="o">=</span><span class="p">((</span><span class="s2">&quot;  Parameters of Evaluation:&quot;</span><span class="p">),</span>
          <span class="p">(</span><span class="s2">&quot;   Evaluation start time:     </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;%Y-%m-</span><span class="si">%d</span><span class="s1"> %H:%M:%S&#39;</span><span class="p">)),</span>
          <span class="p">(</span><span class="s2">&quot;   Evaluation options:        </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span><span class="n">paths</span><span class="p">[</span><span class="s1">&#39;opts&#39;</span><span class="p">]),</span>
          <span class="p">(</span><span class="s2">&quot;   Path protocol:             </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span><span class="n">paths</span><span class="p">[</span><span class="s1">&#39;prot&#39;</span><span class="p">]),</span>
          <span class="p">(</span><span class="s2">&quot;   Path measurement:          </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span><span class="n">path_meas</span><span class="p">),</span>
          <span class="p">(</span><span class="s2">&quot;   Path optical- measurement: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span><span class="n">path_dic</span><span class="p">),</span>
          <span class="p">(</span><span class="s2">&quot;   Resampling = </span><span class="si">%s</span><span class="s2"> (Frequency = </span><span class="si">%d</span><span class="s2"> Hz, moving-average = </span><span class="si">%s</span><span class="s2">)&quot;</span> <span class="o">%</span><span class="p">(</span>
              <span class="n">_opts</span><span class="p">[</span><span class="s1">&#39;OPT_Resampling&#39;</span><span class="p">],</span><span class="n">_opts</span><span class="p">[</span><span class="s1">&#39;OPT_Resampling_Frequency&#39;</span><span class="p">],</span>
              <span class="n">_opts</span><span class="p">[</span><span class="s1">&#39;OPT_Resampling_moveave&#39;</span><span class="p">]</span>
              <span class="p">)),</span>
          <span class="p">(</span><span class="s2">&quot;   Compression = </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span><span class="p">(</span><span class="n">_opts</span><span class="p">[</span><span class="s1">&#39;OPT_Compression&#39;</span><span class="p">])),</span>
          <span class="p">(</span><span class="s2">&quot;   LVDT failure = </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span><span class="p">(</span><span class="n">_opts</span><span class="p">[</span><span class="s1">&#39;OPT_LVDT_failure&#39;</span><span class="p">])),</span>
          <span class="p">(</span><span class="s2">&quot;   LVDT-spring-force-reduction = </span><span class="si">%s</span><span class="s2"> (K_Fed = </span><span class="si">%f</span><span class="s2"> N/mm)&quot;</span> <span class="o">%</span><span class="p">(</span>
              <span class="n">_opts</span><span class="p">[</span><span class="s1">&#39;OPT_Springreduction&#39;</span><span class="p">],</span><span class="n">_opts</span><span class="p">[</span><span class="s1">&#39;OPT_Springreduction_K&#39;</span><span class="p">]</span>
              <span class="p">)),</span>
          <span class="p">(</span><span class="s2">&quot;   Rise and curvature smoothing = </span><span class="si">%s</span><span class="s2"> (window = </span><span class="si">%d</span><span class="s2">)&quot;</span> <span class="o">%</span><span class="p">(</span>
              <span class="n">_opts</span><span class="p">[</span><span class="s1">&#39;OPT_Rise_Smoothing&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span><span class="n">_opts</span><span class="p">[</span><span class="s1">&#39;OPT_Rise_Smoothing&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
              <span class="p">)),</span>
          <span class="p">(</span><span class="s2">&quot;   Youngs Modulus determination between </span><span class="si">%f</span><span class="s2"> and </span><span class="si">%f</span><span class="s2"> of point </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span><span class="p">(</span>
              <span class="o">*</span><span class="n">_opts</span><span class="p">[</span><span class="s1">&#39;OPT_YM_Determination_range&#39;</span><span class="p">],</span>
              <span class="p">)),</span>
          <span class="p">(</span><span class="s2">&quot;   Distance between points: </span><span class="si">%d</span><span class="s2"> steps &quot;</span> <span class="o">%</span><span class="n">_opts</span><span class="p">[</span><span class="s1">&#39;OPT_Determination_Distance&#39;</span><span class="p">]),</span>
          <span class="p">(</span><span class="s2">&quot;   Improvment of Youngs-Modulus-determination between </span><span class="si">%f</span><span class="s2">*Stress_max and point </span><span class="si">%s</span><span class="s2">,&quot;</span> <span class="o">%</span><span class="p">(</span>
              <span class="n">_opts</span><span class="p">[</span><span class="s1">&#39;OPT_YM_Determination_refinement&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span>
              <span class="n">_opts</span><span class="p">[</span><span class="s1">&#39;OPT_YM_Determination_refinement&#39;</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
              <span class="p">)),</span>
          <span class="p">(</span><span class="s2">&quot;    with smoothing on difference-quotient (</span><span class="si">%s</span><span class="s2">, </span><span class="si">%d</span><span class="s2">)&quot;</span> <span class="o">%</span><span class="p">(</span>
              <span class="n">_opts</span><span class="p">[</span><span class="s1">&#39;OPT_YM_Determination_refinement&#39;</span><span class="p">][</span><span class="mi">4</span><span class="p">],</span>
              <span class="n">_opts</span><span class="p">[</span><span class="s1">&#39;OPT_YM_Determination_refinement&#39;</span><span class="p">][</span><span class="mi">5</span><span class="p">]</span>
              <span class="p">)),</span>
          <span class="p">(</span><span class="s2">&quot;    with allowable deviation of </span><span class="si">%f</span><span class="s2"> * difference-quotient_max in determination range&quot;</span> <span class="o">%</span><span class="p">(</span>
              <span class="n">_opts</span><span class="p">[</span><span class="s1">&#39;OPT_YM_Determination_refinement&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
              <span class="p">)),</span>
          <span class="p">(</span><span class="s2">&quot;   DIC-Measurement = </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span><span class="p">(</span><span class="n">_opts</span><span class="p">[</span><span class="s1">&#39;OPT_DIC&#39;</span><span class="p">])),</span>
          <span class="p">(</span><span class="s2">&quot;   DIC-Strain-suffix for range refinement and plots = </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span><span class="p">(</span>
              <span class="n">_opts</span><span class="p">[</span><span class="s1">&#39;OPT_YM_Determination_refinement&#39;</span><span class="p">][</span><span class="mi">3</span><span class="p">]</span>
              <span class="p">)),</span>
          <span class="p">(</span><span class="s2">&quot;   DIC-minimal points (special / specimen) = </span><span class="si">%d</span><span class="s2"> / </span><span class="si">%d</span><span class="s2">&quot;</span> <span class="o">%</span><span class="p">(</span>
              <span class="n">_opts</span><span class="p">[</span><span class="s1">&#39;OPT_DIC_Tester&#39;</span><span class="p">][</span><span class="o">-</span><span class="mi">2</span><span class="p">],</span><span class="n">_opts</span><span class="p">[</span><span class="s1">&#39;OPT_DIC_Tester&#39;</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
              <span class="p">)),</span>
          <span class="p">(</span><span class="s2">&quot;   DIC-names of special points (l,r,head), = </span><span class="si">%s</span><span class="s2">, </span><span class="si">%s</span><span class="s2">, </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span><span class="p">(</span>
              <span class="o">*</span><span class="n">_opts</span><span class="p">[</span><span class="s1">&#39;OPT_DIC_Points_TBT_device&#39;</span><span class="p">],</span>
              <span class="p">)),</span>
          <span class="p">(</span><span class="s2">&quot;   DIC-names of meas. points for fork (l,m,r), = </span><span class="si">%s</span><span class="s2">, </span><span class="si">%s</span><span class="s2">, </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span><span class="p">(</span>
              <span class="o">*</span><span class="n">_opts</span><span class="p">[</span><span class="s1">&#39;OPT_DIC_Points_meas_fork&#39;</span><span class="p">],</span>
              <span class="p">)),</span>
          <span class="p">(</span><span class="s2">&quot;   DIC-maximal SD = </span><span class="si">%.3f</span><span class="s2"> mm and maximal displacement between steps </span><span class="si">%.1f</span><span class="s2"> mm&quot;</span> <span class="o">%</span><span class="p">(</span>
              <span class="n">_opts</span><span class="p">[</span><span class="s1">&#39;OPT_DIC_Tester&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span><span class="n">_opts</span><span class="p">[</span><span class="s1">&#39;OPT_DIC_Tester&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
              <span class="p">)))</span>
    <span class="n">log_custom</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">ftxt</span><span class="p">),</span><span class="o">**</span><span class="n">log_scopt</span><span class="p">)</span>
    
    <span class="c1">#%% 2 Geometry</span>
    <span class="n">log_custom</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2"> &quot;</span><span class="o">+</span><span class="s2">&quot;=&quot;</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span><span class="o">**</span><span class="n">log_scopt</span><span class="p">)</span>
    <span class="n">log_custom</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2"> ### 2 Geometry ###&quot;</span><span class="p">,</span><span class="o">**</span><span class="n">log_scoptf</span><span class="p">)</span>
    <span class="n">timings</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mf">2.0</span><span class="p">]</span><span class="o">=</span><span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span>
    <span class="n">log_custom</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">   Timing </span><span class="si">%f</span><span class="s2">: </span><span class="si">%.5f</span><span class="s2"> s&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">timings</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span>
                                       <span class="n">timings</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">timings</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span>
                   <span class="o">**</span><span class="n">log_scopt</span><span class="p">)</span>
    
    <span class="n">geo</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">Bo_Le</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">Bo_Ri</span><span class="p">],</span>
                        <span class="s1">&#39;t&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">prot_ser</span><span class="p">[</span><span class="s1">&#39;thickness_1&#39;</span><span class="p">],</span> <span class="n">prot_ser</span><span class="p">[</span><span class="s1">&#39;thickness_2&#39;</span><span class="p">],</span> <span class="n">prot_ser</span><span class="p">[</span><span class="s1">&#39;thickness_3&#39;</span><span class="p">]],</span>
                        <span class="s1">&#39;w&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">prot_ser</span><span class="p">[</span><span class="s1">&#39;width_1&#39;</span><span class="p">],</span> <span class="n">prot_ser</span><span class="p">[</span><span class="s1">&#39;width_2&#39;</span><span class="p">],</span> <span class="n">prot_ser</span><span class="p">[</span><span class="s1">&#39;width_3&#39;</span><span class="p">]]})</span> <span class="c1"># Geometrie auf x-Koordinaten bezogen</span>
    
    <span class="n">func_t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">poly1d</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">polyfit</span><span class="p">(</span><span class="n">geo</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;x&#39;</span><span class="p">],</span> <span class="n">geo</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;t&#39;</span><span class="p">],</span><span class="mi">2</span><span class="p">),</span> <span class="n">variable</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">)</span> <span class="c1"># Polynom 2&#39;ter Ordnung für Dicke über x-Koordinate</span>
    <span class="n">func_w</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">poly1d</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">polyfit</span><span class="p">(</span><span class="n">geo</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;x&#39;</span><span class="p">],</span> <span class="n">geo</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;w&#39;</span><span class="p">],</span><span class="mi">2</span><span class="p">),</span> <span class="n">variable</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">)</span> <span class="c1"># Polynom 2&#39;ter Ordnung für Breite über x-Koordinate</span>
    <span class="n">func_A</span> <span class="o">=</span> <span class="n">func_t</span> <span class="o">*</span> <span class="n">func_w</span> <span class="c1"># Polynom für Querschnitt über x-Koordinate</span>
    <span class="n">func_I</span> <span class="o">=</span> <span class="n">func_t</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">func_w</span><span class="o">/</span><span class="mi">12</span> <span class="c1"># Polynom für Flächenträgheitsmoment 2&#39;ten Grades über x-Koordinate</span>
    
    <span class="n">gamma_V</span><span class="o">=</span><span class="n">emeb</span><span class="o">.</span><span class="n">bfunc_com</span><span class="o">.</span><span class="n">gamma_V_det</span><span class="p">(</span>
        <span class="n">_opts</span><span class="p">[</span><span class="s1">&#39;OPT_Poisson_prediction&#39;</span><span class="p">],</span> <span class="n">geo</span><span class="p">[</span><span class="s1">&#39;t&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span>
        <span class="n">Length</span><span class="p">,</span> <span class="n">CS_type</span><span class="o">=</span><span class="n">prot_ser</span><span class="p">[</span><span class="s1">&#39;CS_type&#39;</span><span class="p">]</span>
        <span class="p">)</span>
    
    <span class="k">if</span> <span class="kc">True</span><span class="p">:</span>
        <span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="n">ax1</span><span class="p">,</span><span class="n">ax3</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> 
                                      <span class="n">figsize</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">figsize</span><span class="p">,[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">]))</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1"> - Width and Thickness&#39;</span><span class="o">%</span><span class="n">plt_name</span><span class="p">)</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x / mm&#39;</span><span class="p">)</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Thickness / mm&#39;</span><span class="p">)</span>
        <span class="n">lns</span><span class="o">=</span><span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xlin</span><span class="p">,</span> <span class="n">func_t</span><span class="p">(</span><span class="n">xlin</span><span class="p">),</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;Thickness-fit&#39;</span><span class="p">)</span>
        <span class="n">lns</span><span class="o">+=</span><span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">geo</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;x&#39;</span><span class="p">],</span><span class="n">geo</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;t&#39;</span><span class="p">],</span> <span class="s1">&#39;bs&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;Thickness&#39;</span><span class="p">)</span>
        <span class="n">ax2</span> <span class="o">=</span> <span class="n">ax1</span><span class="o">.</span><span class="n">twinx</span><span class="p">()</span> 
        <span class="n">ax2</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Width / mm&#39;</span><span class="p">)</span>
        <span class="n">lns</span><span class="o">+=</span><span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xlin</span><span class="p">,</span> <span class="n">func_w</span><span class="p">(</span><span class="n">xlin</span><span class="p">),</span> <span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;Width-fit&#39;</span><span class="p">)</span>
        <span class="n">lns</span><span class="o">+=</span><span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">geo</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;x&#39;</span><span class="p">],</span><span class="n">geo</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;w&#39;</span><span class="p">],</span> <span class="s1">&#39;ro&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;Width&#39;</span><span class="p">)</span>
        <span class="n">labs</span> <span class="o">=</span> <span class="p">[</span><span class="n">l</span><span class="o">.</span><span class="n">get_label</span><span class="p">()</span> <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="n">lns</span><span class="p">]</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">lns</span><span class="p">,</span> <span class="n">labs</span><span class="p">)</span>
        <span class="n">ax3</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1"> - Moment of Inertia&#39;</span><span class="o">%</span><span class="n">plt_name</span><span class="p">)</span>
        <span class="n">ax3</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x / mm&#39;</span><span class="p">)</span>
        <span class="n">ax3</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;MoI / mm^4&#39;</span><span class="p">)</span>
        <span class="n">ax3</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xlin</span><span class="p">,</span> <span class="n">func_I</span><span class="p">(</span><span class="n">xlin</span><span class="p">),</span> <span class="s1">&#39;g-&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;MoI-fit&#39;</span><span class="p">)</span>
        <span class="n">ax3</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">geo</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;x&#39;</span><span class="p">],</span><span class="n">geo</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;t&#39;</span><span class="p">]</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">geo</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;w&#39;</span><span class="p">]</span><span class="o">/</span><span class="mi">12</span><span class="p">,</span> <span class="s1">&#39;gh&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;MoI&#39;</span><span class="p">)</span>
        <span class="n">ax3</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
        <span class="n">plt_hsuf</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span><span class="n">path</span><span class="o">=</span><span class="n">out_full</span><span class="o">+</span><span class="s2">&quot;-Geo&quot;</span><span class="p">,</span><span class="o">**</span><span class="n">plt_scopt</span><span class="p">)</span>
    
    <span class="n">log_custom</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">  Measured Geometry:&quot;</span><span class="o">+</span><span class="n">log_cind</span><span class="p">(</span><span class="n">geo</span><span class="p">),</span>
               <span class="o">**</span><span class="n">log_scopt</span><span class="p">)</span>
    <span class="n">log_custom</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">  Function of thickness:&quot;</span><span class="o">+</span><span class="n">log_cind</span><span class="p">(</span><span class="n">func_t</span><span class="p">),</span>
               <span class="o">**</span><span class="n">log_scopt</span><span class="p">)</span>
    <span class="n">log_custom</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">  Function of width:&quot;</span><span class="o">+</span><span class="n">log_cind</span><span class="p">(</span><span class="n">func_w</span><span class="p">),</span>
               <span class="o">**</span><span class="n">log_scopt</span><span class="p">)</span>
    <span class="n">log_custom</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">  Function of area:&quot;</span><span class="o">+</span><span class="n">log_cind</span><span class="p">(</span><span class="n">func_A</span><span class="p">),</span>
               <span class="o">**</span><span class="n">log_scopt</span><span class="p">)</span>
    <span class="n">log_custom</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">  Function of moment of inertia:&quot;</span><span class="o">+</span><span class="n">log_cind</span><span class="p">(</span><span class="n">func_I</span><span class="p">),</span>
            <span class="o">**</span><span class="n">log_scopt</span><span class="p">)</span>

    <span class="c1"># =============================================================================</span>
    <span class="c1">#%% 3 Read in measurements</span>
    <span class="n">log_custom</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2"> &quot;</span><span class="o">+</span><span class="s2">&quot;=&quot;</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span><span class="o">**</span><span class="n">log_scopt</span><span class="p">)</span>
    <span class="n">log_custom</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2"> ### 3 Read in measurements ###&quot;</span><span class="p">,</span><span class="o">**</span><span class="n">log_scoptf</span><span class="p">)</span>
    <span class="n">timings</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mf">3.0</span><span class="p">]</span><span class="o">=</span><span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span>
    <span class="n">log_custom</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">   Timing </span><span class="si">%f</span><span class="s2">: </span><span class="si">%.5f</span><span class="s2"> s&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">timings</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span>
                                       <span class="n">timings</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">timings</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span>
                   <span class="o">**</span><span class="n">log_scopt</span><span class="p">)</span>
    <span class="c1"># =============================================================================</span>
    <span class="c1">#%%% 3.1 Read in conventional measurement data</span>
    <span class="n">timings</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mf">3.1</span><span class="p">]</span><span class="o">=</span><span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span>
    <span class="n">log_custom</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">   Timing </span><span class="si">%f</span><span class="s2">: </span><span class="si">%.5f</span><span class="s2"> s&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">timings</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span>
                                       <span class="n">timings</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">timings</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span>
                   <span class="o">**</span><span class="n">log_scopt</span><span class="p">)</span>
    <span class="n">mess</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="n">path_meas</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="n">_opts</span><span class="p">[</span><span class="s1">&#39;OPT_Measurement_file&#39;</span><span class="p">][</span><span class="s1">&#39;header&#39;</span><span class="p">],</span>
                       <span class="n">names</span><span class="o">=</span><span class="n">_opts</span><span class="p">[</span><span class="s1">&#39;OPT_Measurement_file&#39;</span><span class="p">][</span><span class="s1">&#39;head_names&#39;</span><span class="p">])</span>
    
    <span class="n">mess</span> <span class="o">=</span> <span class="n">mess</span><span class="o">-</span><span class="n">mess</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">_opts</span><span class="p">[</span><span class="s1">&#39;OPT_Measurement_file&#39;</span><span class="p">][</span><span class="s1">&#39;used_names_dict&#39;</span><span class="p">][</span><span class="s1">&#39;Way&#39;</span><span class="p">],</span><span class="nb">type</span><span class="p">(</span><span class="nb">list</span><span class="p">())):</span>
        <span class="n">mess</span><span class="p">[</span><span class="s1">&#39;L_IWA&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">mess</span><span class="p">[</span><span class="n">_opts</span><span class="p">[</span><span class="s1">&#39;OPT_Measurement_file&#39;</span><span class="p">][</span><span class="s1">&#39;used_names_dict&#39;</span><span class="p">][</span><span class="s1">&#39;Way&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
        <span class="n">_opts</span><span class="p">[</span><span class="s1">&#39;OPT_Measurement_file&#39;</span><span class="p">][</span><span class="s1">&#39;used_names_dict&#39;</span><span class="p">][</span><span class="s1">&#39;Way&#39;</span><span class="p">]</span> <span class="o">=</span><span class="s1">&#39;L_IWA&#39;</span>
    <span class="k">if</span> <span class="n">_opts</span><span class="p">[</span><span class="s1">&#39;OPT_Springreduction&#39;</span><span class="p">]:</span> 
        <span class="n">mess</span><span class="p">[</span><span class="s1">&#39;F_IWA_red&#39;</span><span class="p">]</span><span class="o">=</span><span class="p">(</span><span class="n">mess</span><span class="o">.</span><span class="n">L_IWA</span><span class="p">)</span><span class="o">*</span><span class="n">_opts</span><span class="p">[</span><span class="s1">&#39;OPT_Springreduction_K&#39;</span><span class="p">]</span>
        
    <span class="c1"># # =============================================================================</span>
    <span class="c1"># #%%% 3.2 Specify used conventional measured force and way</span>
    <span class="n">timings</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mf">3.2</span><span class="p">]</span><span class="o">=</span><span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span>
    <span class="n">log_custom</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">   Timing </span><span class="si">%f</span><span class="s2">: </span><span class="si">%.5f</span><span class="s2"> s&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">timings</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span>
                                       <span class="n">timings</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">timings</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span>
                   <span class="o">**</span><span class="n">log_scopt</span><span class="p">)</span>
    <span class="n">messu</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;Time&#39;</span><span class="p">:</span> <span class="n">mess</span><span class="p">[</span><span class="n">_opts</span><span class="p">[</span><span class="s1">&#39;OPT_Measurement_file&#39;</span><span class="p">][</span><span class="s1">&#39;used_names_dict&#39;</span><span class="p">][</span><span class="s1">&#39;Time&#39;</span><span class="p">]],</span>
                          <span class="s1">&#39;Force&#39;</span><span class="p">:</span> <span class="n">mess</span><span class="p">[</span><span class="n">_opts</span><span class="p">[</span><span class="s1">&#39;OPT_Measurement_file&#39;</span><span class="p">][</span><span class="s1">&#39;used_names_dict&#39;</span><span class="p">][</span><span class="s1">&#39;Force&#39;</span><span class="p">]],</span>
                          <span class="s1">&#39;Way&#39;</span><span class="p">:</span> <span class="n">mess</span><span class="p">[</span><span class="n">_opts</span><span class="p">[</span><span class="s1">&#39;OPT_Measurement_file&#39;</span><span class="p">][</span><span class="s1">&#39;used_names_dict&#39;</span><span class="p">][</span><span class="s1">&#39;Way&#39;</span><span class="p">]]})</span>

    <span class="k">if</span> <span class="n">_opts</span><span class="p">[</span><span class="s1">&#39;OPT_Springreduction&#39;</span><span class="p">]:</span>     
        <span class="n">messu</span><span class="p">[</span><span class="s1">&#39;Force&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">messu</span><span class="p">[</span><span class="s1">&#39;Force&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">mess</span><span class="p">[</span><span class="s1">&#39;F_IWA_red&#39;</span><span class="p">]</span>
        
    <span class="k">if</span> <span class="n">_opts</span><span class="p">[</span><span class="s1">&#39;OPT_Compression&#39;</span><span class="p">]</span><span class="o">==</span><span class="kc">True</span><span class="p">:</span>
        <span class="n">messu</span><span class="o">.</span><span class="n">Force</span><span class="o">=</span><span class="n">messu</span><span class="o">.</span><span class="n">Force</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">invert</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">_opts</span><span class="p">[</span><span class="s1">&#39;OPT_End&#39;</span><span class="p">])):</span>
        <span class="n">messu</span><span class="o">=</span><span class="n">messu</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">messu</span><span class="o">.</span><span class="n">Time</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">rel_time_digs</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">_opts</span><span class="p">[</span><span class="s1">&#39;OPT_End&#39;</span><span class="p">]]</span>
    
    <span class="c1"># =============================================================================</span>
    <span class="c1">#%%% 3.3 Read in optical measurement data</span>
    <span class="n">timings</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mf">3.3</span><span class="p">]</span><span class="o">=</span><span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span>
    <span class="n">log_custom</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">   Timing </span><span class="si">%f</span><span class="s2">: </span><span class="si">%.5f</span><span class="s2"> s&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">timings</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span>
                                       <span class="n">timings</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">timings</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span>
                   <span class="o">**</span><span class="n">log_scopt</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">_opts</span><span class="p">[</span><span class="s1">&#39;OPT_DIC&#39;</span><span class="p">]:</span>
        <span class="n">dic</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">path_dic</span><span class="p">,</span>
                          <span class="n">sep</span><span class="o">=</span><span class="s2">&quot;;&quot;</span><span class="p">,</span><span class="n">index_col</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">skiprows</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span><span class="n">usecols</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span>
                          <span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;DStep&#39;</span><span class="p">,</span><span class="s1">&#39;Time&#39;</span><span class="p">],</span> <span class="n">na_values</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;Nan&quot;</span><span class="p">,</span><span class="s2">&quot; Nan&quot;</span><span class="p">,</span><span class="s2">&quot;nan&quot;</span><span class="p">})</span>
        <span class="n">dic</span><span class="o">.</span><span class="n">index</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">Int64Index</span><span class="p">(</span><span class="n">dic</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">invert</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">_opts</span><span class="p">[</span><span class="s1">&#39;OPT_End&#39;</span><span class="p">])):</span>
            <span class="n">dic</span> <span class="o">=</span> <span class="n">dic</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dic</span><span class="o">.</span><span class="n">Time</span> <span class="o">&lt;=</span> <span class="n">_opts</span><span class="p">[</span><span class="s1">&#39;OPT_End&#39;</span><span class="p">]]</span>
    
        <span class="n">dic_dt</span> <span class="o">=</span> <span class="n">dic</span><span class="o">.</span><span class="n">Time</span><span class="o">.</span><span class="n">diff</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
        <span class="n">dic_f</span>  <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">dic_dt</span><span class="p">)</span>
        
        
        <span class="n">dic_tmp</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">path_dic</span><span class="p">,</span>
                            <span class="n">sep</span><span class="o">=</span><span class="s2">&quot;;&quot;</span><span class="p">,</span><span class="n">index_col</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span><span class="n">header</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span>
                            <span class="n">na_values</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;Nan&quot;</span><span class="p">,</span><span class="s2">&quot; Nan&quot;</span><span class="p">,</span><span class="s2">&quot;nan&quot;</span><span class="p">})</span>
        <span class="n">dic_tmp</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Step&#39;</span><span class="p">,</span><span class="s1">&#39;Time&#39;</span><span class="p">]</span>
        <span class="n">dic_tmp</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Points&#39;</span><span class="p">,</span><span class="s1">&#39;Vars&#39;</span><span class="p">]</span>
        <span class="n">dic_tmp</span><span class="o">=</span><span class="n">dic_tmp</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
        <span class="n">dic_tmp</span><span class="o">=</span><span class="n">dic_tmp</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Step&#39;</span><span class="p">,</span><span class="s1">&#39;Time&#39;</span><span class="p">])</span>
        <span class="n">dic_tmp</span> <span class="o">=</span> <span class="n">dic_tmp</span><span class="o">.</span><span class="n">sort_index</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">invert</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">_opts</span><span class="p">[</span><span class="s1">&#39;OPT_End&#39;</span><span class="p">])):</span>
            <span class="n">dic_tmp</span><span class="o">=</span><span class="n">dic_tmp</span><span class="o">.</span><span class="n">loc</span><span class="p">[:</span><span class="n">dic</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span>
    
        
        <span class="n">testert</span><span class="o">=</span><span class="p">{}</span>
        <span class="n">testert</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span><span class="p">(</span><span class="n">dic_tmp</span><span class="o">.</span><span class="n">loc</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)[</span><span class="n">pd</span><span class="o">.</span><span class="n">IndexSlice</span><span class="p">[:,</span> <span class="p">[</span><span class="s1">&#39;Sx&#39;</span><span class="p">,</span><span class="s1">&#39;Sy&#39;</span><span class="p">,</span><span class="s1">&#39;Sz&#39;</span><span class="p">]]]</span><span class="o">.</span><span class="n">abs</span><span class="p">()</span><span class="o">&gt;=</span><span class="n">_opts</span><span class="p">[</span><span class="s1">&#39;OPT_DIC_Tester&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="c1"># Test, ob eine Standrardabweichung größer als die Grenzstd. ist</span>
        <span class="n">testert</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span><span class="p">(</span><span class="n">dic_tmp</span><span class="o">.</span><span class="n">loc</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)[</span><span class="n">pd</span><span class="o">.</span><span class="n">IndexSlice</span><span class="p">[:,</span> <span class="p">[</span><span class="s1">&#39;Sx&#39;</span><span class="p">,</span><span class="s1">&#39;Sy&#39;</span><span class="p">,</span><span class="s1">&#39;Sz&#39;</span><span class="p">]]]</span><span class="o">.</span><span class="n">abs</span><span class="p">()</span><span class="o">==</span><span class="mi">0</span>                         <span class="p">)</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="c1"># Test, ob eine Standrardabweichung gleich 0 ist</span>
        <span class="n">testert</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">=</span><span class="p">(</span><span class="n">dic_tmp</span><span class="o">.</span><span class="n">loc</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)[</span><span class="n">pd</span><span class="o">.</span><span class="n">IndexSlice</span><span class="p">[:,</span> <span class="p">[</span><span class="s1">&#39;Sx&#39;</span><span class="p">,</span><span class="s1">&#39;Sy&#39;</span><span class="p">,</span><span class="s1">&#39;Sz&#39;</span><span class="p">]]]</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span>                           <span class="p">)</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="c1"># Test, ob eine Standrardabweichung NaN ist</span>
        <span class="n">testert</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">=</span><span class="p">(</span><span class="n">dic_tmp</span><span class="o">.</span><span class="n">loc</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)[</span><span class="n">pd</span><span class="o">.</span><span class="n">IndexSlice</span><span class="p">[:,</span> <span class="p">[</span><span class="s1">&#39;Sx&#39;</span><span class="p">,</span><span class="s1">&#39;Sy&#39;</span><span class="p">,</span><span class="s1">&#39;Sz&#39;</span><span class="p">]]]</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">&lt;=</span><span class="mf">1e-06</span>       <span class="p">)</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="c1"># Test, ob die Standrardabweichungen eines Punktes weniger als 1e-06 von einander abweichen (faktisch gleich sind)</span>
        <span class="n">testert</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">=</span><span class="p">(</span><span class="n">dic_tmp</span><span class="o">.</span><span class="n">loc</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)[</span><span class="n">pd</span><span class="o">.</span><span class="n">IndexSlice</span><span class="p">[:,</span>    <span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">,</span><span class="s1">&#39;y&#39;</span><span class="p">,</span><span class="s1">&#39;z&#39;</span><span class="p">]]]</span><span class="o">.</span><span class="n">abs</span><span class="p">()</span><span class="o">&gt;=</span><span class="n">_opts</span><span class="p">[</span><span class="s1">&#39;OPT_DIC_Tester&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="c1"># Test, ob die erhaltenen Koordinaten im Bereich der erwarteten liegen</span>
        <span class="n">vt</span><span class="o">=</span><span class="p">((</span><span class="n">dic_tmp</span><span class="o">.</span><span class="n">diff</span><span class="p">()</span><span class="o">.</span><span class="n">loc</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)[</span><span class="n">pd</span><span class="o">.</span><span class="n">IndexSlice</span><span class="p">[:,</span>    <span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">,</span><span class="s1">&#39;y&#39;</span><span class="p">,</span><span class="s1">&#39;z&#39;</span><span class="p">]]]</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">))</span><span class="o">**</span><span class="mf">0.5</span> <span class="c1"># Verschiebung zwischen einzelnen Epochen</span>
        <span class="n">testert</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="o">=</span><span class="p">(</span><span class="n">vt</span><span class="o">&gt;=</span><span class="n">vt</span><span class="o">.</span><span class="n">median</span><span class="p">()</span><span class="o">*</span><span class="mi">200</span><span class="p">)</span> <span class="c1"># Test ob die Verschiebung zwischen einzelnen Epochen größer als das 200-fache ihres Medians sind</span>

        <span class="c1"># testert[0]=(emeb.opt_mps.Point_df_idx(df=dic_tmp, coords= [&#39;Sx&#39;,&#39;Sy&#39;,&#39;Sz&#39;]).abs()&gt;=_opts[&#39;OPT_DIC_Tester&#39;][0]).any(axis=1,level=0) # Test, ob eine Standrardabweichung größer als die Grenzstd. ist</span>
        <span class="c1"># testert[1]=(emeb.opt_mps.Point_df_idx(df=dic_tmp, coords= [&#39;Sx&#39;,&#39;Sy&#39;,&#39;Sz&#39;]).abs()==0                         ).any(axis=1,level=0) # Test, ob eine Standrardabweichung gleich 0 ist</span>
        <span class="c1"># testert[2]=(emeb.opt_mps.Point_df_idx(df=dic_tmp, coords= [&#39;Sx&#39;,&#39;Sy&#39;,&#39;Sz&#39;]).isna()                           ).any(axis=1,level=0) # Test, ob eine Standrardabweichung NaN ist</span>
        <span class="c1"># testert[3]=(emeb.opt_mps.Point_df_idx(df=dic_tmp, coords= [&#39;Sx&#39;,&#39;Sy&#39;,&#39;Sz&#39;]).std(axis=1,level=0)&lt;=1e-06       ).any(axis=1,level=0) # Test, ob die Standrardabweichungen eines Punktes weniger als 1e-06 von einander abweichen (faktisch gleich sind)</span>
        <span class="c1"># testert[4]=(emeb.opt_mps.Point_df_idx(df=dic_tmp, coords= [&#39;x&#39;,&#39;y&#39;,&#39;z&#39;]   ).abs()&gt;=_opts[&#39;OPT_DIC_Tester&#39;][1]).any(axis=1,level=0) # Test, ob die erhaltenen Koordinaten im Bereich der erwarteten liegen</span>
        <span class="c1"># vt=((emeb.opt_mps.Point_df_idx(df=dic_tmp, coords= [&#39;x&#39;,&#39;y&#39;,&#39;z&#39;]   ).diff()**2).sum(axis=1,level=0))**0.5 # Verschiebung zwischen einzelnen Epochen</span>
        <span class="c1"># testert[5]=(vt&gt;=vt.median()*200) # Test ob die Verschiebung zwischen einzelnen Epochen größer als das 200-fache ihres Medians sind</span>
        <span class="n">tester</span><span class="o">=</span><span class="n">testert</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">|</span><span class="n">testert</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">|</span><span class="n">testert</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">|</span><span class="n">testert</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">|</span><span class="n">testert</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">|</span><span class="n">testert</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span>
        <span class="n">dic_tmp</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">IndexSlice</span><span class="p">[</span><span class="n">tester</span><span class="p">]]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
        
        <span class="n">step_range_dic</span><span class="o">=</span><span class="n">tester</span><span class="o">.</span><span class="n">index</span>
        <span class="n">anp</span><span class="o">=</span><span class="n">tester</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="n">tester</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="n">pat</span><span class="o">=</span><span class="s1">&#39;P&#39;</span><span class="p">,</span><span class="n">na</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">regex</span><span class="o">=</span><span class="kc">True</span><span class="p">)]</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
        <span class="n">ans</span><span class="o">=</span><span class="n">tester</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="n">tester</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="n">pat</span><span class="o">=</span><span class="s1">&#39;S&#39;</span><span class="p">,</span><span class="n">na</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">regex</span><span class="o">=</span><span class="kc">True</span><span class="p">)]</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
        <span class="n">dic_t_str</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([],</span><span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;O&#39;</span><span class="p">)</span>
        <span class="n">log_custom</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2"> &quot;</span><span class="o">+</span><span class="s2">&quot;-&quot;</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span><span class="o">**</span><span class="n">log_scopt</span><span class="p">)</span>
        <span class="n">log_custom</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">  DIC-Tester:&quot;</span><span class="p">,</span><span class="o">**</span><span class="n">log_scopt</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">tester</span><span class="o">.</span><span class="n">index</span><span class="p">:</span>
            <span class="n">dic_t_str</span><span class="p">[</span><span class="n">s</span><span class="p">]</span><span class="o">=</span><span class="s2">&quot;&quot;</span>
            <span class="k">if</span> <span class="n">tester</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">s</span><span class="p">]</span><span class="o">.</span><span class="n">any</span><span class="p">():</span>
                <span class="n">fpnp</span><span class="o">=</span><span class="n">tester</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">s</span><span class="p">,</span><span class="n">tester</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">s</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="n">pat</span><span class="o">=</span><span class="s1">&#39;P&#39;</span><span class="p">,</span><span class="n">na</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">regex</span><span class="o">=</span><span class="kc">True</span><span class="p">)]</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">tester</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">s</span><span class="p">]</span><span class="o">==</span><span class="kc">True</span><span class="p">]</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
                <span class="n">fpns</span><span class="o">=</span><span class="n">tester</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">s</span><span class="p">,</span><span class="n">tester</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">s</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="n">pat</span><span class="o">=</span><span class="s1">&#39;S&#39;</span><span class="p">,</span><span class="n">na</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">regex</span><span class="o">=</span><span class="kc">True</span><span class="p">)]</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">tester</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">s</span><span class="p">]</span><span class="o">==</span><span class="kc">True</span><span class="p">]</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
                <span class="k">if</span> <span class="p">((</span><span class="n">anp</span><span class="o">-</span><span class="n">fpnp</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">_opts</span><span class="p">[</span><span class="s1">&#39;OPT_DIC_Tester&#39;</span><span class="p">][</span><span class="mi">3</span><span class="p">])</span><span class="o">|</span><span class="p">((</span><span class="n">ans</span><span class="o">-</span><span class="n">fpns</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">_opts</span><span class="p">[</span><span class="s1">&#39;OPT_DIC_Tester&#39;</span><span class="p">][</span><span class="mi">2</span><span class="p">]):</span> 
                    <span class="n">step_range_dic</span> <span class="o">=</span> <span class="n">step_range_dic</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">log_scopt</span><span class="p">[</span><span class="s1">&#39;output_lvl&#39;</span><span class="p">]</span><span class="o">&gt;=</span><span class="mi">1</span><span class="p">:</span>
                    <span class="n">fps</span><span class="o">=</span><span class="p">[]</span>
                    <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="n">tester</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">s</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="p">:</span>
                        <span class="k">if</span> <span class="n">tester</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">s</span><span class="p">]</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">l</span><span class="p">]:</span>
                            <span class="n">fps</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">l</span><span class="p">)</span>
                    <span class="n">log_custom</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">    Failed points in series </span><span class="si">%d</span><span class="s2">: </span><span class="si">%d</span><span class="s2"> of </span><span class="si">%d</span><span class="s2"> meas. | </span><span class="si">%d</span><span class="s2"> of </span><span class="si">%d</span><span class="s2"> special </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span><span class="p">(</span><span class="n">s</span><span class="p">,</span><span class="n">fpnp</span><span class="p">,</span><span class="n">anp</span><span class="p">,</span><span class="n">fpns</span><span class="p">,</span><span class="n">ans</span><span class="p">,</span><span class="n">fps</span><span class="p">),</span>
                                 <span class="o">**</span><span class="n">log_scoptf</span><span class="p">)</span>
                    <span class="n">dic_t_str</span><span class="p">[</span><span class="n">s</span><span class="p">]</span><span class="o">=</span><span class="n">dic_t_str</span><span class="p">[</span><span class="n">s</span><span class="p">]</span><span class="o">+</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">    Failed points: </span><span class="si">%d</span><span class="s2"> of </span><span class="si">%d</span><span class="s2"> meas. | </span><span class="si">%d</span><span class="s2"> of </span><span class="si">%d</span><span class="s2"> special </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span><span class="p">(</span><span class="n">fpnp</span><span class="p">,</span><span class="n">anp</span><span class="p">,</span><span class="n">fpns</span><span class="p">,</span><span class="n">ans</span><span class="p">,</span><span class="n">fps</span><span class="p">))</span>
                    <span class="k">if</span> <span class="p">((</span><span class="n">anp</span><span class="o">-</span><span class="n">fpnp</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">_opts</span><span class="p">[</span><span class="s1">&#39;OPT_DIC_Tester&#39;</span><span class="p">][</span><span class="mi">3</span><span class="p">])</span><span class="o">|</span><span class="p">((</span><span class="n">ans</span><span class="o">-</span><span class="n">fpns</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">_opts</span><span class="p">[</span><span class="s1">&#39;OPT_DIC_Tester&#39;</span><span class="p">][</span><span class="mi">2</span><span class="p">]):</span> <span class="n">dic_t_str</span><span class="p">[</span><span class="n">s</span><span class="p">]</span><span class="o">=</span><span class="n">dic_t_str</span><span class="p">[</span><span class="n">s</span><span class="p">]</span><span class="o">+</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">    -&gt; DIC-curving of step dropped!!!&quot;</span>
    
        <span class="n">log_custom</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2"> &quot;</span><span class="o">+</span><span class="s2">&quot;-&quot;</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span><span class="o">**</span><span class="n">log_scopt</span><span class="p">)</span>
        <span class="n">log_custom</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">  Coordinate transformation and curvature calculation:&quot;</span><span class="p">,</span><span class="o">**</span><span class="n">log_scopt</span><span class="p">)</span>
        
        <span class="n">Points_T</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([],</span><span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;O&#39;</span><span class="p">)</span>
        <span class="n">Points_L_T</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([],</span><span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;O&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">step</span> <span class="ow">in</span> <span class="n">step_range_dic</span><span class="p">:</span>
            <span class="n">log_custom</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">  Step </span><span class="si">%d</span><span class="s2"> coordinate transformation:&quot;</span> <span class="o">%</span><span class="n">step</span><span class="p">,</span> <span class="o">**</span><span class="n">log_scopt</span><span class="p">)</span>
            <span class="n">log_custom</span><span class="p">(</span><span class="n">dic_t_str</span><span class="p">[</span><span class="n">step</span><span class="p">],</span> <span class="o">**</span><span class="n">log_scopt</span><span class="p">)</span>
            <span class="n">dic_c_tmp</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([</span><span class="n">dic_tmp</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">step</span><span class="p">]</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;x&#39;</span><span class="p">],</span>
                                      <span class="n">dic_tmp</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">step</span><span class="p">]</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;y&#39;</span><span class="p">],</span>
                                      <span class="n">dic_tmp</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">step</span><span class="p">]</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;z&#39;</span><span class="p">]],</span>
                                     <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">,</span><span class="s1">&#39;y&#39;</span><span class="p">,</span><span class="s1">&#39;z&#39;</span><span class="p">])</span>
            <span class="n">dic_Sdev_tmp</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([</span><span class="n">dic_tmp</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">step</span><span class="p">]</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;Sx&#39;</span><span class="p">],</span>
                                         <span class="n">dic_tmp</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">step</span><span class="p">]</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;Sy&#39;</span><span class="p">],</span>
                                         <span class="n">dic_tmp</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">step</span><span class="p">]</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;Sz&#39;</span><span class="p">]],</span>
                                        <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Sx&#39;</span><span class="p">,</span><span class="s1">&#39;Sy&#39;</span><span class="p">,</span><span class="s1">&#39;Sz&#39;</span><span class="p">])</span>
    
            <span class="c1"># Krücke, muss besser gehen:</span>
            <span class="n">fps</span><span class="o">=</span><span class="p">[]</span>
            <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="n">tester</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">step</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">tester</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">step</span><span class="p">]</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">l</span><span class="p">]:</span>
                    <span class="n">fps</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">l</span><span class="p">)</span>
            <span class="n">dic_c_tmp</span> <span class="o">=</span> <span class="n">dic_c_tmp</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">fps</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">dic_Sdev_tmp</span>  <span class="o">=</span> <span class="n">dic_Sdev_tmp</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">fps</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
            
            <span class="n">Pmeas</span>      <span class="o">=</span> <span class="n">dic_c_tmp</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="n">dic_c_tmp</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="n">pat</span><span class="o">=</span><span class="n">_opts</span><span class="p">[</span><span class="s1">&#39;OPT_DIC_Points_meas_prefix&#39;</span><span class="p">],</span><span class="n">na</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">regex</span><span class="o">=</span><span class="kc">True</span><span class="p">)]</span>
            <span class="n">Pspec</span>      <span class="o">=</span> <span class="n">dic_c_tmp</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="n">dic_c_tmp</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="n">pat</span><span class="o">=</span><span class="n">_opts</span><span class="p">[</span><span class="s1">&#39;OPT_DIC_Points_device_prefix&#39;</span><span class="p">],</span><span class="n">na</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">regex</span><span class="o">=</span><span class="kc">True</span><span class="p">)]</span>
            <span class="n">Pmeas_Sdev</span> <span class="o">=</span> <span class="n">dic_Sdev_tmp</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="n">dic_Sdev_tmp</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="n">pat</span><span class="o">=</span><span class="n">_opts</span><span class="p">[</span><span class="s1">&#39;OPT_DIC_Points_meas_prefix&#39;</span><span class="p">],</span><span class="n">na</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">regex</span><span class="o">=</span><span class="kc">True</span><span class="p">)]</span>
            <span class="n">Pspec_Sdev</span> <span class="o">=</span> <span class="n">dic_Sdev_tmp</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="n">dic_Sdev_tmp</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="n">pat</span><span class="o">=</span><span class="n">_opts</span><span class="p">[</span><span class="s1">&#39;OPT_DIC_Points_device_prefix&#39;</span><span class="p">],</span><span class="n">na</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">regex</span><span class="o">=</span><span class="kc">True</span><span class="p">)]</span>
            
            <span class="c1"># Start 3D point transformation</span>
            <span class="n">Points_T</span><span class="p">[</span><span class="n">step</span><span class="p">],</span> <span class="n">Points_L_T</span><span class="p">[</span><span class="n">step</span><span class="p">]</span> <span class="o">=</span> <span class="n">emeb</span><span class="o">.</span><span class="n">opt_mps</span><span class="o">.</span><span class="n">Point_df_transform</span><span class="p">(</span>
                <span class="n">Pmeas</span> <span class="o">=</span> <span class="n">Pmeas</span><span class="p">,</span>
                <span class="n">Pspec</span> <span class="o">=</span> <span class="n">Pspec</span><span class="p">,</span>
                <span class="n">Pmeas_Sdev</span> <span class="o">=</span> <span class="n">Pmeas_Sdev</span><span class="p">,</span>
                <span class="n">Pspec_Sdev</span> <span class="o">=</span> <span class="n">Pspec_Sdev</span><span class="p">,</span>
                <span class="n">dic_P_name_org1</span> <span class="o">=</span> <span class="n">_opts</span><span class="p">[</span><span class="s1">&#39;OPT_DIC_Points_TBT_device&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span>
                <span class="n">dic_P_name_org2</span> <span class="o">=</span> <span class="n">_opts</span><span class="p">[</span><span class="s1">&#39;OPT_DIC_Points_TBT_device&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span>
                <span class="n">output_lvl</span> <span class="o">=</span> <span class="n">log_scopt</span><span class="p">[</span><span class="s1">&#39;output_lvl&#39;</span><span class="p">],</span>
                <span class="n">log_mg</span> <span class="o">=</span> <span class="n">log_scopt</span><span class="p">[</span><span class="s1">&#39;logfp&#39;</span><span class="p">])</span>
    
        <span class="n">Points_L_T_stacked</span><span class="o">=</span><span class="n">dic_tmp</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">deep</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">Points_L_T_stacked</span><span class="o">.</span><span class="n">loc</span><span class="p">[:]</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span>
        <span class="n">Points_T_stacked</span><span class="o">=</span><span class="n">dic_tmp</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">deep</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">Points_T_stacked</span><span class="o">.</span><span class="n">loc</span><span class="p">[:]</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span>
        
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">step_range_dic</span><span class="p">:</span>
            <span class="n">Points_L_T_stacked</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">Points_L_T</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">stack</span><span class="p">()</span>
            <span class="n">Points_T_stacked</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">Points_T</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">stack</span><span class="p">()</span>
            <span class="c1"># Pcoord_val_m[i]=np.polyval(Pcoord[i],0)</span>
            <span class="c1"># Pcoord_val_lr[i]=np.polyval(Pcoord[i],[-Pcoord_val_L/2,Pcoord_val_L/2]).mean()</span>
        
        <span class="n">pt</span><span class="o">=</span><span class="n">emeb</span><span class="o">.</span><span class="n">opt_mps</span><span class="o">.</span><span class="n">Point_df_idx</span><span class="p">(</span><span class="n">Points_L_T_stacked</span><span class="p">,</span> <span class="n">coords</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">,</span><span class="s1">&#39;y&#39;</span><span class="p">],</span> <span class="n">deepcopy</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">pt_S</span><span class="o">=</span><span class="n">emeb</span><span class="o">.</span><span class="n">opt_mps</span><span class="o">.</span><span class="n">Point_df_idx</span><span class="p">(</span><span class="n">pt</span><span class="p">,</span> <span class="n">points</span><span class="o">=</span><span class="s1">&#39;S&#39;</span><span class="p">,</span> <span class="n">deepcopy</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">option</span><span class="o">=</span><span class="s1">&#39;Regex&#39;</span><span class="p">)</span>
        <span class="n">pt_P</span><span class="o">=</span><span class="n">emeb</span><span class="o">.</span><span class="n">opt_mps</span><span class="o">.</span><span class="n">Point_df_idx</span><span class="p">(</span><span class="n">pt</span><span class="p">,</span> <span class="n">points</span><span class="o">=</span><span class="s1">&#39;P&#39;</span><span class="p">,</span> <span class="n">deepcopy</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">option</span><span class="o">=</span><span class="s1">&#39;Regex&#39;</span><span class="p">)</span>
        <span class="n">geo_fit</span> <span class="o">=</span> <span class="n">emeb</span><span class="o">.</span><span class="n">fitting</span><span class="o">.</span><span class="n">Perform_Fit</span><span class="p">(</span>
            <span class="n">BFL</span><span class="o">=</span><span class="n">bl</span><span class="p">,</span> <span class="n">Fit_func_key</span><span class="o">=</span><span class="s1">&#39;w_A&#39;</span><span class="p">,</span> <span class="n">P_df</span><span class="o">=</span><span class="n">pt_P</span><span class="p">,</span>
            <span class="n">lB</span><span class="o">=</span><span class="n">Bo_Le</span><span class="p">,</span> <span class="n">rB</span><span class="o">=</span><span class="n">Bo_Ri</span><span class="p">,</span> <span class="n">s_range</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="n">Shear_func_key</span><span class="o">=</span><span class="s1">&#39;w_S&#39;</span><span class="p">,</span> <span class="n">gamma_V</span><span class="o">=</span><span class="n">gamma_V</span><span class="p">,</span> 
            <span class="n">err_weights</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
            <span class="n">max_nfev</span><span class="o">=</span><span class="n">_opts</span><span class="p">[</span><span class="s1">&#39;OPT_DIC_Fitting&#39;</span><span class="p">][</span><span class="s1">&#39;Bending_MCFit_opts&#39;</span><span class="p">][</span><span class="s1">&#39;fit_max_nfev_pre&#39;</span><span class="p">],</span>
            <span class="n">option</span><span class="o">=</span><span class="s1">&#39;Pre&#39;</span><span class="p">,</span> <span class="n">pb_b</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="o">**</span><span class="n">pwargs</span>
            <span class="p">)</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        
        <span class="n">geo_d2_max</span> <span class="o">=</span> <span class="n">bl</span><span class="p">[</span><span class="s1">&#39;w_A&#39;</span><span class="p">][</span><span class="s1">&#39;d2&#39;</span><span class="p">](</span><span class="n">xlin</span><span class="p">,</span><span class="n">geo_fit</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;Fit_params_dict&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
        <span class="n">geo_d2_min</span> <span class="o">=</span> <span class="n">bl</span><span class="p">[</span><span class="s1">&#39;w_A&#39;</span><span class="p">][</span><span class="s1">&#39;d2&#39;</span><span class="p">](</span><span class="n">xlin</span><span class="p">,</span><span class="n">geo_fit</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;Fit_params_dict&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
        <span class="n">geo_d2_mid</span> <span class="o">=</span> <span class="n">bl</span><span class="p">[</span><span class="s1">&#39;w_A&#39;</span><span class="p">][</span><span class="s1">&#39;d2&#39;</span><span class="p">](</span><span class="mf">0.0</span><span class="p">,</span><span class="n">geo_fit</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;Fit_params_dict&#39;</span><span class="p">])</span>
        
        <span class="n">fig</span><span class="p">,</span> <span class="n">ax1</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1"> - Geometry&#39;</span><span class="o">%</span><span class="p">(</span><span class="n">plt_name</span><span class="p">))</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x / mm&#39;</span><span class="p">)</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;y / mm&#39;</span><span class="p">)</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xlin</span><span class="p">,</span> <span class="n">bl</span><span class="p">[</span><span class="s1">&#39;w_A&#39;</span><span class="p">][</span><span class="s1">&#39;d0&#39;</span><span class="p">](</span><span class="n">xlin</span><span class="p">,</span><span class="n">geo_fit</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;Fit_params_dict&#39;</span><span class="p">]),</span> <span class="s1">&#39;r:&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Org.&#39;</span><span class="p">)</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">pt_P</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;x&#39;</span><span class="p">],</span><span class="n">pt_P</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;y&#39;</span><span class="p">],</span> <span class="s1">&#39;ko&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;org. P&#39;</span><span class="p">)</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">pt_S</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;x&#39;</span><span class="p">],</span><span class="n">pt_S</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;y&#39;</span><span class="p">],</span> <span class="s1">&#39;k+&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;org. S&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">pt</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">droplevel</span><span class="p">(</span><span class="mi">1</span><span class="p">):</span>
            <span class="n">ax1</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">x</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="n">pt</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">x</span><span class="p">,</span><span class="s1">&#39;x&#39;</span><span class="p">],</span><span class="n">pt</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">x</span><span class="p">,</span><span class="s1">&#39;y&#39;</span><span class="p">]),</span>
                         <span class="n">xycoords</span><span class="o">=</span><span class="s1">&#39;data&#39;</span><span class="p">,</span> <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="o">-</span><span class="mi">7</span><span class="p">),</span> <span class="n">textcoords</span><span class="o">=</span><span class="s1">&#39;offset points&#39;</span><span class="p">)</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
        <span class="n">plt_hsuf</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span><span class="n">path</span><span class="o">=</span><span class="n">out_full</span><span class="o">+</span><span class="s2">&quot;-DIC_fit_Geo&quot;</span><span class="p">,</span><span class="o">**</span><span class="n">plt_scopt</span><span class="p">)</span>
        
        <span class="n">P_xcoord_ydisp</span> <span class="o">=</span> <span class="n">Points_L_T_stacked</span><span class="o">.</span><span class="n">loc</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)[:,[</span><span class="s1">&#39;x&#39;</span><span class="p">,</span><span class="s1">&#39;y&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">P_xcoord_ydisp</span><span class="o">.</span><span class="n">loc</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)[:,</span><span class="s1">&#39;y&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">P_xcoord_ydisp</span><span class="o">.</span><span class="n">loc</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)[:,</span><span class="s1">&#39;y&#39;</span><span class="p">]</span><span class="o">-</span><span class="n">P_xcoord_ydisp</span><span class="o">.</span><span class="n">loc</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)[:,</span><span class="s1">&#39;y&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">P_xcoord_ydisp_meas</span> <span class="o">=</span> <span class="n">P_xcoord_ydisp</span><span class="o">.</span><span class="n">loc</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)[</span><span class="n">P_xcoord_ydisp</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">droplevel</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="n">pat</span><span class="o">=</span><span class="s1">&#39;P&#39;</span><span class="p">,</span><span class="n">na</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">regex</span><span class="o">=</span><span class="kc">True</span><span class="p">)]</span>
        <span class="n">P_xcoord_ydisp_spec</span> <span class="o">=</span> <span class="n">P_xcoord_ydisp</span><span class="o">.</span><span class="n">loc</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)[</span><span class="n">P_xcoord_ydisp</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">droplevel</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="n">pat</span><span class="o">=</span><span class="s1">&#39;S&#39;</span><span class="p">,</span><span class="n">na</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">regex</span><span class="o">=</span><span class="kc">True</span><span class="p">)]</span>

        <span class="n">dic</span><span class="p">[</span><span class="s1">&#39;Disp_opt_head&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">P_xcoord_ydisp_spec</span><span class="o">.</span><span class="n">loc</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)[(</span><span class="n">_opts</span><span class="p">[</span><span class="s1">&#39;OPT_DIC_Points_TBT_device&#39;</span><span class="p">][</span><span class="mi">2</span><span class="p">],</span><span class="s1">&#39;y&#39;</span><span class="p">)]</span>
        <span class="k">if</span> <span class="n">_opts</span><span class="p">[</span><span class="s1">&#39;OPT_Compression&#39;</span><span class="p">]:</span> <span class="n">dic</span><span class="p">[</span><span class="s1">&#39;Disp_opt_head&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">dic</span><span class="p">[</span><span class="s1">&#39;Disp_opt_head&#39;</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    
    
    <span class="n">dicu</span><span class="o">=</span><span class="n">dic</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">deep</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="c1"># dicu=pd.DataFrame({&#39;Time&#39;: dic.Time, &#39;DWay&#39;: dic.DWay, &#39;DStrain&#39;: dic.DL1GS, &#39;DStrainq&#39;: dic.DL2GS})</span>
    <span class="k">del</span> <span class="n">dic_tmp</span><span class="p">,</span><span class="n">anp</span><span class="p">,</span><span class="n">ans</span>
    <span class="k">del</span> <span class="n">dic_c_tmp</span><span class="p">,</span><span class="n">dic_Sdev_tmp</span>
    <span class="k">del</span> <span class="n">Pmeas</span><span class="p">,</span><span class="n">Pspec</span><span class="p">,</span><span class="n">Pmeas_Sdev</span><span class="p">,</span><span class="n">Pspec_Sdev</span>
    <span class="k">del</span> <span class="n">Points_T</span><span class="p">,</span><span class="n">Points_L_T</span>
    <span class="k">del</span> <span class="n">pt</span><span class="p">,</span><span class="n">pt_S</span><span class="p">,</span><span class="n">pt_P</span>
    
    <span class="c1"># =============================================================================</span>
    <span class="c1">#%% 4 Merging measurements</span>
    <span class="n">log_custom</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2"> &quot;</span><span class="o">+</span><span class="s2">&quot;=&quot;</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span><span class="o">**</span><span class="n">log_scopt</span><span class="p">)</span>
    <span class="n">log_custom</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2"> ### 4 Merging measurements ###&quot;</span><span class="p">,</span><span class="o">**</span><span class="n">log_scoptf</span><span class="p">)</span>
    <span class="n">timings</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mf">4.0</span><span class="p">]</span><span class="o">=</span><span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span>
    <span class="n">log_custom</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">   Timing </span><span class="si">%f</span><span class="s2">: </span><span class="si">%.5f</span><span class="s2"> s&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">timings</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span>
                                       <span class="n">timings</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">timings</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span>
                   <span class="o">**</span><span class="n">log_scopt</span><span class="p">)</span>
    <span class="c1"># =============================================================================</span>
    <span class="c1">#%%% 4.1 Determine time offset between conventional and optical measurement</span>
    <span class="n">timings</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mf">4.1</span><span class="p">]</span><span class="o">=</span><span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span>
    <span class="n">log_custom</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">   Timing </span><span class="si">%f</span><span class="s2">: </span><span class="si">%.5f</span><span class="s2"> s&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">timings</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span>
                                       <span class="n">timings</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">timings</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span>
                   <span class="o">**</span><span class="n">log_scopt</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">_opts</span><span class="p">[</span><span class="s1">&#39;OPT_DIC&#39;</span><span class="p">]:</span>
        <span class="n">mun_tmp</span> <span class="o">=</span> <span class="n">messu</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span>
            <span class="nb">abs</span><span class="p">(</span><span class="n">messu</span><span class="o">.</span><span class="n">Way</span><span class="o">.</span><span class="n">loc</span><span class="p">[:(</span><span class="n">messu</span><span class="o">.</span><span class="n">Way</span><span class="o">.</span><span class="n">idxmax</span><span class="p">())]</span><span class="o">-</span><span class="n">messu</span><span class="o">.</span><span class="n">Way</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">/</span><span class="mi">8</span><span class="p">)</span><span class="o">.</span><span class="n">idxmin</span><span class="p">():</span>
            <span class="nb">abs</span><span class="p">(</span><span class="n">messu</span><span class="o">.</span><span class="n">Way</span><span class="o">.</span><span class="n">loc</span><span class="p">[:(</span><span class="n">messu</span><span class="o">.</span><span class="n">Way</span><span class="o">.</span><span class="n">idxmax</span><span class="p">())]</span><span class="o">-</span><span class="n">messu</span><span class="o">.</span><span class="n">Way</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">/</span><span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">idxmin</span><span class="p">()</span>
            <span class="p">]</span>
        <span class="n">linvm</span>   <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">polyfit</span><span class="p">(</span><span class="n">mun_tmp</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;Time&#39;</span><span class="p">],</span><span class="n">mun_tmp</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;Way&#39;</span><span class="p">],</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">tsm</span>     <span class="o">=</span> <span class="o">-</span><span class="n">linvm</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="n">linvm</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">mun_tmp</span> <span class="o">=</span> <span class="n">dicu</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span>
            <span class="nb">abs</span><span class="p">(</span><span class="n">dicu</span><span class="o">.</span><span class="n">Disp_opt_head</span><span class="o">.</span><span class="n">loc</span><span class="p">[:(</span><span class="n">dicu</span><span class="o">.</span><span class="n">Disp_opt_head</span><span class="o">.</span><span class="n">idxmax</span><span class="p">())]</span><span class="o">-</span><span class="n">dicu</span><span class="o">.</span><span class="n">Disp_opt_head</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">/</span><span class="mi">8</span><span class="p">)</span><span class="o">.</span><span class="n">idxmin</span><span class="p">():</span>
            <span class="nb">abs</span><span class="p">(</span><span class="n">dicu</span><span class="o">.</span><span class="n">Disp_opt_head</span><span class="o">.</span><span class="n">loc</span><span class="p">[:(</span><span class="n">dicu</span><span class="o">.</span><span class="n">Disp_opt_head</span><span class="o">.</span><span class="n">idxmax</span><span class="p">())]</span><span class="o">-</span><span class="n">dicu</span><span class="o">.</span><span class="n">Disp_opt_head</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">/</span><span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">idxmin</span><span class="p">()</span>
            <span class="p">]</span>
        <span class="n">linvd</span>   <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">polyfit</span><span class="p">(</span><span class="n">mun_tmp</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;Time&#39;</span><span class="p">],</span><span class="n">mun_tmp</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;Disp_opt_head&#39;</span><span class="p">],</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">tsd</span>     <span class="o">=</span> <span class="o">-</span><span class="n">linvd</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="n">linvd</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">toff</span>    <span class="o">=</span> <span class="n">tsm</span><span class="o">-</span><span class="n">tsd</span>
        
        <span class="k">if</span> <span class="kc">True</span><span class="p">:</span>
            <span class="n">maxt_tmp</span><span class="o">=</span><span class="nb">max</span><span class="p">(</span>
                <span class="n">messu</span><span class="o">.</span><span class="n">Time</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="nb">abs</span><span class="p">(</span><span class="n">messu</span><span class="o">.</span><span class="n">Way</span><span class="o">.</span><span class="n">loc</span><span class="p">[:(</span><span class="n">messu</span><span class="o">.</span><span class="n">Way</span><span class="o">.</span><span class="n">idxmax</span><span class="p">())]</span><span class="o">-</span><span class="n">messu</span><span class="o">.</span><span class="n">Way</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">/</span><span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">idxmin</span><span class="p">()],</span>
                <span class="n">dicu</span><span class="o">.</span><span class="n">Time</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="nb">abs</span><span class="p">(</span><span class="n">dicu</span><span class="o">.</span><span class="n">Disp_opt_head</span><span class="o">.</span><span class="n">loc</span><span class="p">[:(</span><span class="n">dicu</span><span class="o">.</span><span class="n">Disp_opt_head</span><span class="o">.</span><span class="n">idxmax</span><span class="p">())]</span><span class="o">-</span><span class="n">dicu</span><span class="o">.</span><span class="n">Disp_opt_head</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">/</span><span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">idxmin</span><span class="p">()]</span>
                <span class="p">)</span>
            <span class="n">xlin_tmp</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">tsm</span><span class="p">,</span><span class="n">tsd</span><span class="p">),</span><span class="n">maxt_tmp</span><span class="p">,</span><span class="mi">11</span><span class="p">)</span>
            
            <span class="n">fig</span><span class="p">,</span> <span class="n">ax1</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
            <span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1"> - Way-measuring time difference&#39;</span><span class="o">%</span><span class="n">plt_name</span><span class="p">)</span>
            <span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Time / s&#39;</span><span class="p">)</span>
            <span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Way / mm&#39;</span><span class="p">)</span>
            <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">messu</span><span class="o">.</span><span class="n">Time</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">messu</span><span class="o">.</span><span class="n">Time</span><span class="o">&lt;=</span><span class="n">maxt_tmp</span><span class="p">],</span> 
                     <span class="n">messu</span><span class="o">.</span><span class="n">Way</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">messu</span><span class="o">.</span><span class="n">Time</span><span class="o">&lt;=</span><span class="n">maxt_tmp</span><span class="p">],</span> 
                     <span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;PM-way&#39;</span><span class="p">)</span>
            <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">dicu</span><span class="o">.</span><span class="n">Time</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dicu</span><span class="o">.</span><span class="n">Time</span><span class="o">&lt;=</span><span class="n">maxt_tmp</span><span class="p">],</span>
                     <span class="n">dicu</span><span class="o">.</span><span class="n">Disp_opt_head</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dicu</span><span class="o">.</span><span class="n">Time</span><span class="o">&lt;=</span><span class="n">maxt_tmp</span><span class="p">],</span>
                     <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;DIC-way&#39;</span><span class="p">)</span>
            <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xlin_tmp</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">polyval</span><span class="p">(</span><span class="n">linvm</span><span class="p">,</span><span class="n">xlin_tmp</span><span class="p">),</span>
                     <span class="s1">&#39;y:&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;PM-lin&#39;</span><span class="p">)</span>
            <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xlin_tmp</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">polyval</span><span class="p">(</span><span class="n">linvd</span><span class="p">,</span><span class="n">xlin_tmp</span><span class="p">),</span>
                     <span class="s1">&#39;g:&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;DIC-lin&#39;</span><span class="p">)</span>
            <span class="n">ax1</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">tsm</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> 
                        <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;PM-way-start&#39;</span><span class="p">)</span>
            <span class="n">ax1</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">tsd</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> 
                        <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;DIC-way-start&#39;</span><span class="p">)</span>
            <span class="n">ax1</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
            <span class="n">ftxt</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;$t_{S,PM}$  = </span><span class="si">% 2.4f</span><span class="s1"> s &#39;</span><span class="o">%</span><span class="p">(</span><span class="n">tsm</span><span class="p">),</span>
                  <span class="s1">&#39;$t_{S,DIC}$ = </span><span class="si">% 2.4f</span><span class="s1"> s &#39;</span><span class="o">%</span><span class="p">(</span><span class="n">tsd</span><span class="p">))</span>
            <span class="n">fig</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.95</span><span class="p">,</span><span class="mf">0.15</span><span class="p">,</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">ftxt</span><span class="p">),</span>
                     <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">,</span><span class="n">va</span><span class="o">=</span><span class="s1">&#39;bottom&#39;</span><span class="p">,</span> 
                     <span class="n">bbox</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">boxstyle</span><span class="o">=</span><span class="s1">&#39;round&#39;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;0.8&#39;</span><span class="p">,</span> 
                               <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">))</span>
            <span class="n">plt_hsuf</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span><span class="n">path</span><span class="o">=</span><span class="n">out_full</span><span class="o">+</span><span class="s2">&quot;-toff&quot;</span><span class="p">,</span><span class="o">**</span><span class="n">plt_scopt</span><span class="p">)</span>
            <span class="k">del</span> <span class="n">xlin_tmp</span>
        
        <span class="n">log_custom</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2"> &quot;</span><span class="o">+</span><span class="s2">&quot;-&quot;</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span><span class="o">**</span><span class="n">log_scopt</span><span class="p">)</span>
        <span class="n">log_custom</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">   Time offset between PM and DIC: </span><span class="si">%.3f</span><span class="s2"> s&quot;</span> <span class="o">%</span><span class="p">(</span><span class="n">toff</span><span class="p">),</span>
                   <span class="o">**</span><span class="n">log_scoptf</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">toff</span><span class="o">=</span><span class="mf">0.0</span>
        
    <span class="n">messu</span><span class="o">.</span><span class="n">Time</span><span class="o">=</span><span class="p">(</span><span class="n">messu</span><span class="o">.</span><span class="n">Time</span><span class="o">-</span><span class="n">toff</span><span class="p">)</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">rel_time_digs</span><span class="p">)</span>
    
    <span class="c1"># =============================================================================</span>
    <span class="c1">#%%% 4.2 Downsampling of conventional data</span>
    <span class="n">timings</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mf">4.2</span><span class="p">]</span><span class="o">=</span><span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span>
    <span class="n">log_custom</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">   Timing </span><span class="si">%f</span><span class="s2">: </span><span class="si">%.5f</span><span class="s2"> s&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">timings</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span>
                                       <span class="n">timings</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">timings</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span>
                   <span class="o">**</span><span class="n">log_scopt</span><span class="p">)</span>
    
    <span class="n">messu</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">mess_f</span> <span class="o">=</span> <span class="n">emec</span><span class="o">.</span><span class="n">mc_man</span><span class="o">.</span><span class="n">mc_resampler</span><span class="p">(</span>
        <span class="n">mdf</span><span class="o">=</span><span class="n">messu</span><span class="p">,</span> 
        <span class="n">t_col</span><span class="o">=</span><span class="n">_opts</span><span class="p">[</span><span class="s1">&#39;OPT_Measurement_file&#39;</span><span class="p">][</span><span class="s1">&#39;used_names_dict&#39;</span><span class="p">][</span><span class="s1">&#39;Time&#39;</span><span class="p">],</span> 
        <span class="n">resample</span><span class="o">=</span><span class="n">_opts</span><span class="p">[</span><span class="s1">&#39;OPT_Resampling&#39;</span><span class="p">],</span> 
        <span class="n">res_frequ</span><span class="o">=</span><span class="n">_opts</span><span class="p">[</span><span class="s1">&#39;OPT_Resampling_Frequency&#39;</span><span class="p">],</span> 
        <span class="n">move_ave</span><span class="o">=</span><span class="n">_opts</span><span class="p">[</span><span class="s1">&#39;OPT_Resampling_moveave&#39;</span><span class="p">],</span> 
        <span class="n">ma_sampler</span><span class="o">=</span><span class="s1">&#39;data_rf&#39;</span><span class="p">,</span>
        <span class="n">rel_time_digs</span><span class="o">=</span><span class="n">rel_time_digs</span><span class="p">)</span> 
    
    <span class="c1"># =============================================================================</span>
    <span class="c1">#%%% 4.3 Merge optical to conventional data</span>
    <span class="n">timings</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mf">4.3</span><span class="p">]</span><span class="o">=</span><span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span>
    <span class="n">log_custom</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">   Timing </span><span class="si">%f</span><span class="s2">: </span><span class="si">%.5f</span><span class="s2"> s&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">timings</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span>
                                       <span class="n">timings</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">timings</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span>
                   <span class="o">**</span><span class="n">log_scopt</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">_opts</span><span class="p">[</span><span class="s1">&#39;OPT_DIC&#39;</span><span class="p">]:</span>
        <span class="n">dicu</span><span class="o">.</span><span class="n">Time</span><span class="o">=</span><span class="n">dicu</span><span class="o">.</span><span class="n">Time</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">rel_time_digs</span><span class="p">)</span>
        <span class="n">ind</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">RangeIndex</span><span class="p">(</span><span class="n">dicu</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dicu</span><span class="o">.</span><span class="n">Time</span><span class="o">&gt;=</span><span class="n">messu</span><span class="o">.</span><span class="n">Time</span><span class="o">.</span><span class="n">min</span><span class="p">()]</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                          <span class="n">messu</span><span class="o">.</span><span class="n">Time</span><span class="o">.</span><span class="n">count</span><span class="p">()</span><span class="o">+</span><span class="n">dicu</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dicu</span><span class="o">.</span><span class="n">Time</span><span class="o">&gt;=</span><span class="n">messu</span><span class="o">.</span><span class="n">Time</span><span class="o">.</span><span class="n">min</span><span class="p">()]</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">messu</span><span class="o">=</span><span class="n">messu</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">dicu</span><span class="p">,</span><span class="n">how</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;Time&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="n">ind</span><span class="p">)</span>
        
    <span class="k">else</span><span class="p">:</span>
        <span class="n">dic_f</span><span class="o">=</span><span class="nb">round</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">dic_dt</span><span class="p">)</span>
        
    <span class="n">f_vdm</span><span class="o">=</span><span class="n">dic_f</span><span class="o">/</span><span class="n">mess_f</span>
        
    <span class="c1"># =============================================================================</span>
    <span class="c1">#%% 5 Start and End</span>
    <span class="n">log_custom</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2"> &quot;</span><span class="o">+</span><span class="s2">&quot;=&quot;</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span><span class="o">**</span><span class="n">log_scopt</span><span class="p">)</span>
    <span class="n">log_custom</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2"> ### 5 Start and End ###&quot;</span><span class="p">,</span><span class="o">**</span><span class="n">log_scoptf</span><span class="p">)</span>
    <span class="n">timings</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mf">5.0</span><span class="p">]</span><span class="o">=</span><span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span>
    <span class="n">log_custom</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">   Timing </span><span class="si">%f</span><span class="s2">: </span><span class="si">%.5f</span><span class="s2"> s&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">timings</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span>
                                       <span class="n">timings</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">timings</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span>
                   <span class="o">**</span><span class="n">log_scopt</span><span class="p">)</span>                                                    
    <span class="c1"># =============================================================================</span>
    <span class="c1">#%%% 5.1 Determine start and end of evaluation</span>
    <span class="n">timings</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mf">5.1</span><span class="p">]</span><span class="o">=</span><span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span>
    <span class="n">log_custom</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">   Timing </span><span class="si">%f</span><span class="s2">: </span><span class="si">%.5f</span><span class="s2"> s&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">timings</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span>
                                       <span class="n">timings</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">timings</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span>
                   <span class="o">**</span><span class="n">log_scopt</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">_opts</span><span class="p">[</span><span class="s1">&#39;OPT_End&#39;</span><span class="p">]):</span>
        <span class="n">dic_to_mess_End</span><span class="o">=</span><span class="n">messu</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">name</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># dic_to_mess_End=messu.loc[messu.Time&lt;=prot.loc[prot_lnr][&#39;DIC_End&#39;]*1/f_vdm].index[-1]</span>
        <span class="n">dic_to_mess_End</span><span class="o">=</span><span class="n">messu</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">messu</span><span class="o">.</span><span class="n">Time</span><span class="o">&lt;=</span><span class="n">_opts</span><span class="p">[</span><span class="s1">&#39;OPT_End&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        
    <span class="n">mun_tmp</span><span class="o">=</span><span class="n">messu</span><span class="o">.</span><span class="n">loc</span><span class="p">[:</span><span class="nb">min</span><span class="p">(</span><span class="n">dic_to_mess_End</span><span class="p">,</span><span class="n">messu</span><span class="o">.</span><span class="n">Force</span><span class="o">.</span><span class="n">idxmax</span><span class="p">()),</span><span class="s1">&#39;Force&#39;</span><span class="p">]</span>
    <span class="n">messu</span><span class="p">[</span><span class="s1">&#39;driF&#39;</span><span class="p">],</span><span class="n">messu</span><span class="p">[</span><span class="s1">&#39;dcuF&#39;</span><span class="p">],</span><span class="n">messu</span><span class="p">[</span><span class="s1">&#39;driF_schg&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">emec</span><span class="o">.</span><span class="n">mc_char</span><span class="o">.</span><span class="n">rise_curve</span><span class="p">(</span>
        <span class="n">messu</span><span class="o">.</span><span class="n">loc</span><span class="p">[:</span><span class="n">dic_to_mess_End</span><span class="p">][</span><span class="s1">&#39;Force&#39;</span><span class="p">],</span>
        <span class="n">_opts</span><span class="p">[</span><span class="s1">&#39;OPT_Rise_Smoothing&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">_opts</span><span class="p">[</span><span class="s1">&#39;OPT_Rise_Smoothing&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
        <span class="p">)</span>
    
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">messu</span><span class="o">.</span><span class="n">index</span><span class="p">:</span> <span class="c1"># Startpunkt über Vorzeichenwechsel im Anstieg</span>
        <span class="k">if</span> <span class="n">messu</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="s1">&#39;driF_schg&#39;</span><span class="p">]:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">messu</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="nb">max</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">_opts</span><span class="p">[</span><span class="s1">&#39;OPT_Determination_Distance&#39;</span><span class="p">]</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span><span class="mi">1</span><span class="p">),</span><span class="s1">&#39;driF_schg&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">any</span><span class="p">():</span>
                <span class="n">messu_iS</span><span class="o">=</span><span class="n">i</span>
                <span class="k">break</span>
    
    <span class="n">messu_iS</span><span class="p">,</span><span class="n">_</span><span class="o">=</span><span class="n">emec</span><span class="o">.</span><span class="n">mc_char</span><span class="o">.</span><span class="n">find_SandE</span><span class="p">(</span>
        <span class="n">messu</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">messu_iS</span><span class="p">:</span><span class="o">+</span><span class="n">messu_iS</span><span class="o">+</span><span class="n">_opts</span><span class="p">[</span><span class="s1">&#39;OPT_Determination_Distance&#39;</span><span class="p">],</span><span class="s1">&#39;driF&#39;</span><span class="p">],</span>
        <span class="nb">abs</span><span class="p">(</span><span class="n">messu</span><span class="p">[</span><span class="s1">&#39;driF&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="mf">0.5</span><span class="p">),</span>
        <span class="s2">&quot;pgm_other&quot;</span><span class="p">,</span>
        <span class="mf">0.1</span>
        <span class="p">)</span>
    <span class="c1"># _,messu_iE=emec.mc_char.find_SandE(messu[&#39;driF&#39;],0,&quot;qua_self&quot;,0.5) # not changed 251022 (B5-sr09)</span>
    <span class="k">try</span><span class="p">:</span> <span class="c1"># search after maximum Force</span>
        <span class="n">_</span><span class="p">,</span><span class="n">messu_iE</span><span class="o">=</span><span class="n">emec</span><span class="o">.</span><span class="n">mc_char</span><span class="o">.</span><span class="n">find_SandE</span><span class="p">(</span>
            <span class="n">messu</span><span class="p">[</span><span class="s1">&#39;driF&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">messu</span><span class="o">.</span><span class="n">Force</span><span class="o">.</span><span class="n">idxmax</span><span class="p">():],</span>
            <span class="n">messu</span><span class="p">[</span><span class="s1">&#39;driF&#39;</span><span class="p">],</span>
            <span class="s2">&quot;qua_other&quot;</span><span class="p">,</span>
            <span class="mf">0.5</span>
            <span class="p">)</span>
    <span class="k">except</span> <span class="ne">IndexError</span><span class="p">:</span>
        <span class="n">messu_iE</span><span class="o">=</span><span class="n">dic_to_mess_End</span>
    <span class="n">messu_iE</span><span class="o">=</span><span class="nb">min</span><span class="p">(</span><span class="n">messu_iE</span><span class="p">,</span><span class="n">dic_to_mess_End</span><span class="p">)</span>
    
    <span class="n">log_custom</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2"> &quot;</span><span class="o">+</span><span class="s2">&quot;-&quot;</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span><span class="o">**</span><span class="n">log_scopt</span><span class="p">)</span>
    <span class="n">log_custom</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">   Start of evaluation after </span><span class="si">%.3f</span><span class="s2"> seconds, corresponds to </span><span class="si">%.5f</span><span class="s2"> </span><span class="si">%%</span><span class="s2"> of max. force.&quot;</span>
               <span class="o">%</span><span class="p">(</span><span class="n">messu</span><span class="o">.</span><span class="n">Time</span><span class="p">[</span><span class="n">messu_iS</span><span class="p">],</span><span class="mi">100</span><span class="o">*</span><span class="nb">abs</span><span class="p">(</span><span class="n">messu</span><span class="o">.</span><span class="n">Force</span><span class="p">[</span><span class="n">messu_iS</span><span class="p">])</span><span class="o">/</span><span class="nb">abs</span><span class="p">(</span><span class="n">messu</span><span class="o">.</span><span class="n">Force</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">()),</span>
               <span class="o">**</span><span class="n">log_scoptf</span><span class="p">)</span>
    
    <span class="n">messu</span><span class="o">=</span><span class="n">messu</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">messu_iS</span><span class="p">:</span><span class="n">messu_iE</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">_opts</span><span class="p">[</span><span class="s1">&#39;OPT_DIC&#39;</span><span class="p">]:</span>
        <span class="n">P_xcoord_ydisp_meas</span><span class="o">=</span><span class="n">P_xcoord_ydisp_meas</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">messu_iS</span><span class="p">:</span><span class="n">messu_iE</span><span class="p">]</span>
        <span class="n">P_xcoord_ydisp_spec</span><span class="o">=</span><span class="n">P_xcoord_ydisp_spec</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">messu_iS</span><span class="p">:</span><span class="n">messu_iE</span><span class="p">]</span>
        <span class="n">step_range_dic</span> <span class="o">=</span> <span class="n">emec</span><span class="o">.</span><span class="n">pd_ext</span><span class="o">.</span><span class="n">pd_combine_index</span><span class="p">(</span><span class="n">step_range_dic</span><span class="p">,</span><span class="n">messu</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
        <span class="c1"># step_range_dic = emec.pd_ext.pd_combine_index(step_range_dic[1:],messu.index)</span>
        
    <span class="n">fig</span><span class="p">,</span> <span class="n">ax1</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1"> - Measuring&#39;</span><span class="o">%</span><span class="n">plt_name</span><span class="p">)</span>
    <span class="n">color1</span> <span class="o">=</span> <span class="s1">&#39;tab:red&#39;</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Time / s&#39;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Force / N&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color1</span><span class="p">)</span>  <span class="c1"># we already handled the x-label with ax1</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">labelcolor</span><span class="o">=</span><span class="n">color1</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">messu</span><span class="o">.</span><span class="n">Time</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">messu_iS</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">messu</span><span class="o">.</span><span class="n">Time</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">messu_iE</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">invert</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">_opts</span><span class="p">[</span><span class="s1">&#39;OPT_End&#39;</span><span class="p">])):</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">_opts</span><span class="p">[</span><span class="s1">&#39;OPT_End&#39;</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-.&#39;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">mess</span><span class="o">.</span><span class="n">Time</span><span class="p">,</span> <span class="o">-</span><span class="n">mess</span><span class="o">.</span><span class="n">F_WZ</span><span class="p">,</span> <span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Force-WZ&#39;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">mess</span><span class="o">.</span><span class="n">Time</span><span class="p">,</span> <span class="o">-</span><span class="n">mess</span><span class="o">.</span><span class="n">F_PM</span><span class="p">,</span> <span class="s1">&#39;m-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Force-PM&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">_opts</span><span class="p">[</span><span class="s1">&#39;OPT_Springreduction&#39;</span><span class="p">]:</span> 
        <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">mess</span><span class="o">.</span><span class="n">Time</span><span class="p">,</span> <span class="o">-</span><span class="n">mess</span><span class="o">.</span><span class="n">F_IWA_red</span><span class="p">,</span> <span class="s1">&#39;b:&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Force-IWA&#39;</span><span class="p">)</span>
    <span class="n">ax2</span> <span class="o">=</span> <span class="n">ax1</span><span class="o">.</span><span class="n">twinx</span><span class="p">()</span>  <span class="c1"># instantiate a second axes that shares the same x-axis</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">color2</span> <span class="o">=</span> <span class="s1">&#39;tab:blue&#39;</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Way / mm&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color2</span><span class="p">)</span>  <span class="c1"># we already handled the x-label with ax1</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">labelcolor</span><span class="o">=</span><span class="n">color2</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">mess</span><span class="o">.</span><span class="n">Time</span><span class="p">,</span> <span class="o">-</span><span class="p">(</span><span class="n">mess</span><span class="o">.</span><span class="n">L_PM</span><span class="p">),</span> <span class="s1">&#39;y--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Way-PM&#39;</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">mess</span><span class="o">.</span><span class="n">Time</span><span class="p">,</span> <span class="n">mess</span><span class="o">.</span><span class="n">L_IWA1</span><span class="o">-</span><span class="n">mess</span><span class="o">.</span><span class="n">L_IWA1</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;b--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Way-IWA1&#39;</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">mess</span><span class="o">.</span><span class="n">Time</span><span class="p">,</span> <span class="n">mess</span><span class="o">.</span><span class="n">L_IWA2</span><span class="o">-</span><span class="n">mess</span><span class="o">.</span><span class="n">L_IWA2</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;b-.&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Way-IWA2&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">_opts</span><span class="p">[</span><span class="s1">&#39;OPT_DIC&#39;</span><span class="p">]:</span>
        <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">dic</span><span class="o">.</span><span class="n">Time</span><span class="p">,</span> <span class="n">dic</span><span class="o">.</span><span class="n">Disp_opt_head</span><span class="p">,</span> <span class="s1">&#39;k:&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Way-DIC&#39;</span><span class="p">)</span>
        <span class="c1"># ax2.plot(dic.Time, dic.DDisp_PM_c, &#39;m:&#39;, label=&#39;Way-DIC-P&#39;)</span>
        <span class="c1"># ax2.plot(dic.Time, dic.DDisp_PC_c, &#39;g:&#39;, label=&#39;Way-DIC-C&#39;)</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper left&#39;</span><span class="p">,</span> <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">),</span> <span class="n">ncol</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">plt_hsuf</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span><span class="n">path</span><span class="o">=</span><span class="n">out_full</span><span class="o">+</span><span class="s2">&quot;-meas&quot;</span><span class="p">,</span><span class="o">**</span><span class="n">plt_scopt</span><span class="p">)</span>
    
    <span class="c1"># =============================================================================</span>
    <span class="c1">#%%% 5.2 Resetting way</span>
    <span class="n">timings</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mf">5.2</span><span class="p">]</span><span class="o">=</span><span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span>
    <span class="n">log_custom</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">   Timing </span><span class="si">%f</span><span class="s2">: </span><span class="si">%.5f</span><span class="s2"> s&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">timings</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span>
                                       <span class="n">timings</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">timings</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span>
                   <span class="o">**</span><span class="n">log_scopt</span><span class="p">)</span>
    <span class="c1"># messu.Force=messu.Force-messu.Force.loc[messu_iS]</span>
    <span class="n">messu</span><span class="o">.</span><span class="n">Way</span><span class="o">=</span><span class="n">messu</span><span class="o">.</span><span class="n">Way</span><span class="o">-</span><span class="n">messu</span><span class="o">.</span><span class="n">Way</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">messu_iS</span><span class="p">]</span>
    
    <span class="k">if</span> <span class="n">_opts</span><span class="p">[</span><span class="s1">&#39;OPT_DIC&#39;</span><span class="p">]:</span>    
        <span class="n">messu</span><span class="o">.</span><span class="n">Disp_opt_head</span><span class="o">=</span><span class="n">messu</span><span class="o">.</span><span class="n">Disp_opt_head</span><span class="o">-</span><span class="n">messu</span><span class="o">.</span><span class="n">Disp_opt_head</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">messu_iS</span><span class="p">]</span>
        <span class="n">P_xcoord_ydisp_meas</span><span class="o">.</span><span class="n">loc</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)[:,</span><span class="s1">&#39;y&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">P_xcoord_ydisp_meas</span><span class="o">.</span><span class="n">loc</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)[:,</span><span class="s1">&#39;y&#39;</span><span class="p">]</span><span class="o">-</span><span class="n">P_xcoord_ydisp_meas</span><span class="o">.</span><span class="n">loc</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)[:,</span><span class="s1">&#39;y&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">messu_iS</span><span class="p">]</span>
        <span class="n">P_xcoord_ydisp_spec</span><span class="o">.</span><span class="n">loc</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)[:,</span><span class="s1">&#39;y&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">P_xcoord_ydisp_spec</span><span class="o">.</span><span class="n">loc</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)[:,</span><span class="s1">&#39;y&#39;</span><span class="p">]</span><span class="o">-</span><span class="n">P_xcoord_ydisp_spec</span><span class="o">.</span><span class="n">loc</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)[:,</span><span class="s1">&#39;y&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">messu_iS</span><span class="p">]</span>

    <span class="n">fig</span><span class="p">,</span> <span class="n">ax1</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1"> - Measuring (used)&#39;</span><span class="o">%</span><span class="n">plt_name</span><span class="p">)</span>
    <span class="n">color1</span> <span class="o">=</span> <span class="s1">&#39;tab:red&#39;</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Time / s&#39;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Force / N&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color1</span><span class="p">)</span>  <span class="c1"># we already handled the x-label with ax1</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">labelcolor</span><span class="o">=</span><span class="n">color1</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">messu</span><span class="o">.</span><span class="n">Time</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">messu_iS</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">messu</span><span class="o">.</span><span class="n">Time</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">messu_iE</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">messu</span><span class="o">.</span><span class="n">Time</span><span class="p">,</span> <span class="n">messu</span><span class="o">.</span><span class="n">Force</span><span class="p">,</span> <span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Force&#39;</span><span class="p">)</span>
    <span class="n">ax2</span> <span class="o">=</span> <span class="n">ax1</span><span class="o">.</span><span class="n">twinx</span><span class="p">()</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">color2</span> <span class="o">=</span> <span class="s1">&#39;tab:blue&#39;</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Way / mm&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color2</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">labelcolor</span><span class="o">=</span><span class="n">color2</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">messu</span><span class="o">.</span><span class="n">Time</span><span class="p">,</span> <span class="n">messu</span><span class="o">.</span><span class="n">Way</span><span class="p">,</span> <span class="s1">&#39;b--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Way&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">_opts</span><span class="p">[</span><span class="s1">&#39;OPT_DIC&#39;</span><span class="p">]:</span>
        <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">messu</span><span class="o">.</span><span class="n">Time</span><span class="p">,</span> <span class="n">messu</span><span class="o">.</span><span class="n">Disp_opt_head</span><span class="p">,</span> <span class="s1">&#39;k:&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Way-DIC&#39;</span><span class="p">)</span>
        <span class="c1"># ax2.plot(messu.Time, messu.DDisp_PM_c, &#39;m:&#39;, label=&#39;Way-DIC-P&#39;)</span>
        <span class="c1"># ax2.plot(messu.Time, messu.DDisp_PC_c, &#39;g:&#39;, label=&#39;Way-DIC-C&#39;)</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper left&#39;</span><span class="p">,</span> <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">),</span> <span class="n">ncol</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">plt_hsuf</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span><span class="n">path</span><span class="o">=</span><span class="n">out_full</span><span class="o">+</span><span class="s2">&quot;-meas_u&quot;</span><span class="p">,</span><span class="o">**</span><span class="n">plt_scopt</span><span class="p">)</span>
    
    <span class="c1"># =============================================================================</span>
    <span class="c1">#%% 6 Evaluation</span>
    <span class="n">log_custom</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2"> &quot;</span><span class="o">+</span><span class="s2">&quot;=&quot;</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span><span class="o">**</span><span class="n">log_scopt</span><span class="p">)</span>
    <span class="n">log_custom</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2"> ### 6 Evaluation ###&quot;</span><span class="p">,</span><span class="o">**</span><span class="n">log_scoptf</span><span class="p">)</span>
    <span class="n">timings</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mf">6.0</span><span class="p">]</span><span class="o">=</span><span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span>
    <span class="n">log_custom</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">   Timing </span><span class="si">%f</span><span class="s2">: </span><span class="si">%.5f</span><span class="s2"> s&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">timings</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span>
                                       <span class="n">timings</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">timings</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span>
                   <span class="o">**</span><span class="n">log_scopt</span><span class="p">)</span>
    <span class="c1"># =============================================================================</span>
    <span class="c1">#%%% 6.0 Perform DIC-fittings</span>
    <span class="c1">#%%%% 6.11 Pre-Fit with all components (Indentaion, shear force deformation and bending deformation)</span>
    <span class="n">log_custom</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2"> &quot;</span><span class="o">+</span><span class="s2">&quot;-&quot;</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span><span class="o">**</span><span class="n">log_scopt</span><span class="p">)</span>
    <span class="n">log_custom</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">## Pre-fit on displacements:&#39;</span><span class="p">,</span><span class="o">**</span><span class="n">log_scopt</span><span class="p">)</span>
    <span class="n">timings</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mf">6.11</span><span class="p">]</span><span class="o">=</span><span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span>
    <span class="n">log_custom</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">   Timing </span><span class="si">%f</span><span class="s2">: </span><span class="si">%.5f</span><span class="s2"> s&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">timings</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span>
                                       <span class="n">timings</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">timings</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span>
                   <span class="o">**</span><span class="n">log_scopt</span><span class="p">)</span>
    
    <span class="n">Pre_fit_df</span> <span class="o">=</span> <span class="n">emeb</span><span class="o">.</span><span class="n">fitting</span><span class="o">.</span><span class="n">Perform_Fit</span><span class="p">(</span>
        <span class="n">BFL</span><span class="o">=</span><span class="n">bl</span><span class="p">,</span> <span class="n">Fit_func_key</span><span class="o">=</span><span class="s1">&#39;w_A&#39;</span><span class="p">,</span> 
        <span class="n">P_df</span><span class="o">=</span><span class="n">P_xcoord_ydisp_meas</span><span class="p">,</span>
        <span class="n">lB</span><span class="o">=</span><span class="n">Bo_Le</span><span class="p">,</span> <span class="n">rB</span><span class="o">=</span><span class="n">Bo_Ri</span><span class="p">,</span> 
        <span class="c1"># s_range=step_range_dic, #Verschiebung an 0 is 0</span>
        <span class="n">s_range</span><span class="o">=</span><span class="n">step_range_dic</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span>
        <span class="n">Shear_func_key</span><span class="o">=</span><span class="s1">&#39;w_S&#39;</span><span class="p">,</span> <span class="n">gamma_V</span><span class="o">=</span><span class="n">gamma_V</span><span class="p">,</span> 
        <span class="n">err_weights</span><span class="o">=</span><span class="n">_opts</span><span class="p">[</span><span class="s1">&#39;OPT_DIC_Fitting&#39;</span><span class="p">][</span><span class="s1">&#39;Bending_MCFit_opts&#39;</span><span class="p">][</span><span class="s1">&#39;error_weights_pre&#39;</span><span class="p">],</span> 
        <span class="n">max_nfev</span><span class="o">=</span><span class="n">_opts</span><span class="p">[</span><span class="s1">&#39;OPT_DIC_Fitting&#39;</span><span class="p">][</span><span class="s1">&#39;Bending_MCFit_opts&#39;</span><span class="p">][</span><span class="s1">&#39;fit_max_nfev_pre&#39;</span><span class="p">],</span>
        <span class="n">nan_policy</span><span class="o">=</span><span class="s1">&#39;omit&#39;</span><span class="p">,</span>
        <span class="n">option</span><span class="o">=</span><span class="s1">&#39;Pre&#39;</span><span class="p">,</span> <span class="n">pb_b</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="o">**</span><span class="n">pwargs</span>
        <span class="p">)</span>
    <span class="k">for</span> <span class="n">step</span> <span class="ow">in</span> <span class="n">Pre_fit_df</span><span class="o">.</span><span class="n">index</span><span class="p">:</span>
        <span class="n">ftxt</span><span class="o">=</span><span class="n">lmfit</span><span class="o">.</span><span class="n">fit_report</span><span class="p">(</span><span class="n">Pre_fit_df</span><span class="p">[</span><span class="s1">&#39;Fit_Result&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">step</span><span class="p">])</span>
        <span class="n">ftxt</span><span class="o">=</span><span class="n">ftxt</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">[[Variables]]&quot;</span><span class="p">,</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">    R-square-multi     = </span><span class="si">%1.5f</span><span class="se">\n</span><span class="s2">[[Variables]]&quot;</span><span class="o">%</span><span class="n">Pre_fit_df</span><span class="p">[</span><span class="s1">&#39;Rquad_multi&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">step</span><span class="p">])</span>
        <span class="n">ftxt</span><span class="o">=</span><span class="n">ftxt</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">[[Variables]]&quot;</span><span class="p">,</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">    R-square-disp      = </span><span class="si">%1.5f</span><span class="se">\n</span><span class="s2">[[Variables]]&quot;</span><span class="o">%</span><span class="n">Pre_fit_df</span><span class="p">[</span><span class="s1">&#39;Rquad_disp&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">step</span><span class="p">])</span>
        <span class="n">log_custom</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">  Step </span><span class="si">%d</span><span class="s1">&#39;</span><span class="o">%</span><span class="n">step</span><span class="o">+</span><span class="n">log_cind</span><span class="p">(</span><span class="n">ftxt</span><span class="p">),</span>
                       <span class="o">**</span><span class="n">log_scopt</span><span class="p">)</span>

    
    <span class="c1"># =============================================================================</span>
    <span class="c1">#%%%% 6.12 Refit to adjusted bending deformation</span>
    <span class="n">log_custom</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2"> &quot;</span><span class="o">+</span><span class="s2">&quot;-&quot;</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span><span class="o">**</span><span class="n">log_scopt</span><span class="p">)</span>
    <span class="n">log_custom</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">## Bend-fit on displacements:&#39;</span><span class="p">,</span><span class="o">**</span><span class="n">log_scopt</span><span class="p">)</span>
    <span class="n">timings</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mf">6.12</span><span class="p">]</span><span class="o">=</span><span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span>
    <span class="n">log_custom</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">   Timing </span><span class="si">%f</span><span class="s2">: </span><span class="si">%.5f</span><span class="s2"> s&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">timings</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span>
                                       <span class="n">timings</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">timings</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span>
                   <span class="o">**</span><span class="n">log_scopt</span><span class="p">)</span>
    
    <span class="n">P_xcoord_ydisp_meas_M</span><span class="o">=</span><span class="n">P_xcoord_ydisp_meas</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">step_range_dic</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">deep</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">P_xcoord_ydisp_meas_S</span><span class="o">=</span><span class="n">P_xcoord_ydisp_meas</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">step_range_dic</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">deep</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">iy</span><span class="o">=</span><span class="n">bl</span><span class="p">[</span><span class="s1">&#39;w_I&#39;</span><span class="p">][</span><span class="s1">&#39;d0&#39;</span><span class="p">](</span><span class="n">emeb</span><span class="o">.</span><span class="n">opt_mps</span><span class="o">.</span><span class="n">Point_df_idx</span><span class="p">(</span><span class="n">P_xcoord_ydisp_meas_M</span><span class="p">,</span><span class="n">coords</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">),</span>
                       <span class="n">Pre_fit_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;Fit_params_dict&#39;</span><span class="p">])</span>
    <span class="n">vy</span><span class="o">=</span><span class="n">bl</span><span class="p">[</span><span class="s1">&#39;w_V&#39;</span><span class="p">][</span><span class="s1">&#39;d0&#39;</span><span class="p">](</span><span class="n">emeb</span><span class="o">.</span><span class="n">opt_mps</span><span class="o">.</span><span class="n">Point_df_idx</span><span class="p">(</span><span class="n">P_xcoord_ydisp_meas_M</span><span class="p">,</span><span class="n">coords</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">),</span>
                       <span class="n">Pre_fit_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;Fit_params_dict&#39;</span><span class="p">])</span>
    <span class="n">P_xcoord_ydisp_meas_S</span><span class="o">.</span><span class="n">loc</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)[:,</span><span class="s1">&#39;y&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">P_xcoord_ydisp_meas_S</span><span class="o">.</span><span class="n">loc</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)[:,</span><span class="s1">&#39;y&#39;</span><span class="p">]</span><span class="o">-</span><span class="n">iy</span>
    <span class="n">P_xcoord_ydisp_meas_M</span><span class="o">.</span><span class="n">loc</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)[:,</span><span class="s1">&#39;y&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">P_xcoord_ydisp_meas_M</span><span class="o">.</span><span class="n">loc</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)[:,</span><span class="s1">&#39;y&#39;</span><span class="p">]</span><span class="o">-</span><span class="n">iy</span><span class="o">-</span><span class="n">vy</span>
    
    <span class="n">Bend_fit_df</span> <span class="o">=</span> <span class="n">emeb</span><span class="o">.</span><span class="n">fitting</span><span class="o">.</span><span class="n">Perform_Fit</span><span class="p">(</span>
        <span class="n">BFL</span><span class="o">=</span><span class="n">bl</span><span class="p">,</span> <span class="n">Fit_func_key</span><span class="o">=</span><span class="s1">&#39;w_M&#39;</span><span class="p">,</span>
        <span class="n">P_df</span><span class="o">=</span><span class="n">P_xcoord_ydisp_meas_M</span><span class="p">,</span>
        <span class="n">lB</span><span class="o">=</span><span class="n">Bo_Le</span><span class="p">,</span> <span class="n">rB</span><span class="o">=</span><span class="n">Bo_Ri</span><span class="p">,</span> 
        <span class="n">s_range</span><span class="o">=</span><span class="n">step_range_dic</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span> 
        <span class="n">err_weights</span><span class="o">=</span><span class="n">_opts</span><span class="p">[</span><span class="s1">&#39;OPT_DIC_Fitting&#39;</span><span class="p">][</span><span class="s1">&#39;Bending_MCFit_opts&#39;</span><span class="p">][</span><span class="s1">&#39;error_weights_bend&#39;</span><span class="p">],</span> 
        <span class="n">max_nfev</span><span class="o">=</span><span class="n">_opts</span><span class="p">[</span><span class="s1">&#39;OPT_DIC_Fitting&#39;</span><span class="p">][</span><span class="s1">&#39;Bending_MCFit_opts&#39;</span><span class="p">][</span><span class="s1">&#39;fit_max_nfev_bend&#39;</span><span class="p">],</span>
        <span class="n">nan_policy</span><span class="o">=</span><span class="s1">&#39;omit&#39;</span><span class="p">,</span>
        <span class="n">option</span><span class="o">=</span><span class="s1">&#39;Bend&#39;</span><span class="p">,</span> <span class="n">pb_b</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="o">**</span><span class="n">pwargs</span>
        <span class="p">)</span>
    <span class="k">for</span> <span class="n">step</span> <span class="ow">in</span> <span class="n">Bend_fit_df</span><span class="o">.</span><span class="n">index</span><span class="p">:</span>
        <span class="n">ftxt</span><span class="o">=</span><span class="n">lmfit</span><span class="o">.</span><span class="n">fit_report</span><span class="p">(</span><span class="n">Bend_fit_df</span><span class="p">[</span><span class="s1">&#39;Fit_Result&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">step</span><span class="p">])</span>
        <span class="n">ftxt</span><span class="o">=</span><span class="n">ftxt</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">[[Variables]]&quot;</span><span class="p">,</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">    R-square-multi     = </span><span class="si">%1.5f</span><span class="se">\n</span><span class="s2">[[Variables]]&quot;</span><span class="o">%</span><span class="n">Bend_fit_df</span><span class="p">[</span><span class="s1">&#39;Rquad_multi&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">step</span><span class="p">])</span>
        <span class="n">ftxt</span><span class="o">=</span><span class="n">ftxt</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">[[Variables]]&quot;</span><span class="p">,</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">    R-square-disp      = </span><span class="si">%1.5f</span><span class="se">\n</span><span class="s2">[[Variables]]&quot;</span><span class="o">%</span><span class="n">Bend_fit_df</span><span class="p">[</span><span class="s1">&#39;Rquad_disp&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">step</span><span class="p">])</span>
        <span class="n">log_custom</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">  Step </span><span class="si">%d</span><span class="s1">&#39;</span><span class="o">%</span><span class="n">step</span><span class="o">+</span><span class="n">log_cind</span><span class="p">(</span><span class="n">ftxt</span><span class="p">),</span>
                       <span class="o">**</span><span class="n">log_scopt</span><span class="p">)</span>
    
    <span class="c1"># =============================================================================</span>
    <span class="c1">#%%%% Incremental:</span>
    <span class="c1"># P_xcoord_ydiff = emeb.opt_mps.Points_diff(emeb.opt_mps.Point_df_idx(Points_L_T_stacked, coords=[&#39;x&#39;,&#39;y&#39;], deepcopy=True))</span>
    <span class="n">P_xcoord_ydiff</span> <span class="o">=</span> <span class="n">emeb</span><span class="o">.</span><span class="n">opt_mps</span><span class="o">.</span><span class="n">Points_diff</span><span class="p">(</span><span class="n">P_xcoord_ydisp</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">step_range_dic</span><span class="p">])</span>

    <span class="n">P_xcoord_ydiff_meas</span> <span class="o">=</span> <span class="n">emeb</span><span class="o">.</span><span class="n">opt_mps</span><span class="o">.</span><span class="n">Point_df_idx</span><span class="p">(</span>
        <span class="n">P_xcoord_ydiff</span><span class="p">,</span> <span class="n">steps</span><span class="o">=</span><span class="n">step_range_dic</span><span class="p">,</span> 
        <span class="n">points</span><span class="o">=</span><span class="s1">&#39;P&#39;</span><span class="p">,</span> <span class="n">deepcopy</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">option</span><span class="o">=</span><span class="s1">&#39;Regex&#39;</span>
        <span class="p">)</span>
    <span class="n">P_xcoord_ydiff_spec</span> <span class="o">=</span> <span class="n">emeb</span><span class="o">.</span><span class="n">opt_mps</span><span class="o">.</span><span class="n">Point_df_idx</span><span class="p">(</span>
        <span class="n">P_xcoord_ydiff</span><span class="p">,</span> <span class="n">steps</span><span class="o">=</span><span class="n">step_range_dic</span><span class="p">,</span> 
        <span class="n">points</span><span class="o">=</span><span class="s1">&#39;S&#39;</span><span class="p">,</span> <span class="n">deepcopy</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">option</span><span class="o">=</span><span class="s1">&#39;Regex&#39;</span>
        <span class="p">)</span>
    <span class="n">step_range_dic_inc</span> <span class="o">=</span> <span class="n">step_range_dic</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">invert</span><span class="p">(</span>
        <span class="n">emeb</span><span class="o">.</span><span class="n">opt_mps</span><span class="o">.</span><span class="n">Point_df_idx</span><span class="p">(</span>
            <span class="n">P_xcoord_ydiff_meas</span><span class="p">,</span> <span class="n">steps</span><span class="o">=</span><span class="n">step_range_dic</span><span class="p">,</span> <span class="n">coords</span><span class="o">=</span><span class="s1">&#39;y&#39;</span>
            <span class="p">)</span><span class="o">.</span><span class="n">isna</span><span class="p">())</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="p">(</span><span class="n">_opts</span><span class="p">[</span><span class="s1">&#39;OPT_DIC_Tester&#39;</span><span class="p">][</span><span class="mi">3</span><span class="p">]))]</span>
    <span class="c1"># =============================================================================</span>
    <span class="c1">#%%%% 6.13 Pre-Fit with all components (Indentaion, shear force deformation and bending deformation)</span>
    <span class="n">log_custom</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2"> &quot;</span><span class="o">+</span><span class="s2">&quot;-&quot;</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span><span class="o">**</span><span class="n">log_scopt</span><span class="p">)</span>
    <span class="n">log_custom</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">## Pre-fit on increments:&#39;</span><span class="p">,</span><span class="o">**</span><span class="n">log_scopt</span><span class="p">)</span>
    <span class="n">timings</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mf">6.13</span><span class="p">]</span><span class="o">=</span><span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span>
    <span class="n">log_custom</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">   Timing </span><span class="si">%f</span><span class="s2">: </span><span class="si">%.5f</span><span class="s2"> s&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">timings</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span>
                                       <span class="n">timings</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">timings</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span>
                   <span class="o">**</span><span class="n">log_scopt</span><span class="p">)</span>
    
    <span class="n">Pre_inc_fit_df</span> <span class="o">=</span> <span class="n">emeb</span><span class="o">.</span><span class="n">fitting</span><span class="o">.</span><span class="n">Perform_Fit</span><span class="p">(</span>
        <span class="n">BFL</span><span class="o">=</span><span class="n">bl</span><span class="p">,</span> <span class="n">Fit_func_key</span><span class="o">=</span><span class="s1">&#39;w_A&#39;</span><span class="p">,</span> 
        <span class="n">P_df</span><span class="o">=</span><span class="n">P_xcoord_ydiff_meas</span><span class="p">,</span>
        <span class="n">lB</span><span class="o">=</span><span class="n">Bo_Le</span><span class="p">,</span> <span class="n">rB</span><span class="o">=</span><span class="n">Bo_Ri</span><span class="p">,</span> 
        <span class="n">s_range</span><span class="o">=</span><span class="n">step_range_dic_inc</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span>
        <span class="n">Shear_func_key</span><span class="o">=</span><span class="s1">&#39;w_S&#39;</span><span class="p">,</span> <span class="n">gamma_V</span><span class="o">=</span><span class="n">gamma_V</span><span class="p">,</span> 
        <span class="n">err_weights</span><span class="o">=</span><span class="n">_opts</span><span class="p">[</span><span class="s1">&#39;OPT_DIC_Fitting&#39;</span><span class="p">][</span><span class="s1">&#39;Bending_MCFit_opts&#39;</span><span class="p">][</span><span class="s1">&#39;error_weights_pre_inc&#39;</span><span class="p">],</span> 
        <span class="n">max_nfev</span><span class="o">=</span><span class="n">_opts</span><span class="p">[</span><span class="s1">&#39;OPT_DIC_Fitting&#39;</span><span class="p">][</span><span class="s1">&#39;Bending_MCFit_opts&#39;</span><span class="p">][</span><span class="s1">&#39;fit_max_nfev_pre_inc&#39;</span><span class="p">],</span>
        <span class="n">nan_policy</span><span class="o">=</span><span class="s1">&#39;omit&#39;</span><span class="p">,</span>
        <span class="n">option</span><span class="o">=</span><span class="s1">&#39;Pre&#39;</span><span class="p">,</span> <span class="n">pb_b</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="o">**</span><span class="n">pwargs</span>
        <span class="p">)</span>
    <span class="k">for</span> <span class="n">step</span> <span class="ow">in</span> <span class="n">Pre_inc_fit_df</span><span class="o">.</span><span class="n">index</span><span class="p">:</span>
        <span class="n">ftxt</span><span class="o">=</span><span class="n">lmfit</span><span class="o">.</span><span class="n">fit_report</span><span class="p">(</span><span class="n">Pre_inc_fit_df</span><span class="p">[</span><span class="s1">&#39;Fit_Result&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">step</span><span class="p">])</span>
        <span class="n">ftxt</span><span class="o">=</span><span class="n">ftxt</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">[[Variables]]&quot;</span><span class="p">,</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">    R-square-multi     = </span><span class="si">%1.5f</span><span class="se">\n</span><span class="s2">[[Variables]]&quot;</span><span class="o">%</span><span class="n">Pre_inc_fit_df</span><span class="p">[</span><span class="s1">&#39;Rquad_multi&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">step</span><span class="p">])</span>
        <span class="n">ftxt</span><span class="o">=</span><span class="n">ftxt</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">[[Variables]]&quot;</span><span class="p">,</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">    R-square-disp      = </span><span class="si">%1.5f</span><span class="se">\n</span><span class="s2">[[Variables]]&quot;</span><span class="o">%</span><span class="n">Pre_inc_fit_df</span><span class="p">[</span><span class="s1">&#39;Rquad_disp&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">step</span><span class="p">])</span>
        <span class="n">log_custom</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">  Step </span><span class="si">%d</span><span class="s1">&#39;</span><span class="o">%</span><span class="n">step</span><span class="o">+</span><span class="n">log_cind</span><span class="p">(</span><span class="n">ftxt</span><span class="p">),</span>
                       <span class="o">**</span><span class="n">log_scopt</span><span class="p">)</span>
    
    <span class="c1"># =============================================================================</span>
    <span class="c1">#%%%% 6.14 Refit to adjusted bending deformation</span>
    <span class="n">log_custom</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2"> &quot;</span><span class="o">+</span><span class="s2">&quot;-&quot;</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span><span class="o">**</span><span class="n">log_scopt</span><span class="p">)</span>
    <span class="n">log_custom</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">## Bend-fit on increments:&#39;</span><span class="p">,</span><span class="o">**</span><span class="n">log_scopt</span><span class="p">)</span>
    <span class="n">timings</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mf">6.14</span><span class="p">]</span><span class="o">=</span><span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span>
    <span class="n">log_custom</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">   Timing </span><span class="si">%f</span><span class="s2">: </span><span class="si">%.5f</span><span class="s2"> s&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">timings</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span>
                                       <span class="n">timings</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">timings</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span>
                   <span class="o">**</span><span class="n">log_scopt</span><span class="p">)</span>
    
    <span class="n">P_xcoord_ydiff_meas_M</span><span class="o">=</span><span class="n">P_xcoord_ydiff_meas</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">step_range_dic</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">deep</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">P_xcoord_ydiff_meas_S</span><span class="o">=</span><span class="n">P_xcoord_ydiff_meas</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">step_range_dic</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">deep</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">iy</span><span class="o">=</span><span class="n">bl</span><span class="p">[</span><span class="s1">&#39;w_I&#39;</span><span class="p">][</span><span class="s1">&#39;d0&#39;</span><span class="p">](</span>
        <span class="n">emeb</span><span class="o">.</span><span class="n">opt_mps</span><span class="o">.</span><span class="n">Point_df_idx</span><span class="p">(</span><span class="n">P_xcoord_ydiff_meas_M</span><span class="p">,</span> <span class="n">coords</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">),</span>
        <span class="n">Pre_inc_fit_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;Fit_params_dict&#39;</span><span class="p">]</span>
        <span class="p">)</span>
    <span class="n">vy</span><span class="o">=</span><span class="n">bl</span><span class="p">[</span><span class="s1">&#39;w_V&#39;</span><span class="p">][</span><span class="s1">&#39;d0&#39;</span><span class="p">](</span>
        <span class="n">emeb</span><span class="o">.</span><span class="n">opt_mps</span><span class="o">.</span><span class="n">Point_df_idx</span><span class="p">(</span><span class="n">P_xcoord_ydiff_meas_M</span><span class="p">,</span> <span class="n">coords</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">),</span>
        <span class="n">Pre_inc_fit_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;Fit_params_dict&#39;</span><span class="p">]</span>
        <span class="p">)</span>
    <span class="n">P_xcoord_ydiff_meas_S</span><span class="o">.</span><span class="n">loc</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)[:,</span><span class="s1">&#39;y&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">P_xcoord_ydiff_meas_S</span><span class="o">.</span><span class="n">loc</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)[:,</span><span class="s1">&#39;y&#39;</span><span class="p">]</span><span class="o">-</span><span class="n">iy</span>
    <span class="n">P_xcoord_ydiff_meas_M</span><span class="o">.</span><span class="n">loc</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)[:,</span><span class="s1">&#39;y&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">P_xcoord_ydiff_meas_M</span><span class="o">.</span><span class="n">loc</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)[:,</span><span class="s1">&#39;y&#39;</span><span class="p">]</span><span class="o">-</span><span class="n">iy</span><span class="o">-</span><span class="n">vy</span>
    
    <span class="n">Bend_inc_fit_df</span> <span class="o">=</span> <span class="n">emeb</span><span class="o">.</span><span class="n">fitting</span><span class="o">.</span><span class="n">Perform_Fit</span><span class="p">(</span>
        <span class="n">BFL</span><span class="o">=</span><span class="n">bl</span><span class="p">,</span> <span class="n">Fit_func_key</span><span class="o">=</span><span class="s1">&#39;w_M&#39;</span><span class="p">,</span>
        <span class="n">P_df</span><span class="o">=</span><span class="n">P_xcoord_ydiff_meas_M</span><span class="p">,</span>
        <span class="n">lB</span><span class="o">=</span><span class="n">Bo_Le</span><span class="p">,</span> <span class="n">rB</span><span class="o">=</span><span class="n">Bo_Ri</span><span class="p">,</span> 
        <span class="n">s_range</span><span class="o">=</span><span class="n">step_range_dic_inc</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span> 
        <span class="n">err_weights</span><span class="o">=</span><span class="n">_opts</span><span class="p">[</span><span class="s1">&#39;OPT_DIC_Fitting&#39;</span><span class="p">][</span><span class="s1">&#39;Bending_MCFit_opts&#39;</span><span class="p">][</span><span class="s1">&#39;error_weights_bend_inc&#39;</span><span class="p">],</span> 
        <span class="n">max_nfev</span><span class="o">=</span><span class="n">_opts</span><span class="p">[</span><span class="s1">&#39;OPT_DIC_Fitting&#39;</span><span class="p">][</span><span class="s1">&#39;Bending_MCFit_opts&#39;</span><span class="p">][</span><span class="s1">&#39;fit_max_nfev_bend_inc&#39;</span><span class="p">],</span>
        <span class="n">nan_policy</span><span class="o">=</span><span class="s1">&#39;omit&#39;</span><span class="p">,</span>
        <span class="n">option</span><span class="o">=</span><span class="s1">&#39;Bend&#39;</span><span class="p">,</span> <span class="n">pb_b</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="o">**</span><span class="n">pwargs</span>
        <span class="p">)</span>
    <span class="k">for</span> <span class="n">step</span> <span class="ow">in</span> <span class="n">Bend_inc_fit_df</span><span class="o">.</span><span class="n">index</span><span class="p">:</span>
        <span class="n">ftxt</span><span class="o">=</span><span class="n">lmfit</span><span class="o">.</span><span class="n">fit_report</span><span class="p">(</span><span class="n">Bend_inc_fit_df</span><span class="p">[</span><span class="s1">&#39;Fit_Result&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">step</span><span class="p">])</span>
        <span class="n">ftxt</span><span class="o">=</span><span class="n">ftxt</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">[[Variables]]&quot;</span><span class="p">,</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">    R-square-multi     = </span><span class="si">%1.5f</span><span class="se">\n</span><span class="s2">[[Variables]]&quot;</span><span class="o">%</span><span class="n">Bend_inc_fit_df</span><span class="p">[</span><span class="s1">&#39;Rquad_multi&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">step</span><span class="p">])</span>
        <span class="n">ftxt</span><span class="o">=</span><span class="n">ftxt</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">[[Variables]]&quot;</span><span class="p">,</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">    R-square-disp      = </span><span class="si">%1.5f</span><span class="se">\n</span><span class="s2">[[Variables]]&quot;</span><span class="o">%</span><span class="n">Bend_inc_fit_df</span><span class="p">[</span><span class="s1">&#39;Rquad_disp&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">step</span><span class="p">])</span>
        <span class="n">log_custom</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">  Step </span><span class="si">%d</span><span class="s1">&#39;</span><span class="o">%</span><span class="n">step</span><span class="o">+</span><span class="n">log_cind</span><span class="p">(</span><span class="n">ftxt</span><span class="p">),</span>
                       <span class="o">**</span><span class="n">log_scopt</span><span class="p">)</span>
    
    <span class="k">if</span> <span class="kc">True</span><span class="p">:</span>
        <span class="c1"># Fit comparison ----------------------------------------------------------</span>
        <span class="c1"># step=messu.Force.idxmax()</span>
        <span class="n">step</span> <span class="o">=</span> <span class="n">emec</span><span class="o">.</span><span class="n">pd_ext</span><span class="o">.</span><span class="n">pd_combine_index</span><span class="p">(</span>
            <span class="n">messu</span><span class="o">.</span><span class="n">loc</span><span class="p">[:</span><span class="n">messu</span><span class="o">.</span><span class="n">Force</span><span class="o">.</span><span class="n">idxmax</span><span class="p">()],</span>
            <span class="n">step_range_dic_inc</span>
            <span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        
        <span class="n">fig</span><span class="p">,</span> <span class="n">ax1</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1"> - Fit-compare - Displacement for step </span><span class="si">%i</span><span class="s1">&#39;</span><span class="o">%</span><span class="p">(</span><span class="n">plt_name</span><span class="p">,</span><span class="n">step</span><span class="p">))</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x / mm&#39;</span><span class="p">)</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;y displacement / mm&#39;</span><span class="p">)</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xlin</span><span class="p">,</span> <span class="n">bl</span><span class="p">[</span><span class="s1">&#39;w_A&#39;</span><span class="p">][</span><span class="s1">&#39;d0&#39;</span><span class="p">](</span><span class="n">xlin</span><span class="p">,</span><span class="n">Pre_fit_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">step</span><span class="p">,</span><span class="s1">&#39;Fit_params_dict&#39;</span><span class="p">]),</span>
                 <span class="s1">&#39;r:&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Org.&#39;</span><span class="p">)</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xlin</span><span class="p">,</span> <span class="n">bl</span><span class="p">[</span><span class="s1">&#39;w_I&#39;</span><span class="p">][</span><span class="s1">&#39;d0&#39;</span><span class="p">](</span><span class="n">xlin</span><span class="p">,</span><span class="n">Pre_fit_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">step</span><span class="p">,</span><span class="s1">&#39;Fit_params_dict&#39;</span><span class="p">]),</span>
                 <span class="s1">&#39;g:&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Ind.&#39;</span><span class="p">)</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xlin</span><span class="p">,</span> <span class="n">bl</span><span class="p">[</span><span class="s1">&#39;w_S&#39;</span><span class="p">][</span><span class="s1">&#39;d0&#39;</span><span class="p">](</span><span class="n">xlin</span><span class="p">,</span><span class="n">Pre_fit_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">step</span><span class="p">,</span><span class="s1">&#39;Fit_params_dict&#39;</span><span class="p">]),</span>
                 <span class="s1">&#39;b:&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Wo. ind.&#39;</span><span class="p">)</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xlin</span><span class="p">,</span> <span class="n">bl</span><span class="p">[</span><span class="s1">&#39;w_V&#39;</span><span class="p">][</span><span class="s1">&#39;d0&#39;</span><span class="p">](</span><span class="n">xlin</span><span class="p">,</span><span class="n">Pre_fit_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">step</span><span class="p">,</span><span class="s1">&#39;Fit_params_dict&#39;</span><span class="p">]),</span>
                 <span class="s1">&#39;m--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;V&#39;</span><span class="p">)</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xlin</span><span class="p">,</span> <span class="n">bl</span><span class="p">[</span><span class="s1">&#39;w_M_ima&#39;</span><span class="p">][</span><span class="s1">&#39;d0&#39;</span><span class="p">](</span><span class="n">xlin</span><span class="p">,</span><span class="n">Pre_fit_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">step</span><span class="p">,</span><span class="s1">&#39;Fit_params_dict&#39;</span><span class="p">]),</span>
                 <span class="s1">&#39;g--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Imag. M&#39;</span><span class="p">)</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xlin</span><span class="p">,</span> <span class="n">bl</span><span class="p">[</span><span class="s1">&#39;w_M&#39;</span><span class="p">][</span><span class="s1">&#39;d0&#39;</span><span class="p">](</span><span class="n">xlin</span><span class="p">,</span><span class="n">Bend_fit_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">step</span><span class="p">,</span><span class="s1">&#39;Fit_params_dict&#39;</span><span class="p">]),</span>
                 <span class="s1">&#39;r--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;M&#39;</span><span class="p">)</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">P_xcoord_ydisp_meas</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">step</span><span class="p">]</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;x&#39;</span><span class="p">],</span>
                 <span class="n">P_xcoord_ydisp_meas</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">step</span><span class="p">]</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;y&#39;</span><span class="p">],</span> 
                 <span class="s1">&#39;ko&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;org. P&#39;</span><span class="p">)</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">P_xcoord_ydisp_meas_M</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">step</span><span class="p">]</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;x&#39;</span><span class="p">],</span>
                 <span class="n">P_xcoord_ydisp_meas_M</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">step</span><span class="p">]</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;y&#39;</span><span class="p">],</span> 
                 <span class="s1">&#39;go&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;M P&#39;</span><span class="p">)</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
        <span class="n">plt_hsuf</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span><span class="n">path</span><span class="o">=</span><span class="n">out_full</span><span class="o">+</span><span class="s2">&quot;-DIC_fit-bl_U-d0&quot;</span><span class="p">,</span><span class="o">**</span><span class="n">plt_scopt</span><span class="p">)</span>
        
        <span class="n">fig</span><span class="p">,</span> <span class="n">ax1</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1"> - Fit-compare - Slope for step </span><span class="si">%i</span><span class="s1">&#39;</span><span class="o">%</span><span class="p">(</span><span class="n">plt_name</span><span class="p">,</span><span class="n">step</span><span class="p">))</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x / mm&#39;</span><span class="p">)</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;slope / (mm/mm)&#39;</span><span class="p">)</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xlin</span><span class="p">,</span> <span class="n">bl</span><span class="p">[</span><span class="s1">&#39;w_A&#39;</span><span class="p">][</span><span class="s1">&#39;d1&#39;</span><span class="p">](</span><span class="n">xlin</span><span class="p">,</span><span class="n">Pre_fit_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">step</span><span class="p">,</span><span class="s1">&#39;Fit_params_dict&#39;</span><span class="p">]),</span>
                 <span class="s1">&#39;r:&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Org.&#39;</span><span class="p">)</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xlin</span><span class="p">,</span> <span class="n">bl</span><span class="p">[</span><span class="s1">&#39;w_S&#39;</span><span class="p">][</span><span class="s1">&#39;d1&#39;</span><span class="p">](</span><span class="n">xlin</span><span class="p">,</span><span class="n">Pre_fit_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">step</span><span class="p">,</span><span class="s1">&#39;Fit_params_dict&#39;</span><span class="p">]),</span>
                 <span class="s1">&#39;b:&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Wo. ind.&#39;</span><span class="p">)</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xlin</span><span class="p">,</span> <span class="n">bl</span><span class="p">[</span><span class="s1">&#39;w_V&#39;</span><span class="p">][</span><span class="s1">&#39;d1&#39;</span><span class="p">](</span><span class="n">xlin</span><span class="p">,</span><span class="n">Pre_fit_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">step</span><span class="p">,</span><span class="s1">&#39;Fit_params_dict&#39;</span><span class="p">]),</span>
                 <span class="s1">&#39;m--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;V&#39;</span><span class="p">)</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xlin</span><span class="p">,</span> <span class="n">bl</span><span class="p">[</span><span class="s1">&#39;w_M&#39;</span><span class="p">][</span><span class="s1">&#39;d1&#39;</span><span class="p">](</span><span class="n">xlin</span><span class="p">,</span><span class="n">Bend_fit_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">step</span><span class="p">,</span><span class="s1">&#39;Fit_params_dict&#39;</span><span class="p">]),</span>
                 <span class="s1">&#39;r--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;M&#39;</span><span class="p">)</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
        <span class="n">plt_hsuf</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span><span class="n">path</span><span class="o">=</span><span class="n">out_full</span><span class="o">+</span><span class="s2">&quot;-DIC_fit-bl_U-d1&quot;</span><span class="p">,</span><span class="o">**</span><span class="n">plt_scopt</span><span class="p">)</span>
        
        <span class="n">fig</span><span class="p">,</span> <span class="n">ax1</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1"> - Fit-compare - Curvature for step </span><span class="si">%i</span><span class="s1">&#39;</span><span class="o">%</span><span class="p">(</span><span class="n">plt_name</span><span class="p">,</span><span class="n">step</span><span class="p">))</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x / mm&#39;</span><span class="p">)</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;curvature / (1/mm)&#39;</span><span class="p">)</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xlin</span><span class="p">,</span> <span class="n">bl</span><span class="p">[</span><span class="s1">&#39;w_A&#39;</span><span class="p">][</span><span class="s1">&#39;d2&#39;</span><span class="p">](</span><span class="n">xlin</span><span class="p">,</span><span class="n">Pre_fit_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">step</span><span class="p">,</span><span class="s1">&#39;Fit_params_dict&#39;</span><span class="p">]),</span>
                 <span class="s1">&#39;r:&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Org.&#39;</span><span class="p">)</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xlin</span><span class="p">,</span> <span class="n">bl</span><span class="p">[</span><span class="s1">&#39;w_S&#39;</span><span class="p">][</span><span class="s1">&#39;d2&#39;</span><span class="p">](</span><span class="n">xlin</span><span class="p">,</span><span class="n">Pre_fit_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">step</span><span class="p">,</span><span class="s1">&#39;Fit_params_dict&#39;</span><span class="p">]),</span>
                 <span class="s1">&#39;b:&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Wo. ind.&#39;</span><span class="p">)</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xlin</span><span class="p">,</span> <span class="n">bl</span><span class="p">[</span><span class="s1">&#39;w_M&#39;</span><span class="p">][</span><span class="s1">&#39;d2&#39;</span><span class="p">](</span><span class="n">xlin</span><span class="p">,</span><span class="n">Bend_fit_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">step</span><span class="p">,</span><span class="s1">&#39;Fit_params_dict&#39;</span><span class="p">]),</span>
                 <span class="s1">&#39;r--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;M&#39;</span><span class="p">)</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
        <span class="n">plt_hsuf</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span><span class="n">path</span><span class="o">=</span><span class="n">out_full</span><span class="o">+</span><span class="s2">&quot;-DIC_fit-bl_U-d2&quot;</span><span class="p">,</span><span class="o">**</span><span class="n">plt_scopt</span><span class="p">)</span>
        
        <span class="n">fig</span><span class="p">,</span> <span class="n">ax1</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1"> - Fit-compare-inc - Displacement for step </span><span class="si">%i</span><span class="s1">&#39;</span><span class="o">%</span><span class="p">(</span><span class="n">plt_name</span><span class="p">,</span><span class="n">step</span><span class="p">))</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x / mm&#39;</span><span class="p">)</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;y displacement / mm&#39;</span><span class="p">)</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xlin</span><span class="p">,</span> <span class="n">bl</span><span class="p">[</span><span class="s1">&#39;w_A&#39;</span><span class="p">][</span><span class="s1">&#39;d0&#39;</span><span class="p">](</span><span class="n">xlin</span><span class="p">,</span><span class="n">Pre_inc_fit_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">step</span><span class="p">,</span><span class="s1">&#39;Fit_params_dict&#39;</span><span class="p">]),</span> 
                 <span class="s1">&#39;r:&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Org.&#39;</span><span class="p">)</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xlin</span><span class="p">,</span> <span class="n">bl</span><span class="p">[</span><span class="s1">&#39;w_I&#39;</span><span class="p">][</span><span class="s1">&#39;d0&#39;</span><span class="p">](</span><span class="n">xlin</span><span class="p">,</span><span class="n">Pre_inc_fit_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">step</span><span class="p">,</span><span class="s1">&#39;Fit_params_dict&#39;</span><span class="p">]),</span>
                 <span class="s1">&#39;g:&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Ind.&#39;</span><span class="p">)</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xlin</span><span class="p">,</span> <span class="n">bl</span><span class="p">[</span><span class="s1">&#39;w_S&#39;</span><span class="p">][</span><span class="s1">&#39;d0&#39;</span><span class="p">](</span><span class="n">xlin</span><span class="p">,</span><span class="n">Pre_inc_fit_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">step</span><span class="p">,</span><span class="s1">&#39;Fit_params_dict&#39;</span><span class="p">]),</span>
                 <span class="s1">&#39;b:&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Wo. ind.&#39;</span><span class="p">)</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xlin</span><span class="p">,</span> <span class="n">bl</span><span class="p">[</span><span class="s1">&#39;w_V&#39;</span><span class="p">][</span><span class="s1">&#39;d0&#39;</span><span class="p">](</span><span class="n">xlin</span><span class="p">,</span><span class="n">Pre_inc_fit_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">step</span><span class="p">,</span><span class="s1">&#39;Fit_params_dict&#39;</span><span class="p">]),</span>
                 <span class="s1">&#39;m--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;V&#39;</span><span class="p">)</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xlin</span><span class="p">,</span> <span class="n">bl</span><span class="p">[</span><span class="s1">&#39;w_M_ima&#39;</span><span class="p">][</span><span class="s1">&#39;d0&#39;</span><span class="p">](</span><span class="n">xlin</span><span class="p">,</span><span class="n">Pre_inc_fit_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">step</span><span class="p">,</span><span class="s1">&#39;Fit_params_dict&#39;</span><span class="p">]),</span>
                 <span class="s1">&#39;g--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Imag. M&#39;</span><span class="p">)</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xlin</span><span class="p">,</span> <span class="n">bl</span><span class="p">[</span><span class="s1">&#39;w_M&#39;</span><span class="p">][</span><span class="s1">&#39;d0&#39;</span><span class="p">](</span><span class="n">xlin</span><span class="p">,</span><span class="n">Bend_inc_fit_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">step</span><span class="p">,</span><span class="s1">&#39;Fit_params_dict&#39;</span><span class="p">]),</span>
                 <span class="s1">&#39;r--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;M&#39;</span><span class="p">)</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">P_xcoord_ydiff_meas</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">step</span><span class="p">]</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;x&#39;</span><span class="p">],</span>
                 <span class="n">P_xcoord_ydiff_meas</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">step</span><span class="p">]</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;y&#39;</span><span class="p">],</span> 
                 <span class="s1">&#39;ko&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;org. P&#39;</span><span class="p">)</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">P_xcoord_ydiff_meas_M</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">step</span><span class="p">]</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;x&#39;</span><span class="p">],</span>
                 <span class="n">P_xcoord_ydiff_meas_M</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">step</span><span class="p">]</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;y&#39;</span><span class="p">],</span> 
                 <span class="s1">&#39;go&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;M P&#39;</span><span class="p">)</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
        <span class="n">plt_hsuf</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span><span class="n">path</span><span class="o">=</span><span class="n">out_full</span><span class="o">+</span><span class="s2">&quot;-INC_fit-bl_U-d0&quot;</span><span class="p">,</span><span class="o">**</span><span class="n">plt_scopt</span><span class="p">)</span>
        
        <span class="c1"># Pre-Fit -----------------------------------------------------------------</span>
        <span class="n">emeb</span><span class="o">.</span><span class="n">plotting</span><span class="o">.</span><span class="n">colplt_funcs_all</span><span class="p">(</span>
            <span class="n">x</span><span class="o">=</span><span class="n">xlin</span><span class="p">,</span> <span class="n">func_cohort</span><span class="o">=</span><span class="n">bl</span><span class="p">[</span><span class="s1">&#39;w_A&#39;</span><span class="p">],</span>
            <span class="n">params</span><span class="o">=</span><span class="n">Pre_fit_df</span><span class="o">.</span><span class="n">loc</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)[</span><span class="s1">&#39;Fit_params_dict&#39;</span><span class="p">],</span>
            <span class="n">step_range</span><span class="o">=</span><span class="n">step_range_dic</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span> 
            <span class="n">title</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1"> - Fit-full&#39;</span><span class="o">%</span><span class="n">plt_name</span><span class="p">),</span>
            <span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;x  / mm&#39;</span><span class="p">,</span>
            <span class="n">Point_df</span><span class="o">=</span><span class="n">P_xcoord_ydisp_meas</span><span class="p">,</span>
            <span class="n">path</span><span class="o">=</span><span class="n">out_full</span><span class="o">+</span><span class="s1">&#39;-DIC_fit-A&#39;</span><span class="p">,</span>
            <span class="n">plt_scopt</span><span class="o">=</span><span class="n">plt_scopt</span>
            <span class="p">)</span>
        <span class="c1"># Bending-Fit -------------------------------------------------------------</span>
        <span class="n">emeb</span><span class="o">.</span><span class="n">plotting</span><span class="o">.</span><span class="n">colplt_funcs_all</span><span class="p">(</span>
            <span class="n">x</span><span class="o">=</span><span class="n">xlin</span><span class="p">,</span> <span class="n">func_cohort</span><span class="o">=</span><span class="n">bl</span><span class="p">[</span><span class="s1">&#39;w_M&#39;</span><span class="p">],</span>
            <span class="n">params</span><span class="o">=</span><span class="n">Bend_fit_df</span><span class="o">.</span><span class="n">loc</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)[</span><span class="s1">&#39;Fit_params_dict&#39;</span><span class="p">],</span>
            <span class="n">step_range</span><span class="o">=</span><span class="n">step_range_dic</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span> 
            <span class="n">title</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1"> - Fit-Bending&#39;</span><span class="o">%</span><span class="n">plt_name</span><span class="p">),</span>
            <span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;x / mm&#39;</span><span class="p">,</span>
            <span class="n">Point_df</span><span class="o">=</span><span class="n">P_xcoord_ydisp_meas_M</span><span class="p">,</span>
            <span class="n">path</span><span class="o">=</span><span class="n">out_full</span><span class="o">+</span><span class="s1">&#39;-DIC_fit-M&#39;</span><span class="p">,</span>
            <span class="n">plt_scopt</span><span class="o">=</span><span class="n">plt_scopt</span>
            <span class="p">)</span>
        <span class="c1"># Pre-Fit -----------------------------------------------------------------</span>
        <span class="n">emeb</span><span class="o">.</span><span class="n">plotting</span><span class="o">.</span><span class="n">colplt_funcs_all</span><span class="p">(</span>
            <span class="n">x</span><span class="o">=</span><span class="n">xlin</span><span class="p">,</span> <span class="n">func_cohort</span><span class="o">=</span><span class="n">bl</span><span class="p">[</span><span class="s1">&#39;w_A&#39;</span><span class="p">],</span>
            <span class="n">params</span><span class="o">=</span><span class="n">Pre_inc_fit_df</span><span class="o">.</span><span class="n">loc</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)[</span><span class="s1">&#39;Fit_params_dict&#39;</span><span class="p">],</span>
            <span class="n">step_range</span><span class="o">=</span><span class="n">step_range_dic_inc</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span> 
            <span class="n">title</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1"> - Incremental Fit-full&#39;</span><span class="o">%</span><span class="n">plt_name</span><span class="p">),</span>
            <span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;x / mm&#39;</span><span class="p">,</span>
            <span class="n">Point_df</span><span class="o">=</span><span class="n">P_xcoord_ydiff_meas</span><span class="p">,</span>
            <span class="n">path</span><span class="o">=</span><span class="n">out_full</span><span class="o">+</span><span class="s1">&#39;-INC_fit-A&#39;</span><span class="p">,</span>
            <span class="n">plt_scopt</span><span class="o">=</span><span class="n">plt_scopt</span>
            <span class="p">)</span>
        <span class="c1"># Bending-Fit -------------------------------------------------------------</span>
        <span class="n">emeb</span><span class="o">.</span><span class="n">plotting</span><span class="o">.</span><span class="n">colplt_funcs_all</span><span class="p">(</span>
            <span class="n">x</span><span class="o">=</span><span class="n">xlin</span><span class="p">,</span> <span class="n">func_cohort</span><span class="o">=</span><span class="n">bl</span><span class="p">[</span><span class="s1">&#39;w_M&#39;</span><span class="p">],</span>
            <span class="n">params</span><span class="o">=</span><span class="n">Bend_inc_fit_df</span><span class="o">.</span><span class="n">loc</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)[</span><span class="s1">&#39;Fit_params_dict&#39;</span><span class="p">],</span>
            <span class="n">step_range</span><span class="o">=</span><span class="n">step_range_dic_inc</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span> 
            <span class="n">title</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1"> - Incremental Fit-Bending&#39;</span><span class="o">%</span><span class="n">plt_name</span><span class="p">),</span>
            <span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;x / mm&#39;</span><span class="p">,</span>
            <span class="n">Point_df</span><span class="o">=</span><span class="n">P_xcoord_ydiff_meas_M</span><span class="p">,</span>
            <span class="n">path</span><span class="o">=</span><span class="n">out_full</span><span class="o">+</span><span class="s1">&#39;-INC_fit-M&#39;</span><span class="p">,</span> 
            <span class="n">plt_scopt</span><span class="o">=</span><span class="n">plt_scopt</span>
            <span class="p">)</span>
    
    <span class="c1">#%%% 6.2 Determine evaluation curves</span>
    <span class="n">log_custom</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2"> &quot;</span><span class="o">+</span><span class="s2">&quot;-&quot;</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span><span class="o">**</span><span class="n">log_scopt</span><span class="p">)</span>
    <span class="n">log_custom</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2"> ### -6.2 Determine evaluation curves ###&quot;</span><span class="p">,</span><span class="o">**</span><span class="n">log_scopt</span><span class="p">)</span>
    <span class="n">timings</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mf">6.2</span><span class="p">]</span><span class="o">=</span><span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span>
    <span class="n">log_custom</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">   Timing </span><span class="si">%f</span><span class="s2">: </span><span class="si">%.5f</span><span class="s2"> s&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">timings</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span>
                                       <span class="n">timings</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">timings</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span>
                   <span class="o">**</span><span class="n">log_scopt</span><span class="p">)</span>
    
    <span class="n">messu</span><span class="p">[</span><span class="s1">&#39;Moment&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">emeb</span><span class="o">.</span><span class="n">evaluation</span><span class="o">.</span><span class="n">Moment_perF_func</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span><span class="n">Bo_Le</span><span class="p">,</span><span class="n">Bo_Ri</span><span class="p">)</span><span class="o">*</span><span class="n">messu</span><span class="o">.</span><span class="n">Force</span>
    <span class="n">messu</span><span class="p">[</span><span class="s1">&#39;Stress&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">emeb</span><span class="o">.</span><span class="n">evaluation</span><span class="o">.</span><span class="n">stress_perF</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span><span class="n">func_I</span><span class="p">,</span><span class="n">func_t</span><span class="p">,</span><span class="n">Bo_Le</span><span class="p">,</span><span class="n">Bo_Ri</span><span class="p">)</span><span class="o">*</span><span class="n">messu</span><span class="o">.</span><span class="n">Force</span>
    
    <span class="n">messu</span><span class="p">[</span><span class="s1">&#39;Strain&#39;</span><span class="p">]</span><span class="o">=</span><span class="mi">6</span><span class="o">*</span><span class="n">prot_ser</span><span class="p">[</span><span class="s1">&#39;thickness_2&#39;</span><span class="p">]</span><span class="o">*</span><span class="n">messu</span><span class="o">.</span><span class="n">Way</span><span class="o">/</span><span class="n">Length</span><span class="o">**</span><span class="mi">2</span>

    <span class="k">if</span> <span class="n">_opts</span><span class="p">[</span><span class="s1">&#39;OPT_DIC&#39;</span><span class="p">]:</span>
        <span class="n">messu</span><span class="p">[</span><span class="s1">&#39;Disp_opt_A&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">bl</span><span class="p">[</span><span class="s1">&#39;w_A&#39;</span><span class="p">][</span><span class="s1">&#39;d0&#39;</span><span class="p">](</span><span class="mf">0.0</span><span class="p">,</span><span class="n">Pre_fit_df</span><span class="p">[</span><span class="s1">&#39;Fit_params_dict&#39;</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">_opts</span><span class="p">[</span><span class="s1">&#39;OPT_Compression&#39;</span><span class="p">]:</span> <span class="n">messu</span><span class="p">[</span><span class="s1">&#39;Disp_opt_A&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">messu</span><span class="p">[</span><span class="s1">&#39;Disp_opt_A&#39;</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">messu</span><span class="p">[</span><span class="s1">&#39;Strain_opt_d_A&#39;</span><span class="p">]</span><span class="o">=</span><span class="mi">6</span><span class="o">*</span><span class="n">prot_ser</span><span class="p">[</span><span class="s1">&#39;thickness_2&#39;</span><span class="p">]</span><span class="o">*</span><span class="n">messu</span><span class="p">[</span><span class="s1">&#39;Disp_opt_A&#39;</span><span class="p">]</span><span class="o">/</span><span class="n">Length</span><span class="o">**</span><span class="mi">2</span>
        <span class="n">messu</span><span class="p">[</span><span class="s1">&#39;Disp_opt_S&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">bl</span><span class="p">[</span><span class="s1">&#39;w_S&#39;</span><span class="p">][</span><span class="s1">&#39;d0&#39;</span><span class="p">](</span><span class="mf">0.0</span><span class="p">,</span><span class="n">Pre_fit_df</span><span class="p">[</span><span class="s1">&#39;Fit_params_dict&#39;</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">_opts</span><span class="p">[</span><span class="s1">&#39;OPT_Compression&#39;</span><span class="p">]:</span> <span class="n">messu</span><span class="p">[</span><span class="s1">&#39;Disp_opt_S&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">messu</span><span class="p">[</span><span class="s1">&#39;Disp_opt_S&#39;</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">messu</span><span class="p">[</span><span class="s1">&#39;Strain_opt_d_S&#39;</span><span class="p">]</span><span class="o">=</span><span class="mi">6</span><span class="o">*</span><span class="n">prot_ser</span><span class="p">[</span><span class="s1">&#39;thickness_2&#39;</span><span class="p">]</span><span class="o">*</span><span class="n">messu</span><span class="p">[</span><span class="s1">&#39;Disp_opt_S&#39;</span><span class="p">]</span><span class="o">/</span><span class="n">Length</span><span class="o">**</span><span class="mi">2</span>
        <span class="n">messu</span><span class="p">[</span><span class="s1">&#39;Disp_opt_M&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">bl</span><span class="p">[</span><span class="s1">&#39;w_M&#39;</span><span class="p">][</span><span class="s1">&#39;d0&#39;</span><span class="p">](</span><span class="mf">0.0</span><span class="p">,</span><span class="n">Bend_fit_df</span><span class="p">[</span><span class="s1">&#39;Fit_params_dict&#39;</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">_opts</span><span class="p">[</span><span class="s1">&#39;OPT_Compression&#39;</span><span class="p">]:</span> <span class="n">messu</span><span class="p">[</span><span class="s1">&#39;Disp_opt_M&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">messu</span><span class="p">[</span><span class="s1">&#39;Disp_opt_M&#39;</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">messu</span><span class="p">[</span><span class="s1">&#39;Strain_opt_d_M&#39;</span><span class="p">]</span><span class="o">=</span><span class="mi">6</span><span class="o">*</span><span class="n">prot_ser</span><span class="p">[</span><span class="s1">&#39;thickness_2&#39;</span><span class="p">]</span><span class="o">*</span><span class="n">messu</span><span class="p">[</span><span class="s1">&#39;Disp_opt_M&#39;</span><span class="p">]</span><span class="o">/</span><span class="n">Length</span><span class="o">**</span><span class="mi">2</span>
    
        <span class="n">messu</span><span class="p">[</span><span class="s1">&#39;Strain_opt_c_A&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">emeb</span><span class="o">.</span><span class="n">evaluation</span><span class="o">.</span><span class="n">straindf_from_curve</span><span class="p">(</span>
            <span class="mf">0.0</span><span class="p">,</span> <span class="n">bl</span><span class="p">[</span><span class="s1">&#39;w_A&#39;</span><span class="p">][</span><span class="s1">&#39;d2&#39;</span><span class="p">],</span> <span class="n">Pre_fit_df</span><span class="p">[</span><span class="s1">&#39;Fit_params_dict&#39;</span><span class="p">],</span> <span class="n">func_t</span>
            <span class="p">)</span>
        <span class="n">messu</span><span class="p">[</span><span class="s1">&#39;Strain_opt_c_S&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">emeb</span><span class="o">.</span><span class="n">evaluation</span><span class="o">.</span><span class="n">straindf_from_curve</span><span class="p">(</span>
            <span class="mf">0.0</span><span class="p">,</span> <span class="n">bl</span><span class="p">[</span><span class="s1">&#39;w_S&#39;</span><span class="p">][</span><span class="s1">&#39;d2&#39;</span><span class="p">],</span> <span class="n">Pre_fit_df</span><span class="p">[</span><span class="s1">&#39;Fit_params_dict&#39;</span><span class="p">],</span> <span class="n">func_t</span>
            <span class="p">)</span>
        <span class="n">messu</span><span class="p">[</span><span class="s1">&#39;Strain_opt_c_M&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">emeb</span><span class="o">.</span><span class="n">evaluation</span><span class="o">.</span><span class="n">straindf_from_curve</span><span class="p">(</span>
            <span class="mf">0.0</span><span class="p">,</span> <span class="n">bl</span><span class="p">[</span><span class="s1">&#39;w_M&#39;</span><span class="p">][</span><span class="s1">&#39;d2&#39;</span><span class="p">],</span> <span class="n">Bend_fit_df</span><span class="p">[</span><span class="s1">&#39;Fit_params_dict&#39;</span><span class="p">],</span> <span class="n">func_t</span>
            <span class="p">)</span>
        <span class="c1"># Set first value of optical displacement and strain to 0.0 instead of NaN</span>
        <span class="n">messu</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">messu_iS</span><span class="p">,[</span>    <span class="s1">&#39;Disp_opt_A&#39;</span><span class="p">,</span>    <span class="s1">&#39;Disp_opt_S&#39;</span><span class="p">,</span>    <span class="s1">&#39;Disp_opt_M&#39;</span><span class="p">,]]</span><span class="o">=</span><span class="mf">0.0</span>
        <span class="n">messu</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">messu_iS</span><span class="p">,[</span><span class="s1">&#39;Strain_opt_d_A&#39;</span><span class="p">,</span><span class="s1">&#39;Strain_opt_d_S&#39;</span><span class="p">,</span><span class="s1">&#39;Strain_opt_d_M&#39;</span><span class="p">,]]</span><span class="o">=</span><span class="mf">0.0</span>
        <span class="n">messu</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">messu_iS</span><span class="p">,[</span><span class="s1">&#39;Strain_opt_c_A&#39;</span><span class="p">,</span><span class="s1">&#39;Strain_opt_c_S&#39;</span><span class="p">,</span><span class="s1">&#39;Strain_opt_c_M&#39;</span><span class="p">,]]</span><span class="o">=</span><span class="mf">0.0</span>

    <span class="c1">#Test Anstieg</span>
        <span class="n">tmon</span><span class="o">=</span><span class="n">emec</span><span class="o">.</span><span class="n">mc_char</span><span class="o">.</span><span class="n">test_pdmon</span><span class="p">(</span>
            <span class="n">messu</span><span class="p">,</span>
            <span class="p">[</span><span class="s1">&#39;Stress&#39;</span><span class="p">,</span><span class="s1">&#39;Strain&#39;</span><span class="p">,</span>
             <span class="s1">&#39;Strain_opt_d_A&#39;</span><span class="p">,</span><span class="s1">&#39;Strain_opt_d_S&#39;</span><span class="p">,</span><span class="s1">&#39;Strain_opt_d_M&#39;</span><span class="p">,</span>
             <span class="s1">&#39;Strain_opt_c_A&#39;</span><span class="p">,</span><span class="s1">&#39;Strain_opt_c_S&#39;</span><span class="p">,</span><span class="s1">&#39;Strain_opt_c_M&#39;</span><span class="p">],</span>
            <span class="mi">1</span><span class="p">,</span><span class="mi">10</span>
            <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">tmon</span><span class="o">=</span><span class="n">emec</span><span class="o">.</span><span class="n">mc_char</span><span class="o">.</span><span class="n">test_pdmon</span><span class="p">(</span><span class="n">messu</span><span class="p">,[</span><span class="s1">&#39;Stress&#39;</span><span class="p">,</span><span class="s1">&#39;Strain&#39;</span><span class="p">],</span><span class="mi">1</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span>
    
    <span class="n">log_custom</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">   Last 10 monoton increasing periods:</span><span class="se">\n</span><span class="s2">    </span><span class="si">%s</span><span class="s2">&quot;</span>
               <span class="o">%</span><span class="n">tmon</span><span class="o">.</span><span class="n">to_frame</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;Epoche&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">to_string</span><span class="p">()</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">    &#39;</span><span class="p">),</span>
               <span class="o">**</span><span class="n">log_scoptf</span><span class="p">)</span>
    
    <span class="c1"># =============================================================================</span>
    <span class="c1">#%%% 6.3 Determine points of interest</span>
    <span class="n">log_custom</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2"> &quot;</span><span class="o">+</span><span class="s2">&quot;-&quot;</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span><span class="o">**</span><span class="n">log_scopt</span><span class="p">)</span>
    <span class="n">log_custom</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2"> ### -6.3 Determine points of interest ###&quot;</span><span class="p">,</span><span class="o">**</span><span class="n">log_scopt</span><span class="p">)</span>
    <span class="n">timings</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mf">6.31</span><span class="p">]</span><span class="o">=</span><span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span>
    <span class="n">log_custom</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">   Timing </span><span class="si">%f</span><span class="s2">: </span><span class="si">%.5f</span><span class="s2"> s&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">timings</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span>
                                       <span class="n">timings</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">timings</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span>
                   <span class="o">**</span><span class="n">log_scopt</span><span class="p">)</span>
    <span class="n">VIP_messu</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([],</span><span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;int64&#39;</span><span class="p">,</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;VIP_messu&#39;</span><span class="p">)</span>
    <span class="n">VIP_messu</span><span class="p">[</span><span class="s1">&#39;S&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">messu</span><span class="o">.</span><span class="n">driF</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">VIP_messu</span><span class="p">[</span><span class="s1">&#39;E&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">messu</span><span class="o">.</span><span class="n">driF</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">VIP_messu</span><span class="p">[</span><span class="s1">&#39;U&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">messu</span><span class="o">.</span><span class="n">Force</span><span class="o">.</span><span class="n">idxmax</span><span class="p">()</span>
    
    <span class="n">mun_tmp</span> <span class="o">=</span> <span class="n">messu</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">VIP_messu</span><span class="p">[</span><span class="s1">&#39;S&#39;</span><span class="p">]</span><span class="o">+</span><span class="n">_opts</span><span class="p">[</span><span class="s1">&#39;OPT_Determination_Distance&#39;</span><span class="p">]:</span><span class="n">VIP_messu</span><span class="p">[</span><span class="s1">&#39;U&#39;</span><span class="p">]</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">mun_tmp</span><span class="o">.</span><span class="n">driF_schg</span><span class="o">.</span><span class="n">any</span><span class="p">()</span><span class="o">==</span><span class="kc">True</span><span class="p">:</span> <span class="c1"># </span>
        <span class="n">VIP_messu</span><span class="p">[</span><span class="s1">&#39;Y&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">mun_tmp</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">mun_tmp</span><span class="o">.</span><span class="n">driF_schg</span><span class="o">==</span><span class="kc">True</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="mi">1</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">VIP_messu</span><span class="p">[</span><span class="s1">&#39;Y&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">VIP_messu</span><span class="p">[</span><span class="s1">&#39;U&#39;</span><span class="p">]</span>
        <span class="n">log_custom</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">    Fy set on datapoint of Fu!&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">log_scoptf</span><span class="p">)</span>
        
    <span class="c1"># mun_tmp = messu.loc[VIP_messu[&#39;U&#39;]:VIP_messu[&#39;E&#39;]-1]</span>
    <span class="n">mun_tmp</span> <span class="o">=</span> <span class="n">messu</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">VIP_messu</span><span class="p">[</span><span class="s1">&#39;U&#39;</span><span class="p">]</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span><span class="n">VIP_messu</span><span class="p">[</span><span class="s1">&#39;E&#39;</span><span class="p">]</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">mun_tmp</span><span class="o">.</span><span class="n">driF_schg</span><span class="o">.</span><span class="n">any</span><span class="p">():</span>
        <span class="n">i</span><span class="o">=</span><span class="n">mun_tmp</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">mun_tmp</span><span class="o">.</span><span class="n">driF_schg</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="c1"># statt allgemeinem Minimum bei größtem Kraftabfall nahe Maximalkraft,</span>
        <span class="c1">#  -2 da differenz aussage über vorherigen punkt</span>
        <span class="n">VIP_messu</span><span class="p">[</span><span class="s1">&#39;B&#39;</span><span class="p">]</span>  <span class="o">=</span><span class="n">mun_tmp</span><span class="o">.</span><span class="n">driF</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="n">_opts</span><span class="p">[</span><span class="s1">&#39;OPT_Determination_Distance&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">idxmin</span><span class="p">()</span><span class="o">-</span><span class="mi">2</span> 
        <span class="k">if</span> <span class="n">VIP_messu</span><span class="p">[</span><span class="s1">&#39;B&#39;</span><span class="p">]</span><span class="o">&lt;</span><span class="n">VIP_messu</span><span class="p">[</span><span class="s1">&#39;U&#39;</span><span class="p">]:</span> <span class="n">VIP_messu</span><span class="p">[</span><span class="s1">&#39;B&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">VIP_messu</span><span class="p">[</span><span class="s1">&#39;U&#39;</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">log_custom</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">   Fb not reliably determinable!&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">log_scoptf</span><span class="p">)</span>
            
    <span class="n">ftmp</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="n">messu</span><span class="o">.</span><span class="n">Force</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">VIP_messu</span><span class="p">[</span><span class="n">_opts</span><span class="p">[</span><span class="s1">&#39;OPT_YM_Determination_range&#39;</span><span class="p">][</span><span class="mi">2</span><span class="p">]]]</span><span class="o">*</span><span class="n">_opts</span><span class="p">[</span><span class="s1">&#39;OPT_YM_Determination_range&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">VIP_messu</span><span class="p">[</span><span class="s1">&#39;F1&#39;</span><span class="p">]</span><span class="o">=</span><span class="nb">abs</span><span class="p">(</span><span class="n">messu</span><span class="o">.</span><span class="n">Force</span><span class="o">.</span><span class="n">loc</span><span class="p">[:</span><span class="n">VIP_messu</span><span class="p">[</span><span class="n">_opts</span><span class="p">[</span><span class="s1">&#39;OPT_YM_Determination_range&#39;</span><span class="p">][</span><span class="mi">2</span><span class="p">]]]</span><span class="o">-</span><span class="n">ftmp</span><span class="p">)</span><span class="o">.</span><span class="n">idxmin</span><span class="p">()</span>
    <span class="n">ftmp</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="n">messu</span><span class="o">.</span><span class="n">Force</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">VIP_messu</span><span class="p">[</span><span class="n">_opts</span><span class="p">[</span><span class="s1">&#39;OPT_YM_Determination_range&#39;</span><span class="p">][</span><span class="mi">2</span><span class="p">]]]</span><span class="o">*</span><span class="n">_opts</span><span class="p">[</span><span class="s1">&#39;OPT_YM_Determination_range&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">VIP_messu</span><span class="p">[</span><span class="s1">&#39;F2&#39;</span><span class="p">]</span><span class="o">=</span><span class="nb">abs</span><span class="p">(</span><span class="n">messu</span><span class="o">.</span><span class="n">Force</span><span class="o">.</span><span class="n">loc</span><span class="p">[:</span><span class="n">VIP_messu</span><span class="p">[</span><span class="n">_opts</span><span class="p">[</span><span class="s1">&#39;OPT_YM_Determination_range&#39;</span><span class="p">][</span><span class="mi">2</span><span class="p">]]]</span><span class="o">-</span><span class="n">ftmp</span><span class="p">)</span><span class="o">.</span><span class="n">idxmin</span><span class="p">()</span>
    
     <span class="c1"># Test ob Streckgrenze zwischen F1 und F2 liegt</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">VIP_messu</span><span class="p">[</span><span class="s1">&#39;Y&#39;</span><span class="p">]</span><span class="o">&gt;</span><span class="n">VIP_messu</span><span class="p">[</span><span class="s1">&#39;F1&#39;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="n">VIP_messu</span><span class="p">[</span><span class="s1">&#39;Y&#39;</span><span class="p">]</span><span class="o">&lt;</span><span class="n">VIP_messu</span><span class="p">[</span><span class="s1">&#39;F2&#39;</span><span class="p">]):</span>
        <span class="n">VIP_messu</span><span class="p">[</span><span class="s1">&#39;F2&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">VIP_messu</span><span class="p">[</span><span class="s1">&#39;Y&#39;</span><span class="p">]</span>
        <span class="n">log_custom</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">   F2 set on Y (Force-rise between F1 and old F2)&quot;</span><span class="p">,</span>
                   <span class="o">**</span><span class="n">log_scoptf</span><span class="p">)</span>
    
    <span class="n">VIP_messu</span><span class="o">=</span><span class="n">VIP_messu</span><span class="o">.</span><span class="n">sort_values</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">_opts</span><span class="p">[</span><span class="s1">&#39;OPT_DIC&#39;</span><span class="p">]:</span>
        <span class="n">VIP_dicu</span><span class="o">=</span><span class="n">VIP_messu</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">deep</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">VIP_dicu</span><span class="o">.</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;VIP_dicu&#39;</span>
    
    <span class="c1">#%%%% 6.3.2 Improvement of evaluation range</span>
    <span class="n">timings</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mf">6.32</span><span class="p">]</span><span class="o">=</span><span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span>
    <span class="n">log_custom</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">   Timing </span><span class="si">%f</span><span class="s2">: </span><span class="si">%.5f</span><span class="s2"> s&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">timings</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span>
                                       <span class="n">timings</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">timings</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span>
                   <span class="o">**</span><span class="n">log_scopt</span><span class="p">)</span>
    <span class="c1"># (siehe Keuerleber, M. (2006). Bestimmung des Elastizitätsmoduls von Kunststoffen bei hohen Dehnraten am Beispiel von PP. Von der Fakultät Maschinenbau der Universität Stuttgart zur Erlangung der Würde eines Doktor-Ingenieurs (Dr.-Ing.) genehmigte Abhandlung. Doktorarbeit. Universität Stuttgart, Stuttgart.)</span>
    <span class="n">ftmp</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="n">messu</span><span class="o">.</span><span class="n">Stress</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">VIP_messu</span><span class="p">[</span><span class="n">_opts</span><span class="p">[</span><span class="s1">&#39;OPT_YM_Determination_range&#39;</span><span class="p">][</span><span class="mi">2</span><span class="p">]]]</span><span class="o">*</span><span class="n">_opts</span><span class="p">[</span><span class="s1">&#39;OPT_YM_Determination_refinement&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">Lbord</span><span class="o">=</span><span class="nb">abs</span><span class="p">(</span><span class="n">messu</span><span class="o">.</span><span class="n">Stress</span><span class="o">.</span><span class="n">loc</span><span class="p">[:</span><span class="n">VIP_messu</span><span class="p">[</span><span class="n">_opts</span><span class="p">[</span><span class="s1">&#39;OPT_YM_Determination_range&#39;</span><span class="p">][</span><span class="mi">2</span><span class="p">]]]</span><span class="o">-</span><span class="n">ftmp</span><span class="p">)</span><span class="o">.</span><span class="n">idxmin</span><span class="p">()</span>
    
    <span class="n">DQcon</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">emec</span><span class="o">.</span><span class="n">mc_char</span><span class="o">.</span><span class="n">Diff_Quot</span><span class="p">(</span>
        <span class="n">messu</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;Strain&#39;</span><span class="p">],</span>
        <span class="n">messu</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;Stress&#39;</span><span class="p">],</span>
        <span class="n">_opts</span><span class="p">[</span><span class="s1">&#39;OPT_YM_Determination_refinement&#39;</span><span class="p">][</span><span class="mi">4</span><span class="p">],</span>
        <span class="n">_opts</span><span class="p">[</span><span class="s1">&#39;OPT_YM_Determination_refinement&#39;</span><span class="p">][</span><span class="mi">5</span><span class="p">]</span>
        <span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">DQcon</span><span class="o">=</span><span class="n">messu</span><span class="o">.</span><span class="n">loc</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)[[</span><span class="s1">&#39;Strain&#39;</span><span class="p">,</span><span class="s1">&#39;Stress&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">DQcon</span><span class="p">,</span><span class="n">how</span><span class="o">=</span><span class="s1">&#39;outer&#39;</span><span class="p">)</span>
    <span class="n">DQcons</span><span class="o">=</span><span class="n">DQcon</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">Lbord</span><span class="p">:</span><span class="n">VIP_messu</span><span class="p">[</span><span class="n">_opts</span><span class="p">[</span><span class="s1">&#39;OPT_YM_Determination_refinement&#39;</span><span class="p">][</span><span class="mi">2</span><span class="p">]]]</span>
    <span class="n">VIP_messu</span><span class="p">[</span><span class="s1">&#39;FM&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">DQcons</span><span class="o">.</span><span class="n">DQ1</span><span class="o">.</span><span class="n">idxmax</span><span class="p">()</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">VIP_messu</span><span class="p">[</span><span class="s1">&#39;F3&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">DQcons</span><span class="o">.</span><span class="n">loc</span><span class="p">[:</span><span class="n">VIP_messu</span><span class="p">[</span><span class="s1">&#39;FM&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">DQcons</span><span class="o">.</span><span class="n">DQ1</span><span class="o">/</span><span class="n">DQcons</span><span class="o">.</span><span class="n">DQ1</span><span class="o">.</span><span class="n">max</span><span class="p">())</span><span class="o">&lt;</span><span class="n">_opts</span><span class="p">[</span><span class="s1">&#39;OPT_YM_Determination_refinement&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">]]</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span>
        <span class="c1"># VIP_messu[&#39;F3&#39;]=DQcons.loc[:VIP_messu[&#39;FM&#39;]].iloc[::-1].loc[(DQcons.DQ1/DQcons.DQ1.max())&lt;_opts[&#39;OPT_YM_Determination_refinement&#39;][1]].index[0]</span>
    <span class="k">except</span> <span class="ne">IndexError</span><span class="p">:</span>
        <span class="n">VIP_messu</span><span class="p">[</span><span class="s1">&#39;F3&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">DQcons</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">try</span><span class="p">:</span> <span class="c1"># Hinzugefügt am 16.09.2021</span>
        <span class="n">VIP_messu</span><span class="p">[</span><span class="s1">&#39;F4&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">DQcons</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">VIP_messu</span><span class="p">[</span><span class="s1">&#39;FM&#39;</span><span class="p">]:]</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">DQcons</span><span class="o">.</span><span class="n">DQ1</span><span class="o">/</span><span class="n">DQcons</span><span class="o">.</span><span class="n">DQ1</span><span class="o">.</span><span class="n">max</span><span class="p">())</span><span class="o">&lt;</span><span class="n">_opts</span><span class="p">[</span><span class="s1">&#39;OPT_YM_Determination_refinement&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">]]</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="mi">1</span>
        <span class="c1"># VIP_messu[&#39;F4&#39;]=DQcons.loc[VIP_messu[&#39;FM&#39;]:].loc[(DQcons.DQ1/DQcons.DQ1.max())&lt;_opts[&#39;OPT_YM_Determination_refinement&#39;][1]].index[0]</span>
    <span class="k">except</span> <span class="ne">IndexError</span><span class="p">:</span>
        <span class="n">VIP_messu</span><span class="p">[</span><span class="s1">&#39;F4&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">VIP_messu</span><span class="p">[</span><span class="s1">&#39;FM&#39;</span><span class="p">]</span><span class="o">-</span><span class="mi">1</span> <span class="c1">#-1 könnte zu Problemen führen</span>
    <span class="n">VIP_messu</span><span class="o">=</span><span class="n">VIP_messu</span><span class="o">.</span><span class="n">sort_values</span><span class="p">()</span>
    
    <span class="c1"># optisch:    </span>
    <span class="n">DQopt</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">emec</span><span class="o">.</span><span class="n">mc_char</span><span class="o">.</span><span class="n">Diff_Quot</span><span class="p">(</span>
        <span class="n">messu</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="n">dic_used_Strain</span><span class="p">],</span>
        <span class="n">messu</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;Stress&#39;</span><span class="p">],</span>
        <span class="n">_opts</span><span class="p">[</span><span class="s1">&#39;OPT_YM_Determination_refinement&#39;</span><span class="p">][</span><span class="mi">4</span><span class="p">],</span>
        <span class="n">_opts</span><span class="p">[</span><span class="s1">&#39;OPT_YM_Determination_refinement&#39;</span><span class="p">][</span><span class="mi">5</span><span class="p">]</span>
        <span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">DQopt</span><span class="o">=</span><span class="n">messu</span><span class="o">.</span><span class="n">loc</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)[[</span><span class="n">dic_used_Strain</span><span class="p">,</span><span class="s1">&#39;Stress&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">DQopt</span><span class="p">,</span><span class="n">how</span><span class="o">=</span><span class="s1">&#39;outer&#39;</span><span class="p">)</span>
    <span class="n">DQopts</span><span class="o">=</span><span class="n">DQopt</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">Lbord</span><span class="p">:</span><span class="n">VIP_dicu</span><span class="p">[</span><span class="n">_opts</span><span class="p">[</span><span class="s1">&#39;OPT_YM_Determination_refinement&#39;</span><span class="p">][</span><span class="mi">2</span><span class="p">]]]</span>
    <span class="n">VIP_dicu</span><span class="p">[</span><span class="s1">&#39;FM&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">DQopts</span><span class="o">.</span><span class="n">DQ1</span><span class="o">.</span><span class="n">idxmax</span><span class="p">()</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">VIP_dicu</span><span class="p">[</span><span class="s1">&#39;F3&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">DQopts</span><span class="o">.</span><span class="n">loc</span><span class="p">[:</span><span class="n">VIP_dicu</span><span class="p">[</span><span class="s1">&#39;FM&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">DQopts</span><span class="o">.</span><span class="n">DQ1</span><span class="o">/</span><span class="n">DQopts</span><span class="o">.</span><span class="n">DQ1</span><span class="o">.</span><span class="n">max</span><span class="p">())</span><span class="o">&lt;</span><span class="n">_opts</span><span class="p">[</span><span class="s1">&#39;OPT_YM_Determination_refinement&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">]]</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span>
        <span class="c1"># VIP_dicu[&#39;F3&#39;]=DQopts.loc[:VIP_dicu[&#39;FM&#39;]].iloc[::-1].loc[(DQopts.DQ1/DQopts.DQ1.max())&lt;_opts[&#39;OPT_YM_Determination_refinement&#39;][1]].index[0]</span>
    <span class="k">except</span> <span class="ne">IndexError</span><span class="p">:</span>
        <span class="n">VIP_dicu</span><span class="p">[</span><span class="s1">&#39;F3&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">DQopts</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">try</span><span class="p">:</span> <span class="c1"># Hinzugefügt am 16.09.2021</span>
        <span class="n">VIP_dicu</span><span class="p">[</span><span class="s1">&#39;F4&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">DQopts</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">VIP_dicu</span><span class="p">[</span><span class="s1">&#39;FM&#39;</span><span class="p">]:]</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">DQopts</span><span class="o">.</span><span class="n">DQ1</span><span class="o">/</span><span class="n">DQopts</span><span class="o">.</span><span class="n">DQ1</span><span class="o">.</span><span class="n">max</span><span class="p">())</span><span class="o">&lt;</span><span class="n">_opts</span><span class="p">[</span><span class="s1">&#39;OPT_YM_Determination_refinement&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">]]</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="mi">1</span>
        <span class="c1"># VIP_dicu[&#39;F4&#39;]=DQopts.loc[VIP_dicu[&#39;FM&#39;]:].loc[(DQopts.DQ1/DQopts.DQ1.max())&lt;_opts[&#39;OPT_YM_Determination_refinement&#39;][1]].index[0]</span>
    <span class="k">except</span> <span class="ne">IndexError</span><span class="p">:</span>
        <span class="n">VIP_dicu</span><span class="p">[</span><span class="s1">&#39;F4&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">VIP_dicu</span><span class="p">[</span><span class="s1">&#39;FM&#39;</span><span class="p">]</span><span class="o">-</span><span class="mi">1</span> <span class="c1">#-1 könnte zu Problemen führen</span>
    <span class="n">VIP_dicu</span><span class="o">=</span><span class="n">VIP_dicu</span><span class="o">.</span><span class="n">sort_values</span><span class="p">()</span>
    
    <span class="k">if</span> <span class="kc">True</span><span class="p">:</span>
        <span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="n">ax1</span><span class="p">,</span><span class="n">ax3</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> 
                                      <span class="n">figsize</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">figsize</span><span class="p">,[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">]))</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1"> - Improvement of evaluation range for Youngs Modulus&#39;</span><span class="o">%</span><span class="n">plt_name</span><span class="p">)</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Conventional measured strain&#39;</span><span class="p">)</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Strain / -&#39;</span><span class="p">)</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Stress / MPa&#39;</span><span class="p">)</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">messu</span><span class="o">.</span><span class="n">loc</span><span class="p">[:</span><span class="n">VIP_messu</span><span class="p">[</span><span class="n">_opts</span><span class="p">[</span><span class="s1">&#39;OPT_YM_Determination_refinement&#39;</span><span class="p">][</span><span class="mi">2</span><span class="p">]],</span><span class="s1">&#39;Strain&#39;</span><span class="p">],</span> <span class="n">messu</span><span class="o">.</span><span class="n">loc</span><span class="p">[:</span><span class="n">VIP_messu</span><span class="p">[</span><span class="n">_opts</span><span class="p">[</span><span class="s1">&#39;OPT_YM_Determination_refinement&#39;</span><span class="p">][</span><span class="mi">2</span><span class="p">]],</span><span class="s1">&#39;Stress&#39;</span><span class="p">],</span> <span class="s1">&#39;r.&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;$\sigma$-$\epsilon$&#39;</span><span class="p">)</span>
        <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="n">messu</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">VIP_messu</span><span class="p">[:</span><span class="n">_opts</span><span class="p">[</span><span class="s1">&#39;OPT_YM_Determination_refinement&#39;</span><span class="p">][</span><span class="mi">2</span><span class="p">]],</span><span class="s1">&#39;Strain&#39;</span><span class="p">],</span><span class="n">messu</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">VIP_messu</span><span class="p">[:</span><span class="n">_opts</span><span class="p">[</span><span class="s1">&#39;OPT_YM_Determination_refinement&#39;</span><span class="p">][</span><span class="mi">2</span><span class="p">]],</span><span class="s1">&#39;Stress&#39;</span><span class="p">]</span>
        <span class="n">j</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int64</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="s1">&#39;bx&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">VIP_messu</span><span class="p">[:</span><span class="n">_opts</span><span class="p">[</span><span class="s1">&#39;OPT_YM_Determination_refinement&#39;</span><span class="p">][</span><span class="mi">2</span><span class="p">]]</span><span class="o">.</span><span class="n">index</span><span class="p">:</span>
            <span class="n">j</span><span class="o">+=</span><span class="mi">1</span>
            <span class="k">if</span> <span class="n">j</span><span class="o">%</span><span class="mi">2</span><span class="p">:</span> <span class="n">c</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="o">-</span><span class="mi">6</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>   <span class="n">c</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">6</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span>
            <span class="n">ax1</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">x</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">j</span><span class="p">],</span><span class="n">b</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">j</span><span class="p">]),</span> <span class="n">xycoords</span><span class="o">=</span><span class="s1">&#39;data&#39;</span><span class="p">,</span>
                         <span class="n">xytext</span><span class="o">=</span><span class="n">c</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span> <span class="n">textcoords</span><span class="o">=</span><span class="s1">&#39;offset points&#39;</span><span class="p">)</span>
        <span class="n">ax2</span><span class="o">=</span><span class="n">ax1</span><span class="o">.</span><span class="n">twinx</span><span class="p">()</span>
        <span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Normalized derivatives / -&#39;</span><span class="p">)</span>
        <span class="c1"># ax2.plot(DQcons[&#39;Strain&#39;], </span>
        <span class="c1">#          DQcons[&#39;DQ1&#39;]/abs(DQcons[&#39;DQ1&#39;]).max(), &#39;b:&#39;,label=&#39;DQ1&#39;)</span>
        <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">DQcons</span><span class="p">[</span><span class="s1">&#39;Strain&#39;</span><span class="p">],</span> 
                 <span class="n">DQcons</span><span class="p">[</span><span class="s1">&#39;DQ1&#39;</span><span class="p">]</span><span class="o">/</span><span class="n">DQcons</span><span class="p">[</span><span class="s1">&#39;DQ1&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="s1">&#39;b:&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;DQ1&#39;</span><span class="p">)</span>
        <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">DQcons</span><span class="p">[</span><span class="s1">&#39;Strain&#39;</span><span class="p">],</span> 
                 <span class="n">DQcons</span><span class="p">[</span><span class="s1">&#39;DQ2&#39;</span><span class="p">]</span><span class="o">/</span><span class="nb">abs</span><span class="p">(</span><span class="n">DQcons</span><span class="p">[</span><span class="s1">&#39;DQ2&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="s1">&#39;g:&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;DQ2&#39;</span><span class="p">)</span>
        <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">DQcons</span><span class="p">[</span><span class="s1">&#39;Strain&#39;</span><span class="p">],</span> 
                 <span class="n">DQcons</span><span class="p">[</span><span class="s1">&#39;DQ3&#39;</span><span class="p">]</span><span class="o">/</span><span class="nb">abs</span><span class="p">(</span><span class="n">DQcons</span><span class="p">[</span><span class="s1">&#39;DQ3&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="s1">&#39;y:&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;DQ3&#39;</span><span class="p">)</span>
        <span class="n">ax2</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">messu</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">VIP_messu</span><span class="p">[</span><span class="s1">&#39;FM&#39;</span><span class="p">],</span><span class="s1">&#39;Strain&#39;</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">)</span>
        <span class="n">ax2</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">messu</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">VIP_messu</span><span class="p">[</span><span class="s1">&#39;F3&#39;</span><span class="p">],</span><span class="s1">&#39;Strain&#39;</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">)</span>
        <span class="n">ax2</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">messu</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">VIP_messu</span><span class="p">[</span><span class="s1">&#39;F4&#39;</span><span class="p">],</span><span class="s1">&#39;Strain&#39;</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">)</span>
        <span class="n">ax2</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">_opts</span><span class="p">[</span><span class="s1">&#39;OPT_YM_Determination_refinement&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
        <span class="n">ax2</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">ax2</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">which</span><span class="o">=</span><span class="s1">&#39;major&#39;</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span><span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">)</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;lower right&#39;</span><span class="p">,</span> <span class="n">ncol</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
        
        <span class="n">ax3</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Optical measured strain&#39;</span><span class="p">)</span>
        <span class="n">ax3</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Strain / -&#39;</span><span class="p">)</span>
        <span class="n">ax3</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Stress / MPa&#39;</span><span class="p">)</span>
        <span class="n">ax3</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">messu</span><span class="o">.</span><span class="n">loc</span><span class="p">[:</span><span class="n">VIP_dicu</span><span class="p">[</span><span class="n">_opts</span><span class="p">[</span><span class="s1">&#39;OPT_YM_Determination_refinement&#39;</span><span class="p">][</span><span class="mi">2</span><span class="p">]],</span>
                           <span class="n">dic_used_Strain</span><span class="p">],</span>
                 <span class="n">messu</span><span class="o">.</span><span class="n">loc</span><span class="p">[:</span><span class="n">VIP_dicu</span><span class="p">[</span><span class="n">_opts</span><span class="p">[</span><span class="s1">&#39;OPT_YM_Determination_refinement&#39;</span><span class="p">][</span><span class="mi">2</span><span class="p">]],</span>
                           <span class="s1">&#39;Stress&#39;</span><span class="p">],</span> <span class="s1">&#39;r.&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;$\sigma$-$\epsilon$&#39;</span><span class="p">)</span>
        <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="n">messu</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">VIP_dicu</span><span class="p">[:</span><span class="n">_opts</span><span class="p">[</span><span class="s1">&#39;OPT_YM_Determination_refinement&#39;</span><span class="p">][</span><span class="mi">2</span><span class="p">]],</span>
                       <span class="n">dic_used_Strain</span><span class="p">],</span> <span class="n">messu</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">VIP_dicu</span><span class="p">[:</span><span class="n">_opts</span><span class="p">[</span><span class="s1">&#39;OPT_YM_Determination_refinement&#39;</span><span class="p">][</span><span class="mi">2</span><span class="p">]],</span><span class="s1">&#39;Stress&#39;</span><span class="p">]</span>
        <span class="n">j</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int64</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">ax3</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="s1">&#39;bx&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">VIP_dicu</span><span class="p">[:</span><span class="n">_opts</span><span class="p">[</span><span class="s1">&#39;OPT_YM_Determination_refinement&#39;</span><span class="p">][</span><span class="mi">2</span><span class="p">]]</span><span class="o">.</span><span class="n">index</span><span class="p">:</span>
            <span class="n">j</span><span class="o">+=</span><span class="mi">1</span>
            <span class="k">if</span> <span class="n">j</span><span class="o">%</span><span class="mi">2</span><span class="p">:</span> <span class="n">c</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="o">-</span><span class="mi">6</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>   <span class="n">c</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">6</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span>
            <span class="n">ax3</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">x</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">j</span><span class="p">],</span><span class="n">b</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">j</span><span class="p">]),</span> <span class="n">xycoords</span><span class="o">=</span><span class="s1">&#39;data&#39;</span><span class="p">,</span>
                         <span class="n">xytext</span><span class="o">=</span><span class="n">c</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span> <span class="n">textcoords</span><span class="o">=</span><span class="s1">&#39;offset points&#39;</span><span class="p">)</span>
        <span class="n">ax4</span><span class="o">=</span><span class="n">ax3</span><span class="o">.</span><span class="n">twinx</span><span class="p">()</span>
        <span class="n">ax4</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Normalized derivatives / -&#39;</span><span class="p">)</span>
        <span class="c1"># ax4.plot(DQopts[dic_used_Strain],</span>
        <span class="c1">#          DQopts[&#39;DQ1&#39;]/abs(DQopts[&#39;DQ1&#39;]).max(), &#39;b:&#39;,label=&#39;DQ1&#39;)</span>
        <span class="n">ax4</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">DQopts</span><span class="p">[</span><span class="n">dic_used_Strain</span><span class="p">],</span>
                 <span class="n">DQopts</span><span class="p">[</span><span class="s1">&#39;DQ1&#39;</span><span class="p">]</span><span class="o">/</span><span class="n">DQopts</span><span class="p">[</span><span class="s1">&#39;DQ1&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="s1">&#39;b:&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;DQ1&#39;</span><span class="p">)</span>
        <span class="n">ax4</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">DQopts</span><span class="p">[</span><span class="n">dic_used_Strain</span><span class="p">],</span>
                 <span class="n">DQopts</span><span class="p">[</span><span class="s1">&#39;DQ2&#39;</span><span class="p">]</span><span class="o">/</span><span class="nb">abs</span><span class="p">(</span><span class="n">DQopts</span><span class="p">[</span><span class="s1">&#39;DQ2&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="s1">&#39;g:&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;DQ2&#39;</span><span class="p">)</span>
        <span class="n">ax4</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">DQopts</span><span class="p">[</span><span class="n">dic_used_Strain</span><span class="p">],</span>
                 <span class="n">DQopts</span><span class="p">[</span><span class="s1">&#39;DQ3&#39;</span><span class="p">]</span><span class="o">/</span><span class="nb">abs</span><span class="p">(</span><span class="n">DQopts</span><span class="p">[</span><span class="s1">&#39;DQ3&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="s1">&#39;y:&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;DQ3&#39;</span><span class="p">)</span>
        <span class="c1"># ax4.axvline(x=DQopts.loc[VIP_dicu[&#39;FM&#39;],dic_used_Strain],color=&#39;gray&#39;, linestyle=&#39;-&#39;)</span>
        <span class="c1"># ax4.axvline(x=DQopts.loc[VIP_dicu[&#39;F3&#39;],dic_used_Strain],color=&#39;gray&#39;, linestyle=&#39;:&#39;)</span>
        <span class="c1"># ax4.axvline(x=DQopts.loc[VIP_dicu[&#39;F4&#39;],dic_used_Strain],color=&#39;gray&#39;, linestyle=&#39;:&#39;)</span>
        <span class="n">ax4</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">messu</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">VIP_dicu</span><span class="p">[</span><span class="s1">&#39;FM&#39;</span><span class="p">],</span><span class="n">dic_used_Strain</span><span class="p">],</span>
                    <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">)</span>
        <span class="n">ax4</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">messu</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">VIP_dicu</span><span class="p">[</span><span class="s1">&#39;F3&#39;</span><span class="p">],</span><span class="n">dic_used_Strain</span><span class="p">],</span>
                    <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">)</span>
        <span class="n">ax4</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">messu</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">VIP_dicu</span><span class="p">[</span><span class="s1">&#39;F4&#39;</span><span class="p">],</span><span class="n">dic_used_Strain</span><span class="p">],</span>
                    <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">)</span>
        <span class="n">ax4</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">_opts</span><span class="p">[</span><span class="s1">&#39;OPT_YM_Determination_refinement&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span>
                    <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
        <span class="n">ax4</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">ax4</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">which</span><span class="o">=</span><span class="s1">&#39;major&#39;</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span><span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">)</span>
        <span class="n">plt_hsuf</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span><span class="n">path</span><span class="o">=</span><span class="n">out_full</span><span class="o">+</span><span class="s2">&quot;-YMRange_Imp&quot;</span><span class="p">,</span><span class="o">**</span><span class="n">plt_scopt</span><span class="p">)</span>
     
    <span class="k">if</span> <span class="n">_opts</span><span class="p">[</span><span class="s1">&#39;OPT_DIC&#39;</span><span class="p">]:</span>
        <span class="n">tmp</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;con F1-F2&#39;</span><span class="p">:</span><span class="n">VIP_messu</span><span class="p">[</span><span class="s1">&#39;F2&#39;</span><span class="p">]</span><span class="o">-</span><span class="n">VIP_messu</span><span class="p">[</span><span class="s1">&#39;F1&#39;</span><span class="p">],</span>
             <span class="s1">&#39;opt F1-F2&#39;</span><span class="p">:</span><span class="n">VIP_dicu</span><span class="p">[</span><span class="s1">&#39;F2&#39;</span><span class="p">]</span><span class="o">-</span><span class="n">VIP_dicu</span><span class="p">[</span><span class="s1">&#39;F1&#39;</span><span class="p">],</span>
             <span class="s1">&#39;con F3-F4&#39;</span><span class="p">:</span><span class="n">VIP_messu</span><span class="p">[</span><span class="s1">&#39;F4&#39;</span><span class="p">]</span><span class="o">-</span><span class="n">VIP_messu</span><span class="p">[</span><span class="s1">&#39;F3&#39;</span><span class="p">],</span>
             <span class="s1">&#39;opt F3-F4&#39;</span><span class="p">:</span><span class="n">VIP_dicu</span><span class="p">[</span><span class="s1">&#39;F4&#39;</span><span class="p">]</span><span class="o">-</span><span class="n">VIP_dicu</span><span class="p">[</span><span class="s1">&#39;F3&#39;</span><span class="p">]}</span>
        <span class="n">log_custom</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">   Datapoints (con/opt) between F1-F2: </span><span class="si">%d</span><span class="s2">/</span><span class="si">%d</span><span class="s2"> and F3-F4: </span><span class="si">%d</span><span class="s2">/</span><span class="si">%d</span><span class="s2">.&quot;</span>
                       <span class="o">%</span><span class="p">(</span><span class="o">*</span><span class="n">tmp</span><span class="o">.</span><span class="n">values</span><span class="p">(),),</span> <span class="o">**</span><span class="n">log_scoptf</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">tmp</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span> 
            <span class="k">if</span> <span class="n">tmp</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">3</span><span class="p">:</span> <span class="n">cout</span><span class="o">+=</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1">:</span><span class="si">%d</span><span class="s1"> DPs, &#39;</span><span class="o">%</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">tmp</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">tmp</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;con F1-F2&#39;</span><span class="p">:</span><span class="n">VIP_messu</span><span class="p">[</span><span class="s1">&#39;F2&#39;</span><span class="p">]</span><span class="o">-</span><span class="n">VIP_messu</span><span class="p">[</span><span class="s1">&#39;F1&#39;</span><span class="p">],</span>
             <span class="s1">&#39;con F3-F4&#39;</span><span class="p">:</span><span class="n">VIP_messu</span><span class="p">[</span><span class="s1">&#39;F4&#39;</span><span class="p">]</span><span class="o">-</span><span class="n">VIP_messu</span><span class="p">[</span><span class="s1">&#39;F3&#39;</span><span class="p">]}</span>
        <span class="n">log_custom</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">   Datapoints (con) between F1-F2: </span><span class="si">%d</span><span class="s2"> and F3-F4: </span><span class="si">%d</span><span class="s2">.&quot;</span>
                       <span class="o">%</span><span class="p">(</span><span class="o">*</span><span class="n">tmp</span><span class="o">.</span><span class="n">values</span><span class="p">(),),</span> <span class="o">**</span><span class="n">log_scoptf</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">tmp</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span> 
            <span class="k">if</span> <span class="n">tmp</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">3</span><span class="p">:</span> <span class="n">cout</span><span class="o">+=</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1">:</span><span class="si">%d</span><span class="s1"> DPs, &#39;</span><span class="o">%</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">tmp</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
            
    <span class="c1"># =====================================================================================</span>
    <span class="c1">#%%% 6.4 Determine Youngs-Moduli</span>
    <span class="n">log_custom</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2"> &quot;</span><span class="o">+</span><span class="s2">&quot;-&quot;</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span><span class="o">**</span><span class="n">log_scopt</span><span class="p">)</span>
    <span class="n">log_custom</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2"> ### -6.4 Determine Youngs-Moduli ###&quot;</span><span class="p">,</span><span class="o">**</span><span class="n">log_scopt</span><span class="p">)</span>
    <span class="n">timings</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mf">6.4</span><span class="p">]</span><span class="o">=</span><span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span>
    <span class="n">log_custom</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">   Timing </span><span class="si">%f</span><span class="s2">: </span><span class="si">%.5f</span><span class="s2"> s&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">timings</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span>
                                       <span class="n">timings</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">timings</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span>
                   <span class="o">**</span><span class="n">log_scopt</span><span class="p">)</span>
    
    <span class="n">d_stress_mid</span> <span class="o">=</span> <span class="n">messu</span><span class="o">.</span><span class="n">Stress</span><span class="o">.</span><span class="n">diff</span><span class="p">()</span>
    <span class="n">d_strain_mid</span> <span class="o">=</span> <span class="n">messu</span><span class="o">.</span><span class="n">Strain</span><span class="o">.</span><span class="n">diff</span><span class="p">()</span>
    <span class="n">d_Strain_opt_d_A_mid</span> <span class="o">=</span> <span class="n">messu</span><span class="o">.</span><span class="n">Strain_opt_d_A</span><span class="o">.</span><span class="n">diff</span><span class="p">()</span>
    <span class="n">d_Strain_opt_d_S_mid</span> <span class="o">=</span> <span class="n">messu</span><span class="o">.</span><span class="n">Strain_opt_d_S</span><span class="o">.</span><span class="n">diff</span><span class="p">()</span>
    <span class="n">d_Strain_opt_d_M_mid</span> <span class="o">=</span> <span class="n">messu</span><span class="o">.</span><span class="n">Strain_opt_d_M</span><span class="o">.</span><span class="n">diff</span><span class="p">()</span>
    <span class="n">d_Strain_opt_c_A_mid</span> <span class="o">=</span> <span class="n">messu</span><span class="o">.</span><span class="n">Strain_opt_c_A</span><span class="o">.</span><span class="n">diff</span><span class="p">()</span>
    <span class="n">d_Strain_opt_c_S_mid</span> <span class="o">=</span> <span class="n">messu</span><span class="o">.</span><span class="n">Strain_opt_c_S</span><span class="o">.</span><span class="n">diff</span><span class="p">()</span>
    <span class="n">d_Strain_opt_c_M_mid</span> <span class="o">=</span> <span class="n">messu</span><span class="o">.</span><span class="n">Strain_opt_c_M</span><span class="o">.</span><span class="n">diff</span><span class="p">()</span>
    <span class="n">d_Force</span> <span class="o">=</span> <span class="n">messu</span><span class="o">.</span><span class="n">Force</span><span class="o">.</span><span class="n">diff</span><span class="p">()</span>
    
    <span class="c1"># sr_eva_con = messu.loc[VIP_messu[&#39;F3&#39;]:VIP_messu[&#39;F4&#39;]].index</span>
    <span class="c1"># sr_eva_dic = Evac.pd_combine_index(step_range_dic, </span>
    <span class="c1">#                                    messu.loc[VIP_dicu[&#39;F3&#39;]:VIP_dicu[&#39;F4&#39;]])</span>
    <span class="n">Ind_YM_f</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;F1&#39;</span><span class="p">,</span><span class="s1">&#39;F2&#39;</span><span class="p">]</span>
    <span class="n">Ind_YM_r</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;F3&#39;</span><span class="p">,</span><span class="s1">&#39;F4&#39;</span><span class="p">]</span>
    <span class="n">sf_eva_con</span> <span class="o">=</span> <span class="n">messu</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">VIP_messu</span><span class="p">[</span><span class="n">Ind_YM_f</span><span class="p">[</span><span class="mi">0</span><span class="p">]]:</span><span class="n">VIP_messu</span><span class="p">[</span><span class="n">Ind_YM_f</span><span class="p">[</span><span class="mi">1</span><span class="p">]]]</span><span class="o">.</span><span class="n">index</span>
    <span class="n">sf_eva_dic</span> <span class="o">=</span> <span class="n">emec</span><span class="o">.</span><span class="n">pd_ext</span><span class="o">.</span><span class="n">pd_combine_index</span><span class="p">(</span>
        <span class="n">step_range_dic</span><span class="p">,</span> 
        <span class="n">messu</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">VIP_dicu</span><span class="p">[</span><span class="n">Ind_YM_f</span><span class="p">[</span><span class="mi">0</span><span class="p">]]:</span><span class="n">VIP_dicu</span><span class="p">[</span><span class="n">Ind_YM_f</span><span class="p">[</span><span class="mi">1</span><span class="p">]]]</span>
        <span class="p">)</span>
    <span class="n">sr_eva_con</span> <span class="o">=</span> <span class="n">messu</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">VIP_messu</span><span class="p">[</span><span class="n">Ind_YM_r</span><span class="p">[</span><span class="mi">0</span><span class="p">]]:</span><span class="n">VIP_messu</span><span class="p">[</span><span class="n">Ind_YM_r</span><span class="p">[</span><span class="mi">1</span><span class="p">]]]</span><span class="o">.</span><span class="n">index</span>
    <span class="n">sr_eva_dic</span> <span class="o">=</span> <span class="n">emec</span><span class="o">.</span><span class="n">pd_ext</span><span class="o">.</span><span class="n">pd_combine_index</span><span class="p">(</span>
        <span class="n">step_range_dic</span><span class="p">,</span> 
        <span class="n">messu</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">VIP_dicu</span><span class="p">[</span><span class="n">Ind_YM_r</span><span class="p">[</span><span class="mi">0</span><span class="p">]]:</span><span class="n">VIP_dicu</span><span class="p">[</span><span class="n">Ind_YM_r</span><span class="p">[</span><span class="mi">1</span><span class="p">]]]</span>
        <span class="p">)</span>
    <span class="c1"># -------------------------------------------------------------------------------------</span>
    <span class="c1">#%%%% 6.4.1 Method A</span>
    <span class="n">timings</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mf">6.41</span><span class="p">]</span><span class="o">=</span><span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span>
    <span class="n">log_custom</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">   Timing </span><span class="si">%f</span><span class="s2">: </span><span class="si">%.5f</span><span class="s2"> s&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">timings</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span>
                                       <span class="n">timings</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">timings</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span>
                   <span class="o">**</span><span class="n">log_scopt</span><span class="p">)</span>
    
    <span class="n">A0Al_ser</span> <span class="o">=</span> <span class="n">emeb</span><span class="o">.</span><span class="n">evaluation</span><span class="o">.</span><span class="n">YM_eva_method_A</span><span class="p">(</span>
        <span class="n">stress_mid_ser</span><span class="o">=</span><span class="n">d_stress_mid</span><span class="p">,</span>
        <span class="n">strain_mid_ser</span><span class="o">=</span><span class="n">d_strain_mid</span><span class="p">,</span>
        <span class="n">comp</span><span class="o">=</span><span class="n">_opts</span><span class="p">[</span><span class="s1">&#39;OPT_Compression&#39;</span><span class="p">],</span>
        <span class="n">name</span><span class="o">=</span><span class="s1">&#39;A0Al&#39;</span><span class="p">,</span> 
        <span class="n">det_opt</span><span class="o">=</span><span class="s1">&#39;incremental&#39;</span>
        <span class="p">)</span>
    <span class="n">A2Al_ser</span> <span class="o">=</span> <span class="n">emeb</span><span class="o">.</span><span class="n">evaluation</span><span class="o">.</span><span class="n">YM_eva_method_A</span><span class="p">(</span>
        <span class="n">stress_mid_ser</span><span class="o">=</span><span class="n">d_stress_mid</span><span class="p">,</span>
        <span class="n">strain_mid_ser</span><span class="o">=</span><span class="n">d_Strain_opt_d_A_mid</span><span class="p">,</span>
        <span class="n">comp</span><span class="o">=</span><span class="n">_opts</span><span class="p">[</span><span class="s1">&#39;OPT_Compression&#39;</span><span class="p">],</span>
        <span class="n">name</span><span class="o">=</span><span class="s1">&#39;A2Al&#39;</span><span class="p">,</span> 
        <span class="n">det_opt</span><span class="o">=</span><span class="s1">&#39;incremental&#39;</span>
        <span class="p">)</span>
    <span class="n">A2Sl_ser</span> <span class="o">=</span> <span class="n">emeb</span><span class="o">.</span><span class="n">evaluation</span><span class="o">.</span><span class="n">YM_eva_method_A</span><span class="p">(</span>
        <span class="n">stress_mid_ser</span><span class="o">=</span><span class="n">d_stress_mid</span><span class="p">,</span>
        <span class="n">strain_mid_ser</span><span class="o">=</span><span class="n">d_Strain_opt_d_S_mid</span><span class="p">,</span>
        <span class="n">comp</span><span class="o">=</span><span class="n">_opts</span><span class="p">[</span><span class="s1">&#39;OPT_Compression&#39;</span><span class="p">],</span>
        <span class="n">name</span><span class="o">=</span><span class="s1">&#39;A2Sl&#39;</span><span class="p">,</span> 
        <span class="n">det_opt</span><span class="o">=</span><span class="s1">&#39;incremental&#39;</span>
        <span class="p">)</span>
    <span class="n">A2Ml_ser</span> <span class="o">=</span> <span class="n">emeb</span><span class="o">.</span><span class="n">evaluation</span><span class="o">.</span><span class="n">YM_eva_method_A</span><span class="p">(</span>
        <span class="n">stress_mid_ser</span><span class="o">=</span><span class="n">d_stress_mid</span><span class="p">,</span>
        <span class="n">strain_mid_ser</span><span class="o">=</span><span class="n">d_Strain_opt_d_M_mid</span><span class="p">,</span>
        <span class="n">comp</span><span class="o">=</span><span class="n">_opts</span><span class="p">[</span><span class="s1">&#39;OPT_Compression&#39;</span><span class="p">],</span>
        <span class="n">name</span><span class="o">=</span><span class="s1">&#39;A2Ml&#39;</span><span class="p">,</span> 
        <span class="n">det_opt</span><span class="o">=</span><span class="s1">&#39;incremental&#39;</span>
        <span class="p">)</span>
    <span class="n">A4Al_ser</span> <span class="o">=</span> <span class="n">emeb</span><span class="o">.</span><span class="n">evaluation</span><span class="o">.</span><span class="n">YM_eva_method_A</span><span class="p">(</span>
        <span class="n">stress_mid_ser</span><span class="o">=</span><span class="n">d_stress_mid</span><span class="p">,</span>
        <span class="n">strain_mid_ser</span><span class="o">=</span><span class="n">d_Strain_opt_c_A_mid</span><span class="p">,</span>
        <span class="n">comp</span><span class="o">=</span><span class="n">_opts</span><span class="p">[</span><span class="s1">&#39;OPT_Compression&#39;</span><span class="p">],</span>
        <span class="n">name</span><span class="o">=</span><span class="s1">&#39;A4Al&#39;</span><span class="p">,</span> 
        <span class="n">det_opt</span><span class="o">=</span><span class="s1">&#39;incremental&#39;</span>
        <span class="p">)</span>
    <span class="n">A4Sl_ser</span> <span class="o">=</span> <span class="n">emeb</span><span class="o">.</span><span class="n">evaluation</span><span class="o">.</span><span class="n">YM_eva_method_A</span><span class="p">(</span>
        <span class="n">stress_mid_ser</span><span class="o">=</span><span class="n">d_stress_mid</span><span class="p">,</span>
        <span class="n">strain_mid_ser</span><span class="o">=</span><span class="n">d_Strain_opt_c_S_mid</span><span class="p">,</span>
        <span class="n">comp</span><span class="o">=</span><span class="n">_opts</span><span class="p">[</span><span class="s1">&#39;OPT_Compression&#39;</span><span class="p">],</span>
        <span class="n">name</span><span class="o">=</span><span class="s1">&#39;A4Sl&#39;</span><span class="p">,</span> 
        <span class="n">det_opt</span><span class="o">=</span><span class="s1">&#39;incremental&#39;</span>
        <span class="p">)</span>
    <span class="n">A4Ml_ser</span> <span class="o">=</span> <span class="n">emeb</span><span class="o">.</span><span class="n">evaluation</span><span class="o">.</span><span class="n">YM_eva_method_A</span><span class="p">(</span>
        <span class="n">stress_mid_ser</span><span class="o">=</span><span class="n">d_stress_mid</span><span class="p">,</span>
        <span class="n">strain_mid_ser</span><span class="o">=</span><span class="n">d_Strain_opt_c_M_mid</span><span class="p">,</span>
        <span class="n">comp</span><span class="o">=</span><span class="n">_opts</span><span class="p">[</span><span class="s1">&#39;OPT_Compression&#39;</span><span class="p">],</span>
        <span class="n">name</span><span class="o">=</span><span class="s1">&#39;A4Ml&#39;</span><span class="p">,</span> 
        <span class="n">det_opt</span><span class="o">=</span><span class="s1">&#39;incremental&#39;</span>
        <span class="p">)</span>
    <span class="n">E_A_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">A0Al_ser</span><span class="p">,</span>
                        <span class="n">A2Al_ser</span><span class="p">,</span> <span class="n">A2Sl_ser</span><span class="p">,</span> <span class="n">A2Ml_ser</span><span class="p">,</span>
                        <span class="n">A4Al_ser</span><span class="p">,</span> <span class="n">A4Sl_ser</span><span class="p">,</span> <span class="n">A4Ml_ser</span><span class="p">],</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    
    <span class="n">cols_con</span><span class="o">=</span><span class="n">E_A_df</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s1">&#39;0&#39;</span><span class="p">)</span>
    <span class="n">E_A_con</span> <span class="o">=</span> <span class="n">emec</span><span class="o">.</span><span class="n">stat_ext</span><span class="o">.</span><span class="n">pd_agg</span><span class="p">(</span><span class="n">E_A_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">sr_eva_con</span><span class="p">,</span><span class="n">cols_con</span><span class="p">])</span>
    <span class="n">E_A_opt</span> <span class="o">=</span> <span class="n">emec</span><span class="o">.</span><span class="n">stat_ext</span><span class="o">.</span><span class="n">pd_agg</span><span class="p">(</span><span class="n">E_A_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">sr_eva_dic</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">invert</span><span class="p">(</span><span class="n">cols_con</span><span class="p">)])</span>
    <span class="n">E_A</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">E_A_con</span><span class="p">,</span><span class="n">E_A_opt</span><span class="p">],</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

    <span class="k">if</span> <span class="kc">True</span><span class="p">:</span>
        <span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="n">ax1</span><span class="p">,</span><span class="n">ax2</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> 
                                      <span class="n">sharex</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> 
                                      <span class="n">figsize</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">figsize</span><span class="p">,[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">]))</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1"> - Compare method A&#39;</span><span class="o">%</span><span class="p">(</span><span class="n">plt_name</span><span class="p">))</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;All Steps&#39;</span><span class="p">)</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Step / -&#39;</span><span class="p">)</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;E / MPa&#39;</span><span class="p">)</span>
        <span class="n">cc</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;A0Al&#39;</span><span class="p">:</span><span class="s1">&#39;m:&#39;</span><span class="p">,</span>
            <span class="s1">&#39;A2Al&#39;</span><span class="p">:</span><span class="s1">&#39;r:&#39;</span><span class="p">,</span><span class="s1">&#39;A2Sl&#39;</span><span class="p">:</span><span class="s1">&#39;b:&#39;</span><span class="p">,</span><span class="s1">&#39;A2Ml&#39;</span><span class="p">:</span><span class="s1">&#39;g:&#39;</span><span class="p">,</span>
            <span class="s1">&#39;A4Al&#39;</span><span class="p">:</span><span class="s1">&#39;r--&#39;</span><span class="p">,</span><span class="s1">&#39;A4Sl&#39;</span><span class="p">:</span><span class="s1">&#39;b--&#39;</span><span class="p">,</span><span class="s1">&#39;A4Ml&#39;</span><span class="p">:</span><span class="s1">&#39;g--&#39;</span><span class="p">}</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">cc</span><span class="p">:</span>
            <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">E_A_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:</span><span class="n">VIP_messu</span><span class="p">[</span><span class="s1">&#39;U&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">index</span><span class="p">,</span>
                     <span class="n">E_A_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:</span><span class="n">VIP_messu</span><span class="p">[</span><span class="s1">&#39;U&#39;</span><span class="p">]][</span><span class="n">k</span><span class="p">],</span>
                     <span class="n">cc</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1"> - </span><span class="si">%.2f</span><span class="s1"> MPa&#39;</span><span class="o">%</span><span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="n">E_A</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="s1">&#39;mean&#39;</span><span class="p">,</span><span class="n">k</span><span class="p">]))</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">VIP_messu</span><span class="p">[</span><span class="s1">&#39;F3&#39;</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;brown&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">)</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">VIP_messu</span><span class="p">[</span><span class="s1">&#39;F4&#39;</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;brown&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">VIP_dicu</span><span class="p">[</span><span class="s1">&#39;F3&#39;</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;olive&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">)</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">VIP_dicu</span><span class="p">[</span><span class="s1">&#39;F4&#39;</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;olive&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
        <span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Improved determination range&#39;</span><span class="p">)</span>
        <span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Step / -&#39;</span><span class="p">)</span>
        <span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;E / MPa&#39;</span><span class="p">)</span>
        <span class="n">cr</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;A0Al&#39;</span><span class="p">:</span><span class="n">sr_eva_con</span><span class="p">,</span>
            <span class="s1">&#39;A2Al&#39;</span><span class="p">:</span><span class="n">sr_eva_dic</span><span class="p">,</span><span class="s1">&#39;A2Sl&#39;</span><span class="p">:</span><span class="n">sr_eva_dic</span><span class="p">,</span><span class="s1">&#39;A2Ml&#39;</span><span class="p">:</span><span class="n">sr_eva_dic</span><span class="p">,</span>
            <span class="s1">&#39;A4Al&#39;</span><span class="p">:</span><span class="n">sr_eva_dic</span><span class="p">,</span><span class="s1">&#39;A4Sl&#39;</span><span class="p">:</span><span class="n">sr_eva_dic</span><span class="p">,</span><span class="s1">&#39;A4Ml&#39;</span><span class="p">:</span><span class="n">sr_eva_dic</span><span class="p">}</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">cc</span><span class="p">:</span>
            <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">cr</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">E_A_df</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">cr</span><span class="p">[</span><span class="n">k</span><span class="p">]],</span> <span class="n">cc</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
        <span class="n">ax2</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">VIP_messu</span><span class="p">[</span><span class="s1">&#39;F3&#39;</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;brown&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">)</span>
        <span class="n">ax2</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">VIP_messu</span><span class="p">[</span><span class="s1">&#39;F4&#39;</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;brown&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
        <span class="n">ax2</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">VIP_dicu</span><span class="p">[</span><span class="s1">&#39;F3&#39;</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;olive&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">)</span>
        <span class="n">ax2</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">VIP_dicu</span><span class="p">[</span><span class="s1">&#39;F4&#39;</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;olive&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
        <span class="n">plt_hsuf</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span><span class="n">path</span><span class="o">=</span><span class="n">out_full</span><span class="o">+</span><span class="s2">&quot;-YM-Me_A&quot;</span><span class="p">,</span><span class="o">**</span><span class="n">plt_scopt</span><span class="p">)</span>
        
    <span class="c1">#least-square fit</span>
    <span class="n">E_lsq_F_A0Al</span> <span class="o">=</span> <span class="n">emeb</span><span class="o">.</span><span class="n">evaluation</span><span class="o">.</span><span class="n">YM_eva_method_A</span><span class="p">(</span><span class="n">stress_mid_ser</span><span class="o">=</span><span class="n">messu</span><span class="o">.</span><span class="n">Stress</span><span class="p">,</span>
                                    <span class="n">strain_mid_ser</span><span class="o">=</span><span class="n">messu</span><span class="o">.</span><span class="n">Strain</span><span class="p">,</span>
                                    <span class="n">comp</span><span class="o">=</span><span class="n">_opts</span><span class="p">[</span><span class="s1">&#39;OPT_Compression&#39;</span><span class="p">],</span>
                                    <span class="n">name</span><span class="o">=</span><span class="s1">&#39;E_lsq_F_A0Al&#39;</span><span class="p">,</span> 
                                    <span class="n">det_opt</span><span class="o">=</span><span class="s1">&#39;leastsq&#39;</span><span class="p">,</span>
                                    <span class="o">**</span><span class="p">{</span><span class="s1">&#39;ind_S&#39;</span><span class="p">:</span><span class="n">VIP_messu</span><span class="p">[</span><span class="n">Ind_YM_f</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span>
                                       <span class="s1">&#39;ind_E&#39;</span><span class="p">:</span><span class="n">VIP_messu</span><span class="p">[</span><span class="n">Ind_YM_f</span><span class="p">[</span><span class="mi">1</span><span class="p">]]})</span>
    <span class="n">E_lsq_F_A0Al</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">E_lsq_F_A0Al</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;E&#39;</span><span class="p">,</span><span class="s1">&#39;E_abs&#39;</span><span class="p">,</span><span class="s1">&#39;Rquad&#39;</span><span class="p">,</span><span class="s1">&#39;Fit_result&#39;</span><span class="p">],</span>
                            <span class="n">name</span><span class="o">=</span><span class="s1">&#39;E_lsq_F_A0Al&#39;</span><span class="p">)</span>
    
    <span class="n">E_lsq_F_A2Al</span> <span class="o">=</span> <span class="n">emeb</span><span class="o">.</span><span class="n">evaluation</span><span class="o">.</span><span class="n">YM_eva_method_A</span><span class="p">(</span><span class="n">stress_mid_ser</span><span class="o">=</span><span class="n">messu</span><span class="o">.</span><span class="n">Stress</span><span class="p">,</span>
                                    <span class="n">strain_mid_ser</span><span class="o">=</span><span class="n">messu</span><span class="o">.</span><span class="n">Strain_opt_d_A</span><span class="p">,</span>
                                    <span class="n">comp</span><span class="o">=</span><span class="n">_opts</span><span class="p">[</span><span class="s1">&#39;OPT_Compression&#39;</span><span class="p">],</span>
                                    <span class="n">name</span><span class="o">=</span><span class="s1">&#39;E_lsq_F_A2Al&#39;</span><span class="p">,</span> 
                                    <span class="n">det_opt</span><span class="o">=</span><span class="s1">&#39;leastsq&#39;</span><span class="p">,</span>
                                    <span class="o">**</span><span class="p">{</span><span class="s1">&#39;ind_S&#39;</span><span class="p">:</span><span class="n">VIP_dicu</span><span class="p">[</span><span class="n">Ind_YM_f</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span>
                                       <span class="s1">&#39;ind_E&#39;</span><span class="p">:</span><span class="n">VIP_dicu</span><span class="p">[</span><span class="n">Ind_YM_f</span><span class="p">[</span><span class="mi">1</span><span class="p">]]})</span>
    <span class="n">E_lsq_F_A2Al</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">E_lsq_F_A2Al</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;E&#39;</span><span class="p">,</span><span class="s1">&#39;E_abs&#39;</span><span class="p">,</span><span class="s1">&#39;Rquad&#39;</span><span class="p">,</span><span class="s1">&#39;Fit_result&#39;</span><span class="p">],</span>
                            <span class="n">name</span><span class="o">=</span><span class="s1">&#39;E_lsq_F_A2Al&#39;</span><span class="p">)</span>
    <span class="n">E_lsq_F_A2Sl</span> <span class="o">=</span> <span class="n">emeb</span><span class="o">.</span><span class="n">evaluation</span><span class="o">.</span><span class="n">YM_eva_method_A</span><span class="p">(</span><span class="n">stress_mid_ser</span><span class="o">=</span><span class="n">messu</span><span class="o">.</span><span class="n">Stress</span><span class="p">,</span>
                                    <span class="n">strain_mid_ser</span><span class="o">=</span><span class="n">messu</span><span class="o">.</span><span class="n">Strain_opt_d_S</span><span class="p">,</span>
                                    <span class="n">comp</span><span class="o">=</span><span class="n">_opts</span><span class="p">[</span><span class="s1">&#39;OPT_Compression&#39;</span><span class="p">],</span>
                                    <span class="n">name</span><span class="o">=</span><span class="s1">&#39;E_lsq_F_A2Sl&#39;</span><span class="p">,</span> 
                                    <span class="n">det_opt</span><span class="o">=</span><span class="s1">&#39;leastsq&#39;</span><span class="p">,</span>
                                    <span class="o">**</span><span class="p">{</span><span class="s1">&#39;ind_S&#39;</span><span class="p">:</span><span class="n">VIP_dicu</span><span class="p">[</span><span class="n">Ind_YM_f</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span>
                                       <span class="s1">&#39;ind_E&#39;</span><span class="p">:</span><span class="n">VIP_dicu</span><span class="p">[</span><span class="n">Ind_YM_f</span><span class="p">[</span><span class="mi">1</span><span class="p">]]})</span>
    <span class="n">E_lsq_F_A2Sl</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">E_lsq_F_A2Sl</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;E&#39;</span><span class="p">,</span><span class="s1">&#39;E_abs&#39;</span><span class="p">,</span><span class="s1">&#39;Rquad&#39;</span><span class="p">,</span><span class="s1">&#39;Fit_result&#39;</span><span class="p">],</span>
                            <span class="n">name</span><span class="o">=</span><span class="s1">&#39;E_lsq_F_A2Sl&#39;</span><span class="p">)</span>
    <span class="n">E_lsq_F_A2Ml</span> <span class="o">=</span> <span class="n">emeb</span><span class="o">.</span><span class="n">evaluation</span><span class="o">.</span><span class="n">YM_eva_method_A</span><span class="p">(</span><span class="n">stress_mid_ser</span><span class="o">=</span><span class="n">messu</span><span class="o">.</span><span class="n">Stress</span><span class="p">,</span>
                                    <span class="n">strain_mid_ser</span><span class="o">=</span><span class="n">messu</span><span class="o">.</span><span class="n">Strain_opt_d_M</span><span class="p">,</span>
                                    <span class="n">comp</span><span class="o">=</span><span class="n">_opts</span><span class="p">[</span><span class="s1">&#39;OPT_Compression&#39;</span><span class="p">],</span>
                                    <span class="n">name</span><span class="o">=</span><span class="s1">&#39;E_lsq_F_A2Ml&#39;</span><span class="p">,</span> 
                                    <span class="n">det_opt</span><span class="o">=</span><span class="s1">&#39;leastsq&#39;</span><span class="p">,</span>
                                    <span class="o">**</span><span class="p">{</span><span class="s1">&#39;ind_S&#39;</span><span class="p">:</span><span class="n">VIP_dicu</span><span class="p">[</span><span class="n">Ind_YM_f</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span>
                                       <span class="s1">&#39;ind_E&#39;</span><span class="p">:</span><span class="n">VIP_dicu</span><span class="p">[</span><span class="n">Ind_YM_f</span><span class="p">[</span><span class="mi">1</span><span class="p">]]})</span>
    <span class="n">E_lsq_F_A2Ml</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">E_lsq_F_A2Ml</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;E&#39;</span><span class="p">,</span><span class="s1">&#39;E_abs&#39;</span><span class="p">,</span><span class="s1">&#39;Rquad&#39;</span><span class="p">,</span><span class="s1">&#39;Fit_result&#39;</span><span class="p">],</span>
                            <span class="n">name</span><span class="o">=</span><span class="s1">&#39;E_lsq_F_A2Ml&#39;</span><span class="p">)</span>
    
    <span class="n">E_lsq_F_A4Al</span> <span class="o">=</span> <span class="n">emeb</span><span class="o">.</span><span class="n">evaluation</span><span class="o">.</span><span class="n">YM_eva_method_A</span><span class="p">(</span><span class="n">stress_mid_ser</span><span class="o">=</span><span class="n">messu</span><span class="o">.</span><span class="n">Stress</span><span class="p">,</span>
                                    <span class="n">strain_mid_ser</span><span class="o">=</span><span class="n">messu</span><span class="o">.</span><span class="n">Strain_opt_c_A</span><span class="p">,</span>
                                    <span class="n">comp</span><span class="o">=</span><span class="n">_opts</span><span class="p">[</span><span class="s1">&#39;OPT_Compression&#39;</span><span class="p">],</span>
                                    <span class="n">name</span><span class="o">=</span><span class="s1">&#39;E_lsq_F_A4Al&#39;</span><span class="p">,</span> 
                                    <span class="n">det_opt</span><span class="o">=</span><span class="s1">&#39;leastsq&#39;</span><span class="p">,</span>
                                    <span class="o">**</span><span class="p">{</span><span class="s1">&#39;ind_S&#39;</span><span class="p">:</span><span class="n">VIP_dicu</span><span class="p">[</span><span class="n">Ind_YM_f</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span>
                                       <span class="s1">&#39;ind_E&#39;</span><span class="p">:</span><span class="n">VIP_dicu</span><span class="p">[</span><span class="n">Ind_YM_f</span><span class="p">[</span><span class="mi">1</span><span class="p">]]})</span>
    <span class="n">E_lsq_F_A4Al</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">E_lsq_F_A4Al</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;E&#39;</span><span class="p">,</span><span class="s1">&#39;E_abs&#39;</span><span class="p">,</span><span class="s1">&#39;Rquad&#39;</span><span class="p">,</span><span class="s1">&#39;Fit_result&#39;</span><span class="p">],</span>
                            <span class="n">name</span><span class="o">=</span><span class="s1">&#39;E_lsq_F_A4Al&#39;</span><span class="p">)</span>
    <span class="n">E_lsq_F_A4Sl</span> <span class="o">=</span> <span class="n">emeb</span><span class="o">.</span><span class="n">evaluation</span><span class="o">.</span><span class="n">YM_eva_method_A</span><span class="p">(</span><span class="n">stress_mid_ser</span><span class="o">=</span><span class="n">messu</span><span class="o">.</span><span class="n">Stress</span><span class="p">,</span>
                                    <span class="n">strain_mid_ser</span><span class="o">=</span><span class="n">messu</span><span class="o">.</span><span class="n">Strain_opt_c_S</span><span class="p">,</span>
                                    <span class="n">comp</span><span class="o">=</span><span class="n">_opts</span><span class="p">[</span><span class="s1">&#39;OPT_Compression&#39;</span><span class="p">],</span>
                                    <span class="n">name</span><span class="o">=</span><span class="s1">&#39;E_lsq_F_A4Sl&#39;</span><span class="p">,</span> 
                                    <span class="n">det_opt</span><span class="o">=</span><span class="s1">&#39;leastsq&#39;</span><span class="p">,</span>
                                    <span class="o">**</span><span class="p">{</span><span class="s1">&#39;ind_S&#39;</span><span class="p">:</span><span class="n">VIP_dicu</span><span class="p">[</span><span class="n">Ind_YM_f</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span>
                                       <span class="s1">&#39;ind_E&#39;</span><span class="p">:</span><span class="n">VIP_dicu</span><span class="p">[</span><span class="n">Ind_YM_f</span><span class="p">[</span><span class="mi">1</span><span class="p">]]})</span>
    <span class="n">E_lsq_F_A4Sl</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">E_lsq_F_A4Sl</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;E&#39;</span><span class="p">,</span><span class="s1">&#39;E_abs&#39;</span><span class="p">,</span><span class="s1">&#39;Rquad&#39;</span><span class="p">,</span><span class="s1">&#39;Fit_result&#39;</span><span class="p">],</span>
                            <span class="n">name</span><span class="o">=</span><span class="s1">&#39;E_lsq_F_A4Sl&#39;</span><span class="p">)</span>
    <span class="n">E_lsq_F_A4Ml</span> <span class="o">=</span> <span class="n">emeb</span><span class="o">.</span><span class="n">evaluation</span><span class="o">.</span><span class="n">YM_eva_method_A</span><span class="p">(</span><span class="n">stress_mid_ser</span><span class="o">=</span><span class="n">messu</span><span class="o">.</span><span class="n">Stress</span><span class="p">,</span>
                                    <span class="n">strain_mid_ser</span><span class="o">=</span><span class="n">messu</span><span class="o">.</span><span class="n">Strain_opt_c_M</span><span class="p">,</span>
                                    <span class="n">comp</span><span class="o">=</span><span class="n">_opts</span><span class="p">[</span><span class="s1">&#39;OPT_Compression&#39;</span><span class="p">],</span>
                                    <span class="n">name</span><span class="o">=</span><span class="s1">&#39;E_lsq_F_A4Ml&#39;</span><span class="p">,</span> 
                                    <span class="n">det_opt</span><span class="o">=</span><span class="s1">&#39;leastsq&#39;</span><span class="p">,</span>
                                    <span class="o">**</span><span class="p">{</span><span class="s1">&#39;ind_S&#39;</span><span class="p">:</span><span class="n">VIP_dicu</span><span class="p">[</span><span class="n">Ind_YM_f</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span>
                                       <span class="s1">&#39;ind_E&#39;</span><span class="p">:</span><span class="n">VIP_dicu</span><span class="p">[</span><span class="n">Ind_YM_f</span><span class="p">[</span><span class="mi">1</span><span class="p">]]})</span>
    <span class="n">E_lsq_F_A4Ml</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">E_lsq_F_A4Ml</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;E&#39;</span><span class="p">,</span><span class="s1">&#39;E_abs&#39;</span><span class="p">,</span><span class="s1">&#39;Rquad&#39;</span><span class="p">,</span><span class="s1">&#39;Fit_result&#39;</span><span class="p">],</span>
                            <span class="n">name</span><span class="o">=</span><span class="s1">&#39;E_lsq_F_A4Ml&#39;</span><span class="p">)</span>
    
    
    <span class="n">E_lsq_R_A0Al</span> <span class="o">=</span> <span class="n">emeb</span><span class="o">.</span><span class="n">evaluation</span><span class="o">.</span><span class="n">YM_eva_method_A</span><span class="p">(</span><span class="n">stress_mid_ser</span><span class="o">=</span><span class="n">messu</span><span class="o">.</span><span class="n">Stress</span><span class="p">,</span>
                                    <span class="n">strain_mid_ser</span><span class="o">=</span><span class="n">messu</span><span class="o">.</span><span class="n">Strain</span><span class="p">,</span>
                                    <span class="n">comp</span><span class="o">=</span><span class="n">_opts</span><span class="p">[</span><span class="s1">&#39;OPT_Compression&#39;</span><span class="p">],</span>
                                    <span class="n">name</span><span class="o">=</span><span class="s1">&#39;E_lsq_R_A0Al&#39;</span><span class="p">,</span> 
                                    <span class="n">det_opt</span><span class="o">=</span><span class="s1">&#39;leastsq&#39;</span><span class="p">,</span>
                                    <span class="o">**</span><span class="p">{</span><span class="s1">&#39;ind_S&#39;</span><span class="p">:</span><span class="n">VIP_messu</span><span class="p">[</span><span class="n">Ind_YM_r</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span>
                                       <span class="s1">&#39;ind_E&#39;</span><span class="p">:</span><span class="n">VIP_messu</span><span class="p">[</span><span class="n">Ind_YM_r</span><span class="p">[</span><span class="mi">1</span><span class="p">]]})</span>
    <span class="n">E_lsq_R_A0Al</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">E_lsq_R_A0Al</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;E&#39;</span><span class="p">,</span><span class="s1">&#39;E_abs&#39;</span><span class="p">,</span><span class="s1">&#39;Rquad&#39;</span><span class="p">,</span><span class="s1">&#39;Fit_result&#39;</span><span class="p">],</span>
                            <span class="n">name</span><span class="o">=</span><span class="s1">&#39;E_lsq_R_A0Al&#39;</span><span class="p">)</span>
    
    <span class="n">E_lsq_R_A2Al</span> <span class="o">=</span> <span class="n">emeb</span><span class="o">.</span><span class="n">evaluation</span><span class="o">.</span><span class="n">YM_eva_method_A</span><span class="p">(</span><span class="n">stress_mid_ser</span><span class="o">=</span><span class="n">messu</span><span class="o">.</span><span class="n">Stress</span><span class="p">,</span>
                                    <span class="n">strain_mid_ser</span><span class="o">=</span><span class="n">messu</span><span class="o">.</span><span class="n">Strain_opt_d_A</span><span class="p">,</span>
                                    <span class="n">comp</span><span class="o">=</span><span class="n">_opts</span><span class="p">[</span><span class="s1">&#39;OPT_Compression&#39;</span><span class="p">],</span>
                                    <span class="n">name</span><span class="o">=</span><span class="s1">&#39;E_lsq_R_A2Al&#39;</span><span class="p">,</span> 
                                    <span class="n">det_opt</span><span class="o">=</span><span class="s1">&#39;leastsq&#39;</span><span class="p">,</span>
                                    <span class="o">**</span><span class="p">{</span><span class="s1">&#39;ind_S&#39;</span><span class="p">:</span><span class="n">VIP_dicu</span><span class="p">[</span><span class="n">Ind_YM_r</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span>
                                       <span class="s1">&#39;ind_E&#39;</span><span class="p">:</span><span class="n">VIP_dicu</span><span class="p">[</span><span class="n">Ind_YM_r</span><span class="p">[</span><span class="mi">1</span><span class="p">]]})</span>
    <span class="n">E_lsq_R_A2Al</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">E_lsq_R_A2Al</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;E&#39;</span><span class="p">,</span><span class="s1">&#39;E_abs&#39;</span><span class="p">,</span><span class="s1">&#39;Rquad&#39;</span><span class="p">,</span><span class="s1">&#39;Fit_result&#39;</span><span class="p">],</span>
                            <span class="n">name</span><span class="o">=</span><span class="s1">&#39;E_lsq_R_A2Al&#39;</span><span class="p">)</span>
    <span class="n">E_lsq_R_A2Sl</span> <span class="o">=</span> <span class="n">emeb</span><span class="o">.</span><span class="n">evaluation</span><span class="o">.</span><span class="n">YM_eva_method_A</span><span class="p">(</span><span class="n">stress_mid_ser</span><span class="o">=</span><span class="n">messu</span><span class="o">.</span><span class="n">Stress</span><span class="p">,</span>
                                    <span class="n">strain_mid_ser</span><span class="o">=</span><span class="n">messu</span><span class="o">.</span><span class="n">Strain_opt_d_S</span><span class="p">,</span>
                                    <span class="n">comp</span><span class="o">=</span><span class="n">_opts</span><span class="p">[</span><span class="s1">&#39;OPT_Compression&#39;</span><span class="p">],</span>
                                    <span class="n">name</span><span class="o">=</span><span class="s1">&#39;E_lsq_R_A2Sl&#39;</span><span class="p">,</span> 
                                    <span class="n">det_opt</span><span class="o">=</span><span class="s1">&#39;leastsq&#39;</span><span class="p">,</span>
                                    <span class="o">**</span><span class="p">{</span><span class="s1">&#39;ind_S&#39;</span><span class="p">:</span><span class="n">VIP_dicu</span><span class="p">[</span><span class="n">Ind_YM_r</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span>
                                       <span class="s1">&#39;ind_E&#39;</span><span class="p">:</span><span class="n">VIP_dicu</span><span class="p">[</span><span class="n">Ind_YM_r</span><span class="p">[</span><span class="mi">1</span><span class="p">]]})</span>
    <span class="n">E_lsq_R_A2Sl</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">E_lsq_R_A2Sl</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;E&#39;</span><span class="p">,</span><span class="s1">&#39;E_abs&#39;</span><span class="p">,</span><span class="s1">&#39;Rquad&#39;</span><span class="p">,</span><span class="s1">&#39;Fit_result&#39;</span><span class="p">],</span>
                            <span class="n">name</span><span class="o">=</span><span class="s1">&#39;E_lsq_R_A2Sl&#39;</span><span class="p">)</span>
    <span class="n">E_lsq_R_A2Ml</span> <span class="o">=</span> <span class="n">emeb</span><span class="o">.</span><span class="n">evaluation</span><span class="o">.</span><span class="n">YM_eva_method_A</span><span class="p">(</span><span class="n">stress_mid_ser</span><span class="o">=</span><span class="n">messu</span><span class="o">.</span><span class="n">Stress</span><span class="p">,</span>
                                    <span class="n">strain_mid_ser</span><span class="o">=</span><span class="n">messu</span><span class="o">.</span><span class="n">Strain_opt_d_M</span><span class="p">,</span>
                                    <span class="n">comp</span><span class="o">=</span><span class="n">_opts</span><span class="p">[</span><span class="s1">&#39;OPT_Compression&#39;</span><span class="p">],</span>
                                    <span class="n">name</span><span class="o">=</span><span class="s1">&#39;E_lsq_R_A2Ml&#39;</span><span class="p">,</span> 
                                    <span class="n">det_opt</span><span class="o">=</span><span class="s1">&#39;leastsq&#39;</span><span class="p">,</span>
                                    <span class="o">**</span><span class="p">{</span><span class="s1">&#39;ind_S&#39;</span><span class="p">:</span><span class="n">VIP_dicu</span><span class="p">[</span><span class="n">Ind_YM_r</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span>
                                       <span class="s1">&#39;ind_E&#39;</span><span class="p">:</span><span class="n">VIP_dicu</span><span class="p">[</span><span class="n">Ind_YM_r</span><span class="p">[</span><span class="mi">1</span><span class="p">]]})</span>
    <span class="n">E_lsq_R_A2Ml</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">E_lsq_R_A2Ml</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;E&#39;</span><span class="p">,</span><span class="s1">&#39;E_abs&#39;</span><span class="p">,</span><span class="s1">&#39;Rquad&#39;</span><span class="p">,</span><span class="s1">&#39;Fit_result&#39;</span><span class="p">],</span>
                            <span class="n">name</span><span class="o">=</span><span class="s1">&#39;E_lsq_R_A2Ml&#39;</span><span class="p">)</span>
    
    <span class="n">E_lsq_R_A4Al</span> <span class="o">=</span> <span class="n">emeb</span><span class="o">.</span><span class="n">evaluation</span><span class="o">.</span><span class="n">YM_eva_method_A</span><span class="p">(</span><span class="n">stress_mid_ser</span><span class="o">=</span><span class="n">messu</span><span class="o">.</span><span class="n">Stress</span><span class="p">,</span>
                                    <span class="n">strain_mid_ser</span><span class="o">=</span><span class="n">messu</span><span class="o">.</span><span class="n">Strain_opt_c_A</span><span class="p">,</span>
                                    <span class="n">comp</span><span class="o">=</span><span class="n">_opts</span><span class="p">[</span><span class="s1">&#39;OPT_Compression&#39;</span><span class="p">],</span>
                                    <span class="n">name</span><span class="o">=</span><span class="s1">&#39;E_lsq_R_A4Al&#39;</span><span class="p">,</span> 
                                    <span class="n">det_opt</span><span class="o">=</span><span class="s1">&#39;leastsq&#39;</span><span class="p">,</span>
                                    <span class="o">**</span><span class="p">{</span><span class="s1">&#39;ind_S&#39;</span><span class="p">:</span><span class="n">VIP_dicu</span><span class="p">[</span><span class="n">Ind_YM_r</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span>
                                       <span class="s1">&#39;ind_E&#39;</span><span class="p">:</span><span class="n">VIP_dicu</span><span class="p">[</span><span class="n">Ind_YM_r</span><span class="p">[</span><span class="mi">1</span><span class="p">]]})</span>
    <span class="n">E_lsq_R_A4Al</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">E_lsq_R_A4Al</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;E&#39;</span><span class="p">,</span><span class="s1">&#39;E_abs&#39;</span><span class="p">,</span><span class="s1">&#39;Rquad&#39;</span><span class="p">,</span><span class="s1">&#39;Fit_result&#39;</span><span class="p">],</span>
                            <span class="n">name</span><span class="o">=</span><span class="s1">&#39;E_lsq_R_A4Al&#39;</span><span class="p">)</span>
    <span class="n">E_lsq_R_A4Sl</span> <span class="o">=</span> <span class="n">emeb</span><span class="o">.</span><span class="n">evaluation</span><span class="o">.</span><span class="n">YM_eva_method_A</span><span class="p">(</span><span class="n">stress_mid_ser</span><span class="o">=</span><span class="n">messu</span><span class="o">.</span><span class="n">Stress</span><span class="p">,</span>
                                    <span class="n">strain_mid_ser</span><span class="o">=</span><span class="n">messu</span><span class="o">.</span><span class="n">Strain_opt_c_S</span><span class="p">,</span>
                                    <span class="n">comp</span><span class="o">=</span><span class="n">_opts</span><span class="p">[</span><span class="s1">&#39;OPT_Compression&#39;</span><span class="p">],</span>
                                    <span class="n">name</span><span class="o">=</span><span class="s1">&#39;E_lsq_R_A4Sl&#39;</span><span class="p">,</span> 
                                    <span class="n">det_opt</span><span class="o">=</span><span class="s1">&#39;leastsq&#39;</span><span class="p">,</span>
                                    <span class="o">**</span><span class="p">{</span><span class="s1">&#39;ind_S&#39;</span><span class="p">:</span><span class="n">VIP_dicu</span><span class="p">[</span><span class="n">Ind_YM_r</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span>
                                       <span class="s1">&#39;ind_E&#39;</span><span class="p">:</span><span class="n">VIP_dicu</span><span class="p">[</span><span class="n">Ind_YM_r</span><span class="p">[</span><span class="mi">1</span><span class="p">]]})</span>
    <span class="n">E_lsq_R_A4Sl</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">E_lsq_R_A4Sl</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;E&#39;</span><span class="p">,</span><span class="s1">&#39;E_abs&#39;</span><span class="p">,</span><span class="s1">&#39;Rquad&#39;</span><span class="p">,</span><span class="s1">&#39;Fit_result&#39;</span><span class="p">],</span>
                            <span class="n">name</span><span class="o">=</span><span class="s1">&#39;E_lsq_R_A4Sl&#39;</span><span class="p">)</span>
    <span class="n">E_lsq_R_A4Ml</span> <span class="o">=</span> <span class="n">emeb</span><span class="o">.</span><span class="n">evaluation</span><span class="o">.</span><span class="n">YM_eva_method_A</span><span class="p">(</span><span class="n">stress_mid_ser</span><span class="o">=</span><span class="n">messu</span><span class="o">.</span><span class="n">Stress</span><span class="p">,</span>
                                    <span class="n">strain_mid_ser</span><span class="o">=</span><span class="n">messu</span><span class="o">.</span><span class="n">Strain_opt_c_M</span><span class="p">,</span>
                                    <span class="n">comp</span><span class="o">=</span><span class="n">_opts</span><span class="p">[</span><span class="s1">&#39;OPT_Compression&#39;</span><span class="p">],</span>
                                    <span class="n">name</span><span class="o">=</span><span class="s1">&#39;E_lsq_R_A4Ml&#39;</span><span class="p">,</span> 
                                    <span class="n">det_opt</span><span class="o">=</span><span class="s1">&#39;leastsq&#39;</span><span class="p">,</span>
                                    <span class="o">**</span><span class="p">{</span><span class="s1">&#39;ind_S&#39;</span><span class="p">:</span><span class="n">VIP_dicu</span><span class="p">[</span><span class="n">Ind_YM_r</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span>
                                       <span class="s1">&#39;ind_E&#39;</span><span class="p">:</span><span class="n">VIP_dicu</span><span class="p">[</span><span class="n">Ind_YM_r</span><span class="p">[</span><span class="mi">1</span><span class="p">]]})</span>
    <span class="n">E_lsq_R_A4Ml</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">E_lsq_R_A4Ml</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;E&#39;</span><span class="p">,</span><span class="s1">&#39;E_abs&#39;</span><span class="p">,</span><span class="s1">&#39;Rquad&#39;</span><span class="p">,</span><span class="s1">&#39;Fit_result&#39;</span><span class="p">],</span>
                            <span class="n">name</span><span class="o">=</span><span class="s1">&#39;E_lsq_R_A4Ml&#39;</span><span class="p">)</span>

    <span class="n">E_lsq_A</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">E_lsq_F_A0Al</span><span class="p">,</span>
                         <span class="n">E_lsq_F_A2Al</span><span class="p">,</span> <span class="n">E_lsq_F_A2Sl</span><span class="p">,</span> <span class="n">E_lsq_F_A2Ml</span><span class="p">,</span>
                         <span class="n">E_lsq_F_A4Al</span><span class="p">,</span> <span class="n">E_lsq_F_A4Sl</span><span class="p">,</span> <span class="n">E_lsq_F_A4Ml</span><span class="p">,</span>
                         <span class="n">E_lsq_R_A0Al</span><span class="p">,</span>
                         <span class="n">E_lsq_R_A2Al</span><span class="p">,</span> <span class="n">E_lsq_R_A2Sl</span><span class="p">,</span> <span class="n">E_lsq_R_A2Ml</span><span class="p">,</span>
                         <span class="n">E_lsq_R_A4Al</span><span class="p">,</span> <span class="n">E_lsq_R_A4Sl</span><span class="p">,</span> <span class="n">E_lsq_R_A4Ml</span><span class="p">],</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

    <span class="k">del</span> <span class="n">A0Al_ser</span><span class="p">,</span> <span class="n">A2Al_ser</span><span class="p">,</span> <span class="n">A2Sl_ser</span><span class="p">,</span> <span class="n">A2Ml_ser</span><span class="p">,</span> <span class="n">A4Al_ser</span><span class="p">,</span> <span class="n">A4Sl_ser</span><span class="p">,</span> <span class="n">A4Ml_ser</span>
    <span class="k">del</span> <span class="n">E_lsq_F_A0Al</span><span class="p">,</span> <span class="n">E_lsq_F_A2Al</span><span class="p">,</span> <span class="n">E_lsq_F_A2Sl</span><span class="p">,</span> <span class="n">E_lsq_F_A2Ml</span><span class="p">,</span> <span class="n">E_lsq_F_A4Al</span><span class="p">,</span> <span class="n">E_lsq_F_A4Sl</span><span class="p">,</span> <span class="n">E_lsq_F_A4Ml</span>
    <span class="k">del</span> <span class="n">E_lsq_R_A0Al</span><span class="p">,</span> <span class="n">E_lsq_R_A2Al</span><span class="p">,</span> <span class="n">E_lsq_R_A2Sl</span><span class="p">,</span> <span class="n">E_lsq_R_A2Ml</span><span class="p">,</span> <span class="n">E_lsq_R_A4Al</span><span class="p">,</span> <span class="n">E_lsq_R_A4Sl</span><span class="p">,</span> <span class="n">E_lsq_R_A4Ml</span>
    
    <span class="c1">#%%%% 6.4.2 Method B</span>
    <span class="n">timings</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mf">6.42</span><span class="p">]</span><span class="o">=</span><span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span>
    <span class="n">log_custom</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">   Timing </span><span class="si">%f</span><span class="s2">: </span><span class="si">%.5f</span><span class="s2"> s&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">timings</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span>
                                       <span class="n">timings</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">timings</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span>
                   <span class="o">**</span><span class="n">log_scopt</span><span class="p">)</span>
    <span class="n">B1Al_ser</span><span class="p">,</span> <span class="n">B1Al_strain_ser</span> <span class="o">=</span> <span class="n">emeb</span><span class="o">.</span><span class="n">evaluation</span><span class="o">.</span><span class="n">YM_eva_method_B</span><span class="p">(</span><span class="n">option</span><span class="o">=</span><span class="s2">&quot;Points&quot;</span><span class="p">,</span> 
                                                     <span class="n">stress_mid_ser</span><span class="o">=</span><span class="n">d_stress_mid</span><span class="p">,</span>
                                                     <span class="n">thickness</span> <span class="o">=</span> <span class="n">func_t</span><span class="p">(</span><span class="mf">0.0</span><span class="p">),</span> 
                                                     <span class="n">Length</span> <span class="o">=</span> <span class="n">Length</span><span class="p">,</span>
                                                     <span class="n">P_df</span> <span class="o">=</span> <span class="n">P_xcoord_ydiff_meas</span><span class="p">,</span> 
                                                     <span class="n">P_fork_names</span> <span class="o">=</span> <span class="n">_opts</span><span class="p">[</span><span class="s1">&#39;OPT_DIC_Points_meas_fork&#39;</span><span class="p">],</span>
                                                     <span class="n">comp</span><span class="o">=</span><span class="n">_opts</span><span class="p">[</span><span class="s1">&#39;OPT_Compression&#39;</span><span class="p">],</span>
                                                     <span class="n">name</span><span class="o">=</span><span class="s1">&#39;B1Al&#39;</span><span class="p">)</span>
    <span class="n">B1Sl_ser</span><span class="p">,</span> <span class="n">B1Sl_strain_ser</span> <span class="o">=</span> <span class="n">emeb</span><span class="o">.</span><span class="n">evaluation</span><span class="o">.</span><span class="n">YM_eva_method_B</span><span class="p">(</span><span class="n">option</span><span class="o">=</span><span class="s2">&quot;Points&quot;</span><span class="p">,</span>
                                                     <span class="n">stress_mid_ser</span><span class="o">=</span><span class="n">d_stress_mid</span><span class="p">,</span>
                                                     <span class="n">thickness</span> <span class="o">=</span> <span class="n">func_t</span><span class="p">(</span><span class="mf">0.0</span><span class="p">),</span> 
                                                     <span class="n">Length</span> <span class="o">=</span> <span class="n">Length</span><span class="p">,</span>
                                                     <span class="n">P_df</span> <span class="o">=</span> <span class="n">P_xcoord_ydiff_meas_S</span><span class="p">,</span> 
                                                     <span class="n">P_fork_names</span> <span class="o">=</span> <span class="n">_opts</span><span class="p">[</span><span class="s1">&#39;OPT_DIC_Points_meas_fork&#39;</span><span class="p">],</span>
                                                     <span class="n">comp</span><span class="o">=</span><span class="n">_opts</span><span class="p">[</span><span class="s1">&#39;OPT_Compression&#39;</span><span class="p">],</span>
                                                     <span class="n">name</span><span class="o">=</span><span class="s1">&#39;B1Sl&#39;</span><span class="p">)</span>
    <span class="n">B1Ml_ser</span><span class="p">,</span> <span class="n">B1Ml_strain_ser</span> <span class="o">=</span> <span class="n">emeb</span><span class="o">.</span><span class="n">evaluation</span><span class="o">.</span><span class="n">YM_eva_method_B</span><span class="p">(</span><span class="n">option</span><span class="o">=</span><span class="s2">&quot;Points&quot;</span><span class="p">,</span>
                                                     <span class="n">stress_mid_ser</span><span class="o">=</span><span class="n">d_stress_mid</span><span class="p">,</span>
                                                     <span class="n">thickness</span> <span class="o">=</span> <span class="n">func_t</span><span class="p">(</span><span class="mf">0.0</span><span class="p">),</span> 
                                                     <span class="n">Length</span> <span class="o">=</span> <span class="n">Length</span><span class="p">,</span>
                                                     <span class="n">P_df</span> <span class="o">=</span> <span class="n">P_xcoord_ydiff_meas_M</span><span class="p">,</span> 
                                                     <span class="n">P_fork_names</span> <span class="o">=</span> <span class="n">_opts</span><span class="p">[</span><span class="s1">&#39;OPT_DIC_Points_meas_fork&#39;</span><span class="p">],</span>
                                                     <span class="n">comp</span><span class="o">=</span><span class="n">_opts</span><span class="p">[</span><span class="s1">&#39;OPT_Compression&#39;</span><span class="p">],</span>
                                                     <span class="n">name</span><span class="o">=</span><span class="s1">&#39;B1Ml&#39;</span><span class="p">)</span>
    
    
    <span class="n">B2Al_ser</span><span class="p">,</span> <span class="n">B2Al_strain_ser</span> <span class="o">=</span> <span class="n">emeb</span><span class="o">.</span><span class="n">evaluation</span><span class="o">.</span><span class="n">YM_eva_method_B</span><span class="p">(</span><span class="n">option</span><span class="o">=</span><span class="s2">&quot;Fit&quot;</span><span class="p">,</span>
                                                     <span class="n">stress_mid_ser</span><span class="o">=</span><span class="n">d_stress_mid</span><span class="p">,</span>
                                                     <span class="n">thickness</span> <span class="o">=</span> <span class="n">func_t</span><span class="p">(</span><span class="mf">0.0</span><span class="p">),</span>
                                                     <span class="n">Length</span><span class="o">=</span><span class="n">Length</span><span class="p">,</span>
                                                     <span class="n">w_func</span><span class="o">=</span><span class="n">bl</span><span class="p">[</span><span class="s1">&#39;w_A&#39;</span><span class="p">][</span><span class="s1">&#39;d0&#39;</span><span class="p">],</span>
                                                     <span class="n">w_params</span><span class="o">=</span><span class="n">Pre_inc_fit_df</span><span class="o">.</span><span class="n">loc</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)[</span><span class="s1">&#39;Fit_params_dict&#39;</span><span class="p">],</span>
                                                     <span class="n">Length_det</span><span class="o">=</span><span class="mf">10.0</span><span class="p">,</span>
                                                     <span class="n">comp</span><span class="o">=</span><span class="n">_opts</span><span class="p">[</span><span class="s1">&#39;OPT_Compression&#39;</span><span class="p">],</span>
                                                     <span class="n">name</span><span class="o">=</span><span class="s1">&#39;B2Al&#39;</span><span class="p">)</span>
    <span class="n">B2Sl_ser</span><span class="p">,</span> <span class="n">B2Sl_strain_ser</span> <span class="o">=</span> <span class="n">emeb</span><span class="o">.</span><span class="n">evaluation</span><span class="o">.</span><span class="n">YM_eva_method_B</span><span class="p">(</span><span class="n">option</span><span class="o">=</span><span class="s2">&quot;Fit&quot;</span><span class="p">,</span> 
                                                     <span class="n">stress_mid_ser</span><span class="o">=</span><span class="n">d_stress_mid</span><span class="p">,</span>
                                                     <span class="n">thickness</span> <span class="o">=</span> <span class="n">func_t</span><span class="p">(</span><span class="mf">0.0</span><span class="p">),</span>
                                                     <span class="n">Length</span><span class="o">=</span><span class="n">Length</span><span class="p">,</span>
                                                     <span class="n">w_func</span><span class="o">=</span><span class="n">bl</span><span class="p">[</span><span class="s1">&#39;w_S&#39;</span><span class="p">][</span><span class="s1">&#39;d0&#39;</span><span class="p">],</span>
                                                     <span class="n">w_params</span><span class="o">=</span><span class="n">Pre_inc_fit_df</span><span class="o">.</span><span class="n">loc</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)[</span><span class="s1">&#39;Fit_params_dict&#39;</span><span class="p">],</span>
                                                     <span class="n">Length_det</span><span class="o">=</span><span class="mf">10.0</span><span class="p">,</span> 
                                                     <span class="n">comp</span><span class="o">=</span><span class="n">_opts</span><span class="p">[</span><span class="s1">&#39;OPT_Compression&#39;</span><span class="p">],</span>
                                                     <span class="n">name</span><span class="o">=</span><span class="s1">&#39;B2Sl&#39;</span><span class="p">)</span>
    <span class="n">B2Ml_ser</span><span class="p">,</span> <span class="n">B2Ml_strain_ser</span> <span class="o">=</span> <span class="n">emeb</span><span class="o">.</span><span class="n">evaluation</span><span class="o">.</span><span class="n">YM_eva_method_B</span><span class="p">(</span><span class="n">option</span><span class="o">=</span><span class="s2">&quot;Fit&quot;</span><span class="p">,</span> 
                                                     <span class="n">stress_mid_ser</span><span class="o">=</span><span class="n">d_stress_mid</span><span class="p">,</span>
                                                     <span class="n">thickness</span> <span class="o">=</span> <span class="n">func_t</span><span class="p">(</span><span class="mf">0.0</span><span class="p">),</span> 
                                                     <span class="n">Length</span><span class="o">=</span><span class="n">Length</span><span class="p">,</span>
                                                     <span class="n">w_func</span><span class="o">=</span><span class="n">bl</span><span class="p">[</span><span class="s1">&#39;w_M&#39;</span><span class="p">][</span><span class="s1">&#39;d0&#39;</span><span class="p">],</span>
                                                     <span class="n">w_params</span><span class="o">=</span><span class="n">Bend_inc_fit_df</span><span class="o">.</span><span class="n">loc</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)[</span><span class="s1">&#39;Fit_params_dict&#39;</span><span class="p">],</span>
                                                     <span class="n">Length_det</span><span class="o">=</span><span class="mf">10.0</span><span class="p">,</span> 
                                                     <span class="n">comp</span> <span class="o">=</span> <span class="n">_opts</span><span class="p">[</span><span class="s1">&#39;OPT_Compression&#39;</span><span class="p">],</span>
                                                     <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;B2Ml&#39;</span><span class="p">)</span>
    
    
    <span class="n">E_B_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">B1Al_ser</span><span class="p">,</span><span class="n">B1Sl_ser</span><span class="p">,</span><span class="n">B1Ml_ser</span><span class="p">,</span>
                        <span class="n">B2Al_ser</span><span class="p">,</span><span class="n">B2Sl_ser</span><span class="p">,</span><span class="n">B2Ml_ser</span><span class="p">],</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">E_B</span> <span class="o">=</span> <span class="n">emec</span><span class="o">.</span><span class="n">stat_ext</span><span class="o">.</span><span class="n">pd_agg</span><span class="p">(</span><span class="n">E_B_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">sr_eva_dic</span><span class="p">])</span>
    
    <span class="k">if</span> <span class="kc">True</span><span class="p">:</span>
        <span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="n">ax1</span><span class="p">,</span><span class="n">ax2</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> 
                                      <span class="n">sharex</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> 
                                      <span class="n">figsize</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">figsize</span><span class="p">,[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">]))</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1"> - Compare method B&#39;</span><span class="o">%</span><span class="p">(</span><span class="n">plt_name</span><span class="p">))</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;All Steps&#39;</span><span class="p">)</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Step / -&#39;</span><span class="p">)</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;E / MPa&#39;</span><span class="p">)</span>
        <span class="n">cc</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;B1Al&#39;</span><span class="p">:</span><span class="s1">&#39;r:&#39;</span><span class="p">,</span><span class="s1">&#39;B1Sl&#39;</span><span class="p">:</span><span class="s1">&#39;b:&#39;</span><span class="p">,</span><span class="s1">&#39;B1Ml&#39;</span><span class="p">:</span><span class="s1">&#39;g:&#39;</span><span class="p">,</span><span class="s1">&#39;B2Al&#39;</span><span class="p">:</span><span class="s1">&#39;r--&#39;</span><span class="p">,</span><span class="s1">&#39;B2Sl&#39;</span><span class="p">:</span><span class="s1">&#39;b--&#39;</span><span class="p">,</span><span class="s1">&#39;B2Ml&#39;</span><span class="p">:</span><span class="s1">&#39;g--&#39;</span><span class="p">}</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">cc</span><span class="p">:</span>
            <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">E_B_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:</span><span class="n">VIP_messu</span><span class="p">[</span><span class="s1">&#39;U&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">index</span><span class="p">,</span>
                     <span class="n">E_B_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:</span><span class="n">VIP_messu</span><span class="p">[</span><span class="s1">&#39;U&#39;</span><span class="p">]][</span><span class="n">k</span><span class="p">],</span>
                     <span class="n">cc</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1"> - </span><span class="si">%.2f</span><span class="s1"> MPa&#39;</span><span class="o">%</span><span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="n">E_B</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="s1">&#39;mean&#39;</span><span class="p">,</span><span class="n">k</span><span class="p">]))</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">VIP_dicu</span><span class="p">[</span><span class="s1">&#39;F3&#39;</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;olive&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">)</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">VIP_dicu</span><span class="p">[</span><span class="s1">&#39;F4&#39;</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;olive&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
        <span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Improved determination range&#39;</span><span class="p">)</span>
        <span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Step / -&#39;</span><span class="p">)</span>
        <span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;E / MPa&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">cc</span><span class="p">:</span>
            <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">sr_eva_dic</span><span class="p">,</span> <span class="n">E_B_df</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">sr_eva_dic</span><span class="p">],</span> <span class="n">cc</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
        <span class="n">plt_hsuf</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span><span class="n">path</span><span class="o">=</span><span class="n">out_full</span><span class="o">+</span><span class="s2">&quot;-YM-Me_B&quot;</span><span class="p">,</span><span class="o">**</span><span class="n">plt_scopt</span><span class="p">)</span>
        
    <span class="c1"># least-square-fit</span>
    <span class="n">E_lsq_F_B1Al</span> <span class="o">=</span> <span class="n">emeb</span><span class="o">.</span><span class="n">evaluation</span><span class="o">.</span><span class="n">YM_eva_method_B</span><span class="p">(</span><span class="n">option</span><span class="o">=</span><span class="s2">&quot;Points&quot;</span><span class="p">,</span>
                                 <span class="n">stress_mid_ser</span><span class="o">=</span><span class="n">messu</span><span class="o">.</span><span class="n">Stress</span><span class="p">,</span>
                                 <span class="n">thickness</span> <span class="o">=</span> <span class="n">func_t</span><span class="p">(</span><span class="mf">0.0</span><span class="p">),</span>
                                 <span class="n">Length</span> <span class="o">=</span> <span class="n">Length</span><span class="p">,</span>
                                 <span class="n">P_df</span> <span class="o">=</span> <span class="n">P_xcoord_ydisp_meas</span><span class="p">,</span>
                                 <span class="n">P_fork_names</span> <span class="o">=</span> <span class="n">_opts</span><span class="p">[</span><span class="s1">&#39;OPT_DIC_Points_meas_fork&#39;</span><span class="p">],</span>
                                 <span class="n">comp</span> <span class="o">=</span> <span class="n">_opts</span><span class="p">[</span><span class="s1">&#39;OPT_Compression&#39;</span><span class="p">],</span>
                                 <span class="n">name</span><span class="o">=</span><span class="s1">&#39;E_lsq_F_B1Al&#39;</span><span class="p">,</span>
                                 <span class="n">det_opt</span><span class="o">=</span><span class="s1">&#39;leastsq&#39;</span><span class="p">,</span>
                                 <span class="o">**</span><span class="p">{</span><span class="s1">&#39;ind_S&#39;</span><span class="p">:</span><span class="n">VIP_dicu</span><span class="p">[</span><span class="n">Ind_YM_f</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span>
                                    <span class="s1">&#39;ind_E&#39;</span><span class="p">:</span><span class="n">VIP_dicu</span><span class="p">[</span><span class="n">Ind_YM_f</span><span class="p">[</span><span class="mi">1</span><span class="p">]]})</span>
    <span class="n">E_lsq_F_B1Al</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">E_lsq_F_B1Al</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;E&#39;</span><span class="p">,</span><span class="s1">&#39;E_abs&#39;</span><span class="p">,</span><span class="s1">&#39;Rquad&#39;</span><span class="p">,</span><span class="s1">&#39;Fit_result&#39;</span><span class="p">,</span><span class="s1">&#39;strain&#39;</span><span class="p">],</span>
                        <span class="n">name</span><span class="o">=</span><span class="s1">&#39;E_lsq_F_B1Al&#39;</span><span class="p">)</span>
    
    <span class="n">E_lsq_F_B1Sl</span> <span class="o">=</span> <span class="n">emeb</span><span class="o">.</span><span class="n">evaluation</span><span class="o">.</span><span class="n">YM_eva_method_B</span><span class="p">(</span><span class="n">option</span><span class="o">=</span><span class="s2">&quot;Points&quot;</span><span class="p">,</span>
                                 <span class="n">stress_mid_ser</span><span class="o">=</span><span class="n">messu</span><span class="o">.</span><span class="n">Stress</span><span class="p">,</span>
                                 <span class="n">thickness</span> <span class="o">=</span> <span class="n">func_t</span><span class="p">(</span><span class="mf">0.0</span><span class="p">),</span>
                                 <span class="n">Length</span><span class="o">=</span><span class="n">Length</span><span class="p">,</span>
                                 <span class="n">P_df</span> <span class="o">=</span> <span class="n">P_xcoord_ydisp_meas_S</span><span class="p">,</span>
                                 <span class="n">P_fork_names</span> <span class="o">=</span> <span class="n">_opts</span><span class="p">[</span><span class="s1">&#39;OPT_DIC_Points_meas_fork&#39;</span><span class="p">],</span>
                                 <span class="n">comp</span><span class="o">=</span><span class="n">_opts</span><span class="p">[</span><span class="s1">&#39;OPT_Compression&#39;</span><span class="p">],</span>
                                 <span class="n">name</span><span class="o">=</span><span class="s1">&#39;E_lsq_F_B1Sl&#39;</span><span class="p">,</span>
                                 <span class="n">det_opt</span><span class="o">=</span><span class="s1">&#39;leastsq&#39;</span><span class="p">,</span>
                                 <span class="o">**</span><span class="p">{</span><span class="s1">&#39;ind_S&#39;</span><span class="p">:</span><span class="n">VIP_dicu</span><span class="p">[</span><span class="n">Ind_YM_f</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span>
                                    <span class="s1">&#39;ind_E&#39;</span><span class="p">:</span><span class="n">VIP_dicu</span><span class="p">[</span><span class="n">Ind_YM_f</span><span class="p">[</span><span class="mi">1</span><span class="p">]]})</span>
    <span class="n">E_lsq_F_B1Sl</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">E_lsq_F_B1Sl</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;E&#39;</span><span class="p">,</span><span class="s1">&#39;E_abs&#39;</span><span class="p">,</span><span class="s1">&#39;Rquad&#39;</span><span class="p">,</span><span class="s1">&#39;Fit_result&#39;</span><span class="p">,</span><span class="s1">&#39;strain&#39;</span><span class="p">],</span>
                        <span class="n">name</span><span class="o">=</span><span class="s1">&#39;E_lsq_F_B1Sl&#39;</span><span class="p">)</span>
    <span class="n">E_lsq_F_B1Ml</span> <span class="o">=</span> <span class="n">emeb</span><span class="o">.</span><span class="n">evaluation</span><span class="o">.</span><span class="n">YM_eva_method_B</span><span class="p">(</span><span class="n">option</span><span class="o">=</span><span class="s2">&quot;Points&quot;</span><span class="p">,</span>
                                 <span class="n">stress_mid_ser</span><span class="o">=</span><span class="n">messu</span><span class="o">.</span><span class="n">Stress</span><span class="p">,</span>
                                 <span class="n">thickness</span> <span class="o">=</span> <span class="n">func_t</span><span class="p">(</span><span class="mf">0.0</span><span class="p">),</span>
                                 <span class="n">Length</span><span class="o">=</span><span class="n">Length</span><span class="p">,</span>
                                 <span class="n">P_df</span> <span class="o">=</span> <span class="n">P_xcoord_ydisp_meas_M</span><span class="p">,</span>
                                 <span class="n">P_fork_names</span> <span class="o">=</span> <span class="n">_opts</span><span class="p">[</span><span class="s1">&#39;OPT_DIC_Points_meas_fork&#39;</span><span class="p">],</span>
                                 <span class="n">comp</span><span class="o">=</span><span class="n">_opts</span><span class="p">[</span><span class="s1">&#39;OPT_Compression&#39;</span><span class="p">],</span>
                                 <span class="n">name</span><span class="o">=</span><span class="s1">&#39;E_lsq_F_B1Ml&#39;</span><span class="p">,</span>
                                 <span class="n">det_opt</span><span class="o">=</span><span class="s1">&#39;leastsq&#39;</span><span class="p">,</span>
                                 <span class="o">**</span><span class="p">{</span><span class="s1">&#39;ind_S&#39;</span><span class="p">:</span><span class="n">VIP_dicu</span><span class="p">[</span><span class="n">Ind_YM_f</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span>
                                    <span class="s1">&#39;ind_E&#39;</span><span class="p">:</span><span class="n">VIP_dicu</span><span class="p">[</span><span class="n">Ind_YM_f</span><span class="p">[</span><span class="mi">1</span><span class="p">]]})</span>
    <span class="n">E_lsq_F_B1Ml</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">E_lsq_F_B1Ml</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;E&#39;</span><span class="p">,</span><span class="s1">&#39;E_abs&#39;</span><span class="p">,</span><span class="s1">&#39;Rquad&#39;</span><span class="p">,</span><span class="s1">&#39;Fit_result&#39;</span><span class="p">,</span><span class="s1">&#39;strain&#39;</span><span class="p">],</span>
                        <span class="n">name</span><span class="o">=</span><span class="s1">&#39;E_lsq_F_B1Ml&#39;</span><span class="p">)</span>
    
    <span class="n">E_lsq_F_B2Al</span> <span class="o">=</span> <span class="n">emeb</span><span class="o">.</span><span class="n">evaluation</span><span class="o">.</span><span class="n">YM_eva_method_B</span><span class="p">(</span><span class="n">option</span><span class="o">=</span><span class="s2">&quot;Fit&quot;</span><span class="p">,</span> 
                                 <span class="n">stress_mid_ser</span><span class="o">=</span><span class="n">messu</span><span class="o">.</span><span class="n">Stress</span><span class="p">,</span>
                                 <span class="n">thickness</span> <span class="o">=</span> <span class="n">func_t</span><span class="p">(</span><span class="mf">0.0</span><span class="p">),</span>
                                 <span class="n">Length</span><span class="o">=</span><span class="n">Length</span><span class="p">,</span>
                                 <span class="n">w_func</span><span class="o">=</span><span class="n">bl</span><span class="p">[</span><span class="s1">&#39;w_A&#39;</span><span class="p">][</span><span class="s1">&#39;d0&#39;</span><span class="p">],</span>
                                 <span class="n">w_params</span><span class="o">=</span><span class="n">Pre_fit_df</span><span class="o">.</span><span class="n">loc</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)[</span><span class="s1">&#39;Fit_params_dict&#39;</span><span class="p">],</span>
                                 <span class="n">Length_det</span><span class="o">=</span><span class="mf">10.0</span><span class="p">,</span>
                                 <span class="n">comp</span><span class="o">=</span><span class="n">_opts</span><span class="p">[</span><span class="s1">&#39;OPT_Compression&#39;</span><span class="p">],</span>
                                 <span class="n">name</span><span class="o">=</span><span class="s1">&#39;E_lsq_F_B2Al&#39;</span><span class="p">,</span>
                                 <span class="n">det_opt</span><span class="o">=</span><span class="s1">&#39;leastsq&#39;</span><span class="p">,</span>
                                 <span class="o">**</span><span class="p">{</span><span class="s1">&#39;ind_S&#39;</span><span class="p">:</span><span class="n">VIP_dicu</span><span class="p">[</span><span class="n">Ind_YM_f</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span>
                                    <span class="s1">&#39;ind_E&#39;</span><span class="p">:</span><span class="n">VIP_dicu</span><span class="p">[</span><span class="n">Ind_YM_f</span><span class="p">[</span><span class="mi">1</span><span class="p">]]})</span>
    <span class="n">E_lsq_F_B2Al</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">E_lsq_F_B2Al</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;E&#39;</span><span class="p">,</span><span class="s1">&#39;E_abs&#39;</span><span class="p">,</span><span class="s1">&#39;Rquad&#39;</span><span class="p">,</span><span class="s1">&#39;Fit_result&#39;</span><span class="p">,</span><span class="s1">&#39;strain&#39;</span><span class="p">],</span>
                        <span class="n">name</span><span class="o">=</span><span class="s1">&#39;E_lsq_F_B2Al&#39;</span><span class="p">)</span>
    <span class="n">E_lsq_F_B2Sl</span> <span class="o">=</span> <span class="n">emeb</span><span class="o">.</span><span class="n">evaluation</span><span class="o">.</span><span class="n">YM_eva_method_B</span><span class="p">(</span><span class="n">option</span><span class="o">=</span><span class="s2">&quot;Fit&quot;</span><span class="p">,</span> 
                                 <span class="n">stress_mid_ser</span><span class="o">=</span><span class="n">messu</span><span class="o">.</span><span class="n">Stress</span><span class="p">,</span>
                                 <span class="n">thickness</span> <span class="o">=</span> <span class="n">func_t</span><span class="p">(</span><span class="mf">0.0</span><span class="p">),</span>
                                 <span class="n">Length</span><span class="o">=</span><span class="n">Length</span><span class="p">,</span>
                                 <span class="n">w_func</span><span class="o">=</span><span class="n">bl</span><span class="p">[</span><span class="s1">&#39;w_S&#39;</span><span class="p">][</span><span class="s1">&#39;d0&#39;</span><span class="p">],</span>
                                 <span class="n">w_params</span><span class="o">=</span><span class="n">Pre_fit_df</span><span class="o">.</span><span class="n">loc</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)[</span><span class="s1">&#39;Fit_params_dict&#39;</span><span class="p">],</span>
                                 <span class="n">Length_det</span><span class="o">=</span><span class="mf">10.0</span><span class="p">,</span>
                                 <span class="n">comp</span><span class="o">=</span><span class="n">_opts</span><span class="p">[</span><span class="s1">&#39;OPT_Compression&#39;</span><span class="p">],</span>
                                 <span class="n">name</span><span class="o">=</span><span class="s1">&#39;E_lsq_F_B2Sl&#39;</span><span class="p">,</span>
                                 <span class="n">det_opt</span><span class="o">=</span><span class="s1">&#39;leastsq&#39;</span><span class="p">,</span>
                                 <span class="o">**</span><span class="p">{</span><span class="s1">&#39;ind_S&#39;</span><span class="p">:</span><span class="n">VIP_dicu</span><span class="p">[</span><span class="n">Ind_YM_f</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span>
                                    <span class="s1">&#39;ind_E&#39;</span><span class="p">:</span><span class="n">VIP_dicu</span><span class="p">[</span><span class="n">Ind_YM_f</span><span class="p">[</span><span class="mi">1</span><span class="p">]]})</span>
    <span class="n">E_lsq_F_B2Sl</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">E_lsq_F_B2Sl</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;E&#39;</span><span class="p">,</span><span class="s1">&#39;E_abs&#39;</span><span class="p">,</span><span class="s1">&#39;Rquad&#39;</span><span class="p">,</span><span class="s1">&#39;Fit_result&#39;</span><span class="p">,</span><span class="s1">&#39;strain&#39;</span><span class="p">],</span>
                        <span class="n">name</span><span class="o">=</span><span class="s1">&#39;E_lsq_F_B2Sl&#39;</span><span class="p">)</span>
    <span class="n">E_lsq_F_B2Ml</span> <span class="o">=</span> <span class="n">emeb</span><span class="o">.</span><span class="n">evaluation</span><span class="o">.</span><span class="n">YM_eva_method_B</span><span class="p">(</span><span class="n">option</span><span class="o">=</span><span class="s2">&quot;Fit&quot;</span><span class="p">,</span> 
                                 <span class="n">stress_mid_ser</span><span class="o">=</span><span class="n">messu</span><span class="o">.</span><span class="n">Stress</span><span class="p">,</span>
                                 <span class="n">thickness</span> <span class="o">=</span> <span class="n">func_t</span><span class="p">(</span><span class="mf">0.0</span><span class="p">),</span>
                                 <span class="n">Length</span><span class="o">=</span><span class="n">Length</span><span class="p">,</span>
                                 <span class="n">w_func</span><span class="o">=</span><span class="n">bl</span><span class="p">[</span><span class="s1">&#39;w_M&#39;</span><span class="p">][</span><span class="s1">&#39;d0&#39;</span><span class="p">],</span> 
                                 <span class="n">w_params</span><span class="o">=</span><span class="n">Bend_fit_df</span><span class="o">.</span><span class="n">loc</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)[</span><span class="s1">&#39;Fit_params_dict&#39;</span><span class="p">],</span>
                                 <span class="n">Length_det</span><span class="o">=</span><span class="mf">10.0</span><span class="p">,</span> 
                                 <span class="n">comp</span><span class="o">=</span><span class="n">_opts</span><span class="p">[</span><span class="s1">&#39;OPT_Compression&#39;</span><span class="p">],</span>
                                 <span class="n">name</span><span class="o">=</span><span class="s1">&#39;E_lsq_F_B2Ml&#39;</span><span class="p">,</span>
                                 <span class="n">det_opt</span><span class="o">=</span><span class="s1">&#39;leastsq&#39;</span><span class="p">,</span>
                                 <span class="o">**</span><span class="p">{</span><span class="s1">&#39;ind_S&#39;</span><span class="p">:</span><span class="n">VIP_dicu</span><span class="p">[</span><span class="n">Ind_YM_f</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span>
                                    <span class="s1">&#39;ind_E&#39;</span><span class="p">:</span><span class="n">VIP_dicu</span><span class="p">[</span><span class="n">Ind_YM_f</span><span class="p">[</span><span class="mi">1</span><span class="p">]]})</span>
    <span class="n">E_lsq_F_B2Ml</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">E_lsq_F_B2Ml</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;E&#39;</span><span class="p">,</span><span class="s1">&#39;E_abs&#39;</span><span class="p">,</span><span class="s1">&#39;Rquad&#39;</span><span class="p">,</span><span class="s1">&#39;Fit_result&#39;</span><span class="p">,</span><span class="s1">&#39;strain&#39;</span><span class="p">],</span>
                        <span class="n">name</span><span class="o">=</span><span class="s1">&#39;E_lsq_F_B2Ml&#39;</span><span class="p">)</span>
    
    <span class="n">E_lsq_R_B1Al</span> <span class="o">=</span> <span class="n">emeb</span><span class="o">.</span><span class="n">evaluation</span><span class="o">.</span><span class="n">YM_eva_method_B</span><span class="p">(</span><span class="n">option</span><span class="o">=</span><span class="s2">&quot;Points&quot;</span><span class="p">,</span>
                                 <span class="n">stress_mid_ser</span><span class="o">=</span><span class="n">messu</span><span class="o">.</span><span class="n">Stress</span><span class="p">,</span>
                                 <span class="n">thickness</span> <span class="o">=</span> <span class="n">func_t</span><span class="p">(</span><span class="mf">0.0</span><span class="p">),</span>
                                 <span class="n">Length</span> <span class="o">=</span> <span class="n">Length</span><span class="p">,</span>
                                 <span class="n">P_df</span> <span class="o">=</span> <span class="n">P_xcoord_ydisp_meas</span><span class="p">,</span>
                                 <span class="n">P_fork_names</span> <span class="o">=</span> <span class="n">_opts</span><span class="p">[</span><span class="s1">&#39;OPT_DIC_Points_meas_fork&#39;</span><span class="p">],</span>
                                 <span class="n">comp</span> <span class="o">=</span> <span class="n">_opts</span><span class="p">[</span><span class="s1">&#39;OPT_Compression&#39;</span><span class="p">],</span>
                                 <span class="n">name</span><span class="o">=</span><span class="s1">&#39;E_lsq_R_B1Al&#39;</span><span class="p">,</span>
                                 <span class="n">det_opt</span><span class="o">=</span><span class="s1">&#39;leastsq&#39;</span><span class="p">,</span>
                                 <span class="o">**</span><span class="p">{</span><span class="s1">&#39;ind_S&#39;</span><span class="p">:</span><span class="n">VIP_dicu</span><span class="p">[</span><span class="n">Ind_YM_r</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span>
                                    <span class="s1">&#39;ind_E&#39;</span><span class="p">:</span><span class="n">VIP_dicu</span><span class="p">[</span><span class="n">Ind_YM_r</span><span class="p">[</span><span class="mi">1</span><span class="p">]]})</span>
    <span class="n">E_lsq_R_B1Al</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">E_lsq_R_B1Al</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;E&#39;</span><span class="p">,</span><span class="s1">&#39;E_abs&#39;</span><span class="p">,</span><span class="s1">&#39;Rquad&#39;</span><span class="p">,</span><span class="s1">&#39;Fit_result&#39;</span><span class="p">,</span><span class="s1">&#39;strain&#39;</span><span class="p">],</span>
                        <span class="n">name</span><span class="o">=</span><span class="s1">&#39;E_lsq_R_B1Al&#39;</span><span class="p">)</span>
    
    <span class="n">E_lsq_R_B1Sl</span> <span class="o">=</span> <span class="n">emeb</span><span class="o">.</span><span class="n">evaluation</span><span class="o">.</span><span class="n">YM_eva_method_B</span><span class="p">(</span><span class="n">option</span><span class="o">=</span><span class="s2">&quot;Points&quot;</span><span class="p">,</span>
                                 <span class="n">stress_mid_ser</span><span class="o">=</span><span class="n">messu</span><span class="o">.</span><span class="n">Stress</span><span class="p">,</span>
                                 <span class="n">thickness</span> <span class="o">=</span> <span class="n">func_t</span><span class="p">(</span><span class="mf">0.0</span><span class="p">),</span>
                                 <span class="n">Length</span><span class="o">=</span><span class="n">Length</span><span class="p">,</span>
                                 <span class="n">P_df</span> <span class="o">=</span> <span class="n">P_xcoord_ydisp_meas_S</span><span class="p">,</span>
                                 <span class="n">P_fork_names</span> <span class="o">=</span> <span class="n">_opts</span><span class="p">[</span><span class="s1">&#39;OPT_DIC_Points_meas_fork&#39;</span><span class="p">],</span>
                                 <span class="n">comp</span><span class="o">=</span><span class="n">_opts</span><span class="p">[</span><span class="s1">&#39;OPT_Compression&#39;</span><span class="p">],</span>
                                 <span class="n">name</span><span class="o">=</span><span class="s1">&#39;E_lsq_R_B1Sl&#39;</span><span class="p">,</span>
                                 <span class="n">det_opt</span><span class="o">=</span><span class="s1">&#39;leastsq&#39;</span><span class="p">,</span>
                                 <span class="o">**</span><span class="p">{</span><span class="s1">&#39;ind_S&#39;</span><span class="p">:</span><span class="n">VIP_dicu</span><span class="p">[</span><span class="n">Ind_YM_r</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span>
                                    <span class="s1">&#39;ind_E&#39;</span><span class="p">:</span><span class="n">VIP_dicu</span><span class="p">[</span><span class="n">Ind_YM_r</span><span class="p">[</span><span class="mi">1</span><span class="p">]]})</span>
    <span class="n">E_lsq_R_B1Sl</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">E_lsq_R_B1Sl</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;E&#39;</span><span class="p">,</span><span class="s1">&#39;E_abs&#39;</span><span class="p">,</span><span class="s1">&#39;Rquad&#39;</span><span class="p">,</span><span class="s1">&#39;Fit_result&#39;</span><span class="p">,</span><span class="s1">&#39;strain&#39;</span><span class="p">],</span>
                        <span class="n">name</span><span class="o">=</span><span class="s1">&#39;E_lsq_R_B1Sl&#39;</span><span class="p">)</span>
    <span class="n">E_lsq_R_B1Ml</span> <span class="o">=</span> <span class="n">emeb</span><span class="o">.</span><span class="n">evaluation</span><span class="o">.</span><span class="n">YM_eva_method_B</span><span class="p">(</span><span class="n">option</span><span class="o">=</span><span class="s2">&quot;Points&quot;</span><span class="p">,</span>
                                 <span class="n">stress_mid_ser</span><span class="o">=</span><span class="n">messu</span><span class="o">.</span><span class="n">Stress</span><span class="p">,</span>
                                 <span class="n">thickness</span> <span class="o">=</span> <span class="n">func_t</span><span class="p">(</span><span class="mf">0.0</span><span class="p">),</span>
                                 <span class="n">Length</span><span class="o">=</span><span class="n">Length</span><span class="p">,</span>
                                 <span class="n">P_df</span> <span class="o">=</span> <span class="n">P_xcoord_ydisp_meas_M</span><span class="p">,</span>
                                 <span class="n">P_fork_names</span> <span class="o">=</span> <span class="n">_opts</span><span class="p">[</span><span class="s1">&#39;OPT_DIC_Points_meas_fork&#39;</span><span class="p">],</span>
                                 <span class="n">comp</span><span class="o">=</span><span class="n">_opts</span><span class="p">[</span><span class="s1">&#39;OPT_Compression&#39;</span><span class="p">],</span>
                                 <span class="n">name</span><span class="o">=</span><span class="s1">&#39;E_lsq_R_B1Ml&#39;</span><span class="p">,</span>
                                 <span class="n">det_opt</span><span class="o">=</span><span class="s1">&#39;leastsq&#39;</span><span class="p">,</span>
                                 <span class="o">**</span><span class="p">{</span><span class="s1">&#39;ind_S&#39;</span><span class="p">:</span><span class="n">VIP_dicu</span><span class="p">[</span><span class="n">Ind_YM_r</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span>
                                    <span class="s1">&#39;ind_E&#39;</span><span class="p">:</span><span class="n">VIP_dicu</span><span class="p">[</span><span class="n">Ind_YM_r</span><span class="p">[</span><span class="mi">1</span><span class="p">]]})</span>
    <span class="n">E_lsq_R_B1Ml</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">E_lsq_R_B1Ml</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;E&#39;</span><span class="p">,</span><span class="s1">&#39;E_abs&#39;</span><span class="p">,</span><span class="s1">&#39;Rquad&#39;</span><span class="p">,</span><span class="s1">&#39;Fit_result&#39;</span><span class="p">,</span><span class="s1">&#39;strain&#39;</span><span class="p">],</span>
                        <span class="n">name</span><span class="o">=</span><span class="s1">&#39;E_lsq_R_B1Ml&#39;</span><span class="p">)</span>
    
    <span class="n">E_lsq_R_B2Al</span> <span class="o">=</span> <span class="n">emeb</span><span class="o">.</span><span class="n">evaluation</span><span class="o">.</span><span class="n">YM_eva_method_B</span><span class="p">(</span><span class="n">option</span><span class="o">=</span><span class="s2">&quot;Fit&quot;</span><span class="p">,</span> 
                                 <span class="n">stress_mid_ser</span><span class="o">=</span><span class="n">messu</span><span class="o">.</span><span class="n">Stress</span><span class="p">,</span>
                                 <span class="n">thickness</span> <span class="o">=</span> <span class="n">func_t</span><span class="p">(</span><span class="mf">0.0</span><span class="p">),</span>
                                 <span class="n">Length</span><span class="o">=</span><span class="n">Length</span><span class="p">,</span>
                                 <span class="n">w_func</span><span class="o">=</span><span class="n">bl</span><span class="p">[</span><span class="s1">&#39;w_A&#39;</span><span class="p">][</span><span class="s1">&#39;d0&#39;</span><span class="p">],</span>
                                 <span class="n">w_params</span><span class="o">=</span><span class="n">Pre_fit_df</span><span class="o">.</span><span class="n">loc</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)[</span><span class="s1">&#39;Fit_params_dict&#39;</span><span class="p">],</span>
                                 <span class="n">Length_det</span><span class="o">=</span><span class="mf">10.0</span><span class="p">,</span>
                                 <span class="n">comp</span><span class="o">=</span><span class="n">_opts</span><span class="p">[</span><span class="s1">&#39;OPT_Compression&#39;</span><span class="p">],</span>
                                 <span class="n">name</span><span class="o">=</span><span class="s1">&#39;E_lsq_R_B2Al&#39;</span><span class="p">,</span>
                                 <span class="n">det_opt</span><span class="o">=</span><span class="s1">&#39;leastsq&#39;</span><span class="p">,</span>
                                 <span class="o">**</span><span class="p">{</span><span class="s1">&#39;ind_S&#39;</span><span class="p">:</span><span class="n">VIP_dicu</span><span class="p">[</span><span class="n">Ind_YM_r</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span>
                                    <span class="s1">&#39;ind_E&#39;</span><span class="p">:</span><span class="n">VIP_dicu</span><span class="p">[</span><span class="n">Ind_YM_r</span><span class="p">[</span><span class="mi">1</span><span class="p">]]})</span>
    <span class="n">E_lsq_R_B2Al</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">E_lsq_R_B2Al</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;E&#39;</span><span class="p">,</span><span class="s1">&#39;E_abs&#39;</span><span class="p">,</span><span class="s1">&#39;Rquad&#39;</span><span class="p">,</span><span class="s1">&#39;Fit_result&#39;</span><span class="p">,</span><span class="s1">&#39;strain&#39;</span><span class="p">],</span>
                        <span class="n">name</span><span class="o">=</span><span class="s1">&#39;E_lsq_R_B2Al&#39;</span><span class="p">)</span>
    <span class="n">E_lsq_R_B2Sl</span> <span class="o">=</span> <span class="n">emeb</span><span class="o">.</span><span class="n">evaluation</span><span class="o">.</span><span class="n">YM_eva_method_B</span><span class="p">(</span><span class="n">option</span><span class="o">=</span><span class="s2">&quot;Fit&quot;</span><span class="p">,</span> 
                                 <span class="n">stress_mid_ser</span><span class="o">=</span><span class="n">messu</span><span class="o">.</span><span class="n">Stress</span><span class="p">,</span>
                                 <span class="n">thickness</span> <span class="o">=</span> <span class="n">func_t</span><span class="p">(</span><span class="mf">0.0</span><span class="p">),</span>
                                 <span class="n">Length</span><span class="o">=</span><span class="n">Length</span><span class="p">,</span>
                                 <span class="n">w_func</span><span class="o">=</span><span class="n">bl</span><span class="p">[</span><span class="s1">&#39;w_S&#39;</span><span class="p">][</span><span class="s1">&#39;d0&#39;</span><span class="p">],</span>
                                 <span class="n">w_params</span><span class="o">=</span><span class="n">Pre_fit_df</span><span class="o">.</span><span class="n">loc</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)[</span><span class="s1">&#39;Fit_params_dict&#39;</span><span class="p">],</span>
                                 <span class="n">Length_det</span><span class="o">=</span><span class="mf">10.0</span><span class="p">,</span>
                                 <span class="n">comp</span><span class="o">=</span><span class="n">_opts</span><span class="p">[</span><span class="s1">&#39;OPT_Compression&#39;</span><span class="p">],</span>
                                 <span class="n">name</span><span class="o">=</span><span class="s1">&#39;E_lsq_R_B2Sl&#39;</span><span class="p">,</span>
                                 <span class="n">det_opt</span><span class="o">=</span><span class="s1">&#39;leastsq&#39;</span><span class="p">,</span>
                                 <span class="o">**</span><span class="p">{</span><span class="s1">&#39;ind_S&#39;</span><span class="p">:</span><span class="n">VIP_dicu</span><span class="p">[</span><span class="n">Ind_YM_r</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span>
                                    <span class="s1">&#39;ind_E&#39;</span><span class="p">:</span><span class="n">VIP_dicu</span><span class="p">[</span><span class="n">Ind_YM_r</span><span class="p">[</span><span class="mi">1</span><span class="p">]]})</span>
    <span class="n">E_lsq_R_B2Sl</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">E_lsq_R_B2Sl</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;E&#39;</span><span class="p">,</span><span class="s1">&#39;E_abs&#39;</span><span class="p">,</span><span class="s1">&#39;Rquad&#39;</span><span class="p">,</span><span class="s1">&#39;Fit_result&#39;</span><span class="p">,</span><span class="s1">&#39;strain&#39;</span><span class="p">],</span>
                        <span class="n">name</span><span class="o">=</span><span class="s1">&#39;E_lsq_R_B2Sl&#39;</span><span class="p">)</span>
    <span class="n">E_lsq_R_B2Ml</span> <span class="o">=</span> <span class="n">emeb</span><span class="o">.</span><span class="n">evaluation</span><span class="o">.</span><span class="n">YM_eva_method_B</span><span class="p">(</span><span class="n">option</span><span class="o">=</span><span class="s2">&quot;Fit&quot;</span><span class="p">,</span> 
                                 <span class="n">stress_mid_ser</span><span class="o">=</span><span class="n">messu</span><span class="o">.</span><span class="n">Stress</span><span class="p">,</span>
                                 <span class="n">thickness</span> <span class="o">=</span> <span class="n">func_t</span><span class="p">(</span><span class="mf">0.0</span><span class="p">),</span>
                                 <span class="n">Length</span><span class="o">=</span><span class="n">Length</span><span class="p">,</span>
                                 <span class="n">w_func</span><span class="o">=</span><span class="n">bl</span><span class="p">[</span><span class="s1">&#39;w_M&#39;</span><span class="p">][</span><span class="s1">&#39;d0&#39;</span><span class="p">],</span> 
                                 <span class="n">w_params</span><span class="o">=</span><span class="n">Bend_fit_df</span><span class="o">.</span><span class="n">loc</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)[</span><span class="s1">&#39;Fit_params_dict&#39;</span><span class="p">],</span>
                                 <span class="n">Length_det</span><span class="o">=</span><span class="mf">10.0</span><span class="p">,</span> 
                                 <span class="n">comp</span><span class="o">=</span><span class="n">_opts</span><span class="p">[</span><span class="s1">&#39;OPT_Compression&#39;</span><span class="p">],</span>
                                 <span class="n">name</span><span class="o">=</span><span class="s1">&#39;E_lsq_R_B2Ml&#39;</span><span class="p">,</span>
                                 <span class="n">det_opt</span><span class="o">=</span><span class="s1">&#39;leastsq&#39;</span><span class="p">,</span>
                                 <span class="o">**</span><span class="p">{</span><span class="s1">&#39;ind_S&#39;</span><span class="p">:</span><span class="n">VIP_dicu</span><span class="p">[</span><span class="n">Ind_YM_r</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span>
                                    <span class="s1">&#39;ind_E&#39;</span><span class="p">:</span><span class="n">VIP_dicu</span><span class="p">[</span><span class="n">Ind_YM_r</span><span class="p">[</span><span class="mi">1</span><span class="p">]]})</span>
    <span class="n">E_lsq_R_B2Ml</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">E_lsq_R_B2Ml</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;E&#39;</span><span class="p">,</span><span class="s1">&#39;E_abs&#39;</span><span class="p">,</span><span class="s1">&#39;Rquad&#39;</span><span class="p">,</span><span class="s1">&#39;Fit_result&#39;</span><span class="p">,</span><span class="s1">&#39;strain&#39;</span><span class="p">],</span>
                        <span class="n">name</span><span class="o">=</span><span class="s1">&#39;E_lsq_R_B2Ml&#39;</span><span class="p">)</span>
        
    <span class="n">E_lsq_B</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">E_lsq_F_B1Al</span><span class="p">,</span><span class="n">E_lsq_F_B1Sl</span><span class="p">,</span><span class="n">E_lsq_F_B1Ml</span><span class="p">,</span>
                         <span class="n">E_lsq_F_B2Al</span><span class="p">,</span><span class="n">E_lsq_F_B2Sl</span><span class="p">,</span><span class="n">E_lsq_F_B2Ml</span><span class="p">,</span>
                         <span class="n">E_lsq_R_B1Al</span><span class="p">,</span><span class="n">E_lsq_R_B1Sl</span><span class="p">,</span><span class="n">E_lsq_R_B1Ml</span><span class="p">,</span>
                         <span class="n">E_lsq_R_B2Al</span><span class="p">,</span><span class="n">E_lsq_R_B2Sl</span><span class="p">,</span><span class="n">E_lsq_R_B2Ml</span><span class="p">],</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    
    <span class="k">del</span> <span class="n">B1Al_strain_ser</span><span class="p">,</span><span class="n">B1Sl_strain_ser</span><span class="p">,</span><span class="n">B1Ml_strain_ser</span><span class="p">,</span><span class="n">B2Al_strain_ser</span><span class="p">,</span><span class="n">B2Sl_strain_ser</span><span class="p">,</span><span class="n">B2Ml_strain_ser</span>
    <span class="k">del</span> <span class="n">B1Al_ser</span><span class="p">,</span><span class="n">B1Sl_ser</span><span class="p">,</span><span class="n">B1Ml_ser</span><span class="p">,</span><span class="n">B2Al_ser</span><span class="p">,</span><span class="n">B2Sl_ser</span><span class="p">,</span><span class="n">B2Ml_ser</span>
    <span class="k">del</span> <span class="n">E_lsq_F_B1Al</span><span class="p">,</span><span class="n">E_lsq_F_B1Sl</span><span class="p">,</span><span class="n">E_lsq_F_B1Ml</span>
    <span class="k">del</span> <span class="n">E_lsq_F_B2Al</span><span class="p">,</span><span class="n">E_lsq_F_B2Sl</span><span class="p">,</span><span class="n">E_lsq_F_B2Ml</span>
    <span class="k">del</span> <span class="n">E_lsq_R_B1Al</span><span class="p">,</span><span class="n">E_lsq_R_B1Sl</span><span class="p">,</span><span class="n">E_lsq_R_B1Ml</span>
    <span class="k">del</span> <span class="n">E_lsq_R_B2Al</span><span class="p">,</span><span class="n">E_lsq_R_B2Sl</span><span class="p">,</span><span class="n">E_lsq_R_B2Ml</span>

    <span class="c1">#%%%% 6.4.3 Method C</span>
    <span class="n">timings</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mf">6.43</span><span class="p">]</span><span class="o">=</span><span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span>
    <span class="n">log_custom</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">   Timing </span><span class="si">%f</span><span class="s2">: </span><span class="si">%.5f</span><span class="s2"> s&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">timings</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span>
                                       <span class="n">timings</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">timings</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span>
                   <span class="o">**</span><span class="n">log_scopt</span><span class="p">)</span>    
    
    <span class="n">E_C2Al_ser</span> <span class="o">=</span> <span class="n">emeb</span><span class="o">.</span><span class="n">evaluation</span><span class="o">.</span><span class="n">YM_eva_method_C</span><span class="p">(</span><span class="n">Force_ser</span><span class="o">=</span><span class="n">d_Force</span><span class="p">,</span> <span class="n">w_func</span><span class="o">=</span><span class="n">bl</span><span class="p">[</span><span class="s1">&#39;w_A&#39;</span><span class="p">][</span><span class="s1">&#39;d0&#39;</span><span class="p">],</span> 
                                  <span class="n">w_params</span><span class="o">=</span><span class="n">Pre_inc_fit_df</span><span class="o">.</span><span class="n">loc</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)[</span><span class="s1">&#39;Fit_params_dict&#39;</span><span class="p">],</span>
                                  <span class="n">length</span><span class="o">=</span><span class="n">Length</span><span class="p">,</span> <span class="n">I_func</span><span class="o">=</span><span class="n">func_I</span><span class="p">,</span> <span class="n">A_func</span><span class="o">=</span><span class="n">func_A</span><span class="p">,</span>
                                  <span class="n">CS_type</span><span class="o">=</span><span class="s1">&#39;Rectangle&#39;</span><span class="p">,</span> <span class="n">kappa</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                  <span class="n">poisson</span><span class="o">=</span><span class="n">_opts</span><span class="p">[</span><span class="s1">&#39;OPT_Poisson_prediction&#39;</span><span class="p">],</span>
                                  <span class="n">comp</span><span class="o">=</span><span class="n">_opts</span><span class="p">[</span><span class="s1">&#39;OPT_Compression&#39;</span><span class="p">],</span> <span class="n">option</span><span class="o">=</span><span class="s2">&quot;M&quot;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;C2Al&quot;</span><span class="p">)</span>
    <span class="n">E_C2Sl_ser</span> <span class="o">=</span> <span class="n">emeb</span><span class="o">.</span><span class="n">evaluation</span><span class="o">.</span><span class="n">YM_eva_method_C</span><span class="p">(</span><span class="n">Force_ser</span><span class="o">=</span><span class="n">d_Force</span><span class="p">,</span> <span class="n">w_func</span><span class="o">=</span><span class="n">bl</span><span class="p">[</span><span class="s1">&#39;w_S&#39;</span><span class="p">][</span><span class="s1">&#39;d0&#39;</span><span class="p">],</span> 
                                  <span class="n">w_params</span><span class="o">=</span><span class="n">Pre_inc_fit_df</span><span class="o">.</span><span class="n">loc</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)[</span><span class="s1">&#39;Fit_params_dict&#39;</span><span class="p">],</span>
                                  <span class="n">length</span><span class="o">=</span><span class="n">Length</span><span class="p">,</span> <span class="n">I_func</span><span class="o">=</span><span class="n">func_I</span><span class="p">,</span> <span class="n">A_func</span><span class="o">=</span><span class="n">func_A</span><span class="p">,</span>
                                  <span class="n">CS_type</span><span class="o">=</span><span class="s1">&#39;Rectangle&#39;</span><span class="p">,</span> <span class="n">kappa</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                  <span class="n">poisson</span><span class="o">=</span><span class="n">_opts</span><span class="p">[</span><span class="s1">&#39;OPT_Poisson_prediction&#39;</span><span class="p">],</span>
                                  <span class="n">comp</span><span class="o">=</span><span class="n">_opts</span><span class="p">[</span><span class="s1">&#39;OPT_Compression&#39;</span><span class="p">],</span> <span class="n">option</span><span class="o">=</span><span class="s2">&quot;M&quot;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;C2Sl&quot;</span><span class="p">)</span>
    <span class="n">E_C2Ml_ser</span> <span class="o">=</span> <span class="n">emeb</span><span class="o">.</span><span class="n">evaluation</span><span class="o">.</span><span class="n">YM_eva_method_C</span><span class="p">(</span><span class="n">Force_ser</span><span class="o">=</span><span class="n">d_Force</span><span class="p">,</span> <span class="n">w_func</span><span class="o">=</span><span class="n">bl</span><span class="p">[</span><span class="s1">&#39;w_M&#39;</span><span class="p">][</span><span class="s1">&#39;d0&#39;</span><span class="p">],</span> 
                                  <span class="n">w_params</span><span class="o">=</span><span class="n">Bend_inc_fit_df</span><span class="o">.</span><span class="n">loc</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)[</span><span class="s1">&#39;Fit_params_dict&#39;</span><span class="p">],</span>
                                  <span class="n">length</span><span class="o">=</span><span class="n">Length</span><span class="p">,</span> <span class="n">I_func</span><span class="o">=</span><span class="n">func_I</span><span class="p">,</span> <span class="n">A_func</span><span class="o">=</span><span class="n">func_A</span><span class="p">,</span>
                                  <span class="n">CS_type</span><span class="o">=</span><span class="s1">&#39;Rectangle&#39;</span><span class="p">,</span> <span class="n">kappa</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                  <span class="n">poisson</span><span class="o">=</span><span class="n">_opts</span><span class="p">[</span><span class="s1">&#39;OPT_Poisson_prediction&#39;</span><span class="p">],</span>
                                  <span class="n">comp</span><span class="o">=</span><span class="n">_opts</span><span class="p">[</span><span class="s1">&#39;OPT_Compression&#39;</span><span class="p">],</span> <span class="n">option</span><span class="o">=</span><span class="s2">&quot;M&quot;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;C2Ml&quot;</span><span class="p">)</span>
    <span class="n">E_C2Cl_ser</span> <span class="o">=</span> <span class="n">emeb</span><span class="o">.</span><span class="n">evaluation</span><span class="o">.</span><span class="n">YM_eva_method_C</span><span class="p">(</span><span class="n">Force_ser</span><span class="o">=</span><span class="n">d_Force</span><span class="p">,</span> <span class="n">w_func</span><span class="o">=</span><span class="n">bl</span><span class="p">[</span><span class="s1">&#39;w_S&#39;</span><span class="p">][</span><span class="s1">&#39;d0&#39;</span><span class="p">],</span> 
                                  <span class="n">w_params</span><span class="o">=</span><span class="n">Pre_inc_fit_df</span><span class="o">.</span><span class="n">loc</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)[</span><span class="s1">&#39;Fit_params_dict&#39;</span><span class="p">],</span>
                                  <span class="n">length</span><span class="o">=</span><span class="n">Length</span><span class="p">,</span> <span class="n">I_func</span><span class="o">=</span><span class="n">func_I</span><span class="p">,</span> <span class="n">A_func</span><span class="o">=</span><span class="n">func_A</span><span class="p">,</span>
                                  <span class="n">CS_type</span><span class="o">=</span><span class="s1">&#39;Rectangle&#39;</span><span class="p">,</span> <span class="n">kappa</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                  <span class="n">poisson</span><span class="o">=</span><span class="n">_opts</span><span class="p">[</span><span class="s1">&#39;OPT_Poisson_prediction&#39;</span><span class="p">],</span>
                                  <span class="n">comp</span><span class="o">=</span><span class="n">_opts</span><span class="p">[</span><span class="s1">&#39;OPT_Compression&#39;</span><span class="p">],</span> <span class="n">option</span><span class="o">=</span><span class="s2">&quot;M+V&quot;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;C2Cl&quot;</span><span class="p">)</span>
    
    <span class="n">E_C_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">E_C2Al_ser</span><span class="p">,</span><span class="n">E_C2Sl_ser</span><span class="p">,</span><span class="n">E_C2Ml_ser</span><span class="p">,</span><span class="n">E_C2Cl_ser</span><span class="p">],</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">E_C</span> <span class="o">=</span> <span class="n">emec</span><span class="o">.</span><span class="n">stat_ext</span><span class="o">.</span><span class="n">pd_agg</span><span class="p">(</span><span class="n">E_C_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">sr_eva_dic</span><span class="p">])</span>
    
    <span class="k">if</span> <span class="kc">True</span><span class="p">:</span>    
        <span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="n">ax1</span><span class="p">,</span><span class="n">ax2</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> 
                                      <span class="n">sharex</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> 
                                      <span class="n">figsize</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">figsize</span><span class="p">,[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">]))</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1"> - Compare method C&#39;</span><span class="o">%</span><span class="p">(</span><span class="n">plt_name</span><span class="p">))</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;All Steps&#39;</span><span class="p">)</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Step / -&#39;</span><span class="p">)</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;E / MPa&#39;</span><span class="p">)</span>
        <span class="n">cc</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;C2Al&#39;</span><span class="p">:</span><span class="s1">&#39;r:&#39;</span><span class="p">,</span><span class="s1">&#39;C2Sl&#39;</span><span class="p">:</span><span class="s1">&#39;b:&#39;</span><span class="p">,</span><span class="s1">&#39;C2Ml&#39;</span><span class="p">:</span><span class="s1">&#39;m--&#39;</span><span class="p">,</span><span class="s1">&#39;C2Cl&#39;</span><span class="p">:</span><span class="s1">&#39;g--&#39;</span><span class="p">}</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">cc</span><span class="p">:</span>
            <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">E_C_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:</span><span class="n">VIP_messu</span><span class="p">[</span><span class="s1">&#39;U&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">index</span><span class="p">,</span>
                     <span class="n">E_C_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:</span><span class="n">VIP_messu</span><span class="p">[</span><span class="s1">&#39;U&#39;</span><span class="p">]][</span><span class="n">k</span><span class="p">],</span>
                     <span class="n">cc</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1"> - </span><span class="si">%.2f</span><span class="s1"> MPa&#39;</span><span class="o">%</span><span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="n">E_C</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="s1">&#39;mean&#39;</span><span class="p">,</span><span class="n">k</span><span class="p">]))</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">VIP_dicu</span><span class="p">[</span><span class="s1">&#39;F3&#39;</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;olive&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">)</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">VIP_dicu</span><span class="p">[</span><span class="s1">&#39;F4&#39;</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;olive&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
        <span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Improved determination range&#39;</span><span class="p">)</span>
        <span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Step / -&#39;</span><span class="p">)</span>
        <span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;E / MPa&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">cc</span><span class="p">:</span>
            <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">sr_eva_dic</span><span class="p">,</span><span class="n">E_C_df</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">sr_eva_dic</span><span class="p">],</span> <span class="n">cc</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
        <span class="n">plt_hsuf</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span><span class="n">path</span><span class="o">=</span><span class="n">out_full</span><span class="o">+</span><span class="s2">&quot;-YM-Me_C&quot;</span><span class="p">,</span><span class="o">**</span><span class="n">plt_scopt</span><span class="p">)</span>

    <span class="k">del</span> <span class="n">E_C2Al_ser</span><span class="p">,</span> <span class="n">E_C2Sl_ser</span><span class="p">,</span> <span class="n">E_C2Ml_ser</span>
    
    <span class="c1">#%%%% 6.4.4 Method D</span>
    <span class="n">timings</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mf">6.44</span><span class="p">]</span><span class="o">=</span><span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span>
    <span class="n">log_custom</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">   Timing </span><span class="si">%f</span><span class="s2">: </span><span class="si">%.5f</span><span class="s2"> s&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">timings</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span>
                                       <span class="n">timings</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">timings</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span>
                   <span class="o">**</span><span class="n">log_scopt</span><span class="p">)</span>    
    
    <span class="n">D1Agwt</span><span class="p">,</span><span class="n">D1Agwt_df</span><span class="o">=</span><span class="n">emeb</span><span class="o">.</span><span class="n">evaluation</span><span class="o">.</span><span class="n">YM_eva_method_D</span><span class="p">(</span>
        <span class="n">P_df</span><span class="o">=</span><span class="n">P_xcoord_ydiff_meas</span><span class="p">,</span> <span class="n">Force_ser</span><span class="o">=</span><span class="n">d_Force</span><span class="p">,</span>
        <span class="n">rel_steps</span> <span class="o">=</span> <span class="n">step_range_dic_inc</span><span class="p">,</span>
        <span class="n">Length</span><span class="o">=</span><span class="n">Length</span><span class="p">,</span> <span class="n">func_I</span><span class="o">=</span><span class="n">func_I</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
        <span class="n">weighted</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">weight_func</span><span class="o">=</span><span class="n">emeb</span><span class="o">.</span><span class="n">evaluation</span><span class="o">.</span><span class="n">Weight_func</span><span class="p">,</span>
        <span class="n">wargs</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Custom_cut&#39;</span><span class="p">,</span> <span class="n">bl</span><span class="p">[</span><span class="s1">&#39;w_A&#39;</span><span class="p">][</span><span class="s1">&#39;d0&#39;</span><span class="p">]],</span>
        <span class="n">wkwargs</span><span class="o">=</span><span class="n">Pre_inc_fit_df</span><span class="o">.</span><span class="n">loc</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)[</span><span class="s1">&#39;Fit_params_dict&#39;</span><span class="p">],</span>
        <span class="n">pb_b</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;D1Agwt&#39;</span>
        <span class="p">)</span>  
    <span class="n">D1Aguw</span><span class="p">,</span><span class="n">D1Aguw_df</span><span class="o">=</span><span class="n">emeb</span><span class="o">.</span><span class="n">evaluation</span><span class="o">.</span><span class="n">YM_eva_method_D</span><span class="p">(</span>
        <span class="n">P_df</span><span class="o">=</span><span class="n">P_xcoord_ydiff_meas</span><span class="p">,</span> <span class="n">Force_ser</span><span class="o">=</span><span class="n">d_Force</span><span class="p">,</span>
        <span class="n">rel_steps</span> <span class="o">=</span> <span class="n">step_range_dic_inc</span><span class="p">,</span>
        <span class="n">Length</span><span class="o">=</span><span class="n">Length</span><span class="p">,</span> <span class="n">func_I</span><span class="o">=</span><span class="n">func_I</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
        <span class="n">weighted</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">weight_func</span><span class="o">=</span><span class="n">emeb</span><span class="o">.</span><span class="n">evaluation</span><span class="o">.</span><span class="n">Weight_func</span><span class="p">,</span>
        <span class="n">wkwargs</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;option&#39;</span><span class="p">:</span><span class="s1">&#39;Cut&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;xmin&#39;</span><span class="p">:</span><span class="n">Bo_Le</span><span class="p">,</span><span class="s1">&#39;xmax&#39;</span><span class="p">:</span><span class="n">Bo_Ri</span><span class="p">},</span>
        <span class="n">pb_b</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;D1Aguw&#39;</span>
        <span class="p">)</span>
    <span class="n">D1Sgwt</span><span class="p">,</span><span class="n">D1Sgwt_df</span><span class="o">=</span><span class="n">emeb</span><span class="o">.</span><span class="n">evaluation</span><span class="o">.</span><span class="n">YM_eva_method_D</span><span class="p">(</span>
        <span class="n">P_df</span><span class="o">=</span><span class="n">P_xcoord_ydiff_meas_S</span><span class="p">,</span> <span class="n">Force_ser</span><span class="o">=</span><span class="n">d_Force</span><span class="p">,</span>
        <span class="n">rel_steps</span> <span class="o">=</span> <span class="n">step_range_dic_inc</span><span class="p">,</span>
        <span class="n">Length</span><span class="o">=</span><span class="n">Length</span><span class="p">,</span> <span class="n">func_I</span><span class="o">=</span><span class="n">func_I</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
        <span class="n">weighted</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">weight_func</span><span class="o">=</span><span class="n">emeb</span><span class="o">.</span><span class="n">evaluation</span><span class="o">.</span><span class="n">Weight_func</span><span class="p">,</span>
        <span class="n">wargs</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Custom_cut&#39;</span><span class="p">,</span> <span class="n">bl</span><span class="p">[</span><span class="s1">&#39;w_S&#39;</span><span class="p">][</span><span class="s1">&#39;d0&#39;</span><span class="p">]],</span>
        <span class="n">wkwargs</span><span class="o">=</span><span class="n">Pre_inc_fit_df</span><span class="o">.</span><span class="n">loc</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)[</span><span class="s1">&#39;Fit_params_dict&#39;</span><span class="p">],</span>
        <span class="n">pb_b</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;D1Sgwt&#39;</span>
        <span class="p">)</span>  
    <span class="n">D1Sguw</span><span class="p">,</span><span class="n">D1Sguw_df</span><span class="o">=</span><span class="n">emeb</span><span class="o">.</span><span class="n">evaluation</span><span class="o">.</span><span class="n">YM_eva_method_D</span><span class="p">(</span>
        <span class="n">P_df</span><span class="o">=</span><span class="n">P_xcoord_ydiff_meas_S</span><span class="p">,</span> <span class="n">Force_ser</span><span class="o">=</span><span class="n">d_Force</span><span class="p">,</span>
        <span class="n">rel_steps</span> <span class="o">=</span> <span class="n">step_range_dic_inc</span><span class="p">,</span>
        <span class="n">Length</span><span class="o">=</span><span class="n">Length</span><span class="p">,</span> <span class="n">func_I</span><span class="o">=</span><span class="n">func_I</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
        <span class="n">weighted</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">weight_func</span><span class="o">=</span><span class="n">emeb</span><span class="o">.</span><span class="n">evaluation</span><span class="o">.</span><span class="n">Weight_func</span><span class="p">,</span>
        <span class="n">wkwargs</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;option&#39;</span><span class="p">:</span><span class="s1">&#39;Cut&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;xmin&#39;</span><span class="p">:</span><span class="n">Bo_Le</span><span class="p">,</span><span class="s1">&#39;xmax&#39;</span><span class="p">:</span><span class="n">Bo_Ri</span><span class="p">},</span>
        <span class="n">pb_b</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;D1Sguw&#39;</span>
        <span class="p">)</span>
    <span class="n">D1Mgwt</span><span class="p">,</span><span class="n">D1Mgwt_df</span><span class="o">=</span><span class="n">emeb</span><span class="o">.</span><span class="n">evaluation</span><span class="o">.</span><span class="n">YM_eva_method_D</span><span class="p">(</span>
        <span class="n">P_df</span><span class="o">=</span><span class="n">P_xcoord_ydiff_meas_M</span><span class="p">,</span> <span class="n">Force_ser</span><span class="o">=</span><span class="n">d_Force</span><span class="p">,</span>
        <span class="n">rel_steps</span> <span class="o">=</span> <span class="n">step_range_dic_inc</span><span class="p">,</span>
        <span class="n">Length</span><span class="o">=</span><span class="n">Length</span><span class="p">,</span> <span class="n">func_I</span><span class="o">=</span><span class="n">func_I</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
        <span class="n">weighted</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">weight_func</span><span class="o">=</span><span class="n">emeb</span><span class="o">.</span><span class="n">evaluation</span><span class="o">.</span><span class="n">Weight_func</span><span class="p">,</span>
        <span class="n">wargs</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Custom_cut&#39;</span><span class="p">,</span> <span class="n">bl</span><span class="p">[</span><span class="s1">&#39;w_M&#39;</span><span class="p">][</span><span class="s1">&#39;d0&#39;</span><span class="p">]],</span>
        <span class="n">wkwargs</span><span class="o">=</span><span class="n">Bend_inc_fit_df</span><span class="o">.</span><span class="n">loc</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)[</span><span class="s1">&#39;Fit_params_dict&#39;</span><span class="p">],</span>
        <span class="n">pb_b</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;D1Mgwt&#39;</span>
        <span class="p">)</span>  
    <span class="n">D1Mguw</span><span class="p">,</span><span class="n">D1Mguw_df</span><span class="o">=</span><span class="n">emeb</span><span class="o">.</span><span class="n">evaluation</span><span class="o">.</span><span class="n">YM_eva_method_D</span><span class="p">(</span>
        <span class="n">P_df</span><span class="o">=</span><span class="n">P_xcoord_ydiff_meas_M</span><span class="p">,</span> <span class="n">Force_ser</span><span class="o">=</span><span class="n">d_Force</span><span class="p">,</span>
        <span class="n">rel_steps</span> <span class="o">=</span> <span class="n">step_range_dic_inc</span><span class="p">,</span>
        <span class="n">Length</span><span class="o">=</span><span class="n">Length</span><span class="p">,</span> <span class="n">func_I</span><span class="o">=</span><span class="n">func_I</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
        <span class="n">weighted</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">weight_func</span><span class="o">=</span><span class="n">emeb</span><span class="o">.</span><span class="n">evaluation</span><span class="o">.</span><span class="n">Weight_func</span><span class="p">,</span>
        <span class="n">wkwargs</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;option&#39;</span><span class="p">:</span><span class="s1">&#39;Cut&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;xmin&#39;</span><span class="p">:</span><span class="n">Bo_Le</span><span class="p">,</span><span class="s1">&#39;xmax&#39;</span><span class="p">:</span><span class="n">Bo_Ri</span><span class="p">},</span>
        <span class="n">pb_b</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;D1Mguw&#39;</span>
        <span class="p">)</span>
    
    <span class="n">dftmp</span> <span class="o">=</span> <span class="n">emeb</span><span class="o">.</span><span class="n">opt_mps</span><span class="o">.</span><span class="n">Point_df_from_lin</span><span class="p">(</span><span class="n">xlin</span><span class="p">,</span><span class="n">step_range_dic</span><span class="p">)</span>
    <span class="n">Diff_A_d0</span> <span class="o">=</span> <span class="n">bl</span><span class="p">[</span><span class="s1">&#39;w_A&#39;</span><span class="p">][</span><span class="s1">&#39;d0&#39;</span><span class="p">](</span><span class="n">xlin</span><span class="p">,</span><span class="n">Pre_inc_fit_df</span><span class="o">.</span><span class="n">loc</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)[</span><span class="s1">&#39;Fit_params_dict&#39;</span><span class="p">])</span>
    <span class="n">A_d0_inc_df</span> <span class="o">=</span> <span class="n">emeb</span><span class="o">.</span><span class="n">opt_mps</span><span class="o">.</span><span class="n">Point_df_combine</span><span class="p">(</span><span class="n">dftmp</span><span class="p">,</span><span class="n">Diff_A_d0</span><span class="p">)</span>
    <span class="n">Diff_S_d0</span> <span class="o">=</span> <span class="n">bl</span><span class="p">[</span><span class="s1">&#39;w_S&#39;</span><span class="p">][</span><span class="s1">&#39;d0&#39;</span><span class="p">](</span><span class="n">xlin</span><span class="p">,</span><span class="n">Pre_inc_fit_df</span><span class="o">.</span><span class="n">loc</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)[</span><span class="s1">&#39;Fit_params_dict&#39;</span><span class="p">])</span>
    <span class="n">S_d0_inc_df</span> <span class="o">=</span> <span class="n">emeb</span><span class="o">.</span><span class="n">opt_mps</span><span class="o">.</span><span class="n">Point_df_combine</span><span class="p">(</span><span class="n">dftmp</span><span class="p">,</span><span class="n">Diff_S_d0</span><span class="p">)</span>
    <span class="n">Diff_M_d0</span> <span class="o">=</span> <span class="n">bl</span><span class="p">[</span><span class="s1">&#39;w_M&#39;</span><span class="p">][</span><span class="s1">&#39;d0&#39;</span><span class="p">](</span><span class="n">xlin</span><span class="p">,</span><span class="n">Bend_inc_fit_df</span><span class="o">.</span><span class="n">loc</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)[</span><span class="s1">&#39;Fit_params_dict&#39;</span><span class="p">])</span>
    <span class="n">M_d0_inc_df</span> <span class="o">=</span> <span class="n">emeb</span><span class="o">.</span><span class="n">opt_mps</span><span class="o">.</span><span class="n">Point_df_combine</span><span class="p">(</span><span class="n">dftmp</span><span class="p">,</span><span class="n">Diff_M_d0</span><span class="p">)</span>
    <span class="n">D2Agwt</span><span class="p">,</span><span class="n">D2Agwt_df</span><span class="o">=</span><span class="n">emeb</span><span class="o">.</span><span class="n">evaluation</span><span class="o">.</span><span class="n">YM_eva_method_D</span><span class="p">(</span>
        <span class="n">P_df</span><span class="o">=</span><span class="n">A_d0_inc_df</span><span class="p">,</span><span class="n">Force_ser</span><span class="o">=</span><span class="n">d_Force</span><span class="p">,</span>
        <span class="n">rel_steps</span> <span class="o">=</span> <span class="n">step_range_dic_inc</span><span class="p">,</span>
        <span class="n">Length</span><span class="o">=</span><span class="n">Length</span><span class="p">,</span> <span class="n">func_I</span><span class="o">=</span><span class="n">func_I</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
        <span class="n">weighted</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">weight_func</span><span class="o">=</span><span class="n">emeb</span><span class="o">.</span><span class="n">evaluation</span><span class="o">.</span><span class="n">Weight_func</span><span class="p">,</span>
        <span class="n">wargs</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Custom_cut&#39;</span><span class="p">,</span> <span class="n">bl</span><span class="p">[</span><span class="s1">&#39;w_A&#39;</span><span class="p">][</span><span class="s1">&#39;d0&#39;</span><span class="p">]],</span>
        <span class="n">wkwargs</span><span class="o">=</span><span class="n">Pre_inc_fit_df</span><span class="o">.</span><span class="n">loc</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)[</span><span class="s1">&#39;Fit_params_dict&#39;</span><span class="p">],</span>
        <span class="n">pb_b</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;D2Agwt&#39;</span>
        <span class="p">)</span>
    <span class="n">D2Aguw</span><span class="p">,</span><span class="n">D2Aguw_df</span><span class="o">=</span><span class="n">emeb</span><span class="o">.</span><span class="n">evaluation</span><span class="o">.</span><span class="n">YM_eva_method_D</span><span class="p">(</span>
        <span class="n">P_df</span><span class="o">=</span><span class="n">A_d0_inc_df</span><span class="p">,</span><span class="n">Force_ser</span><span class="o">=</span><span class="n">d_Force</span><span class="p">,</span>
        <span class="n">rel_steps</span> <span class="o">=</span> <span class="n">step_range_dic_inc</span><span class="p">,</span>
        <span class="n">Length</span><span class="o">=</span><span class="n">Length</span><span class="p">,</span> <span class="n">func_I</span><span class="o">=</span><span class="n">func_I</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
        <span class="n">weighted</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">weight_func</span><span class="o">=</span><span class="n">emeb</span><span class="o">.</span><span class="n">evaluation</span><span class="o">.</span><span class="n">Weight_func</span><span class="p">,</span>
        <span class="n">wkwargs</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;option&#39;</span><span class="p">:</span><span class="s1">&#39;Cut&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;xmin&#39;</span><span class="p">:</span><span class="n">Bo_Le</span><span class="p">,</span><span class="s1">&#39;xmax&#39;</span><span class="p">:</span><span class="n">Bo_Ri</span><span class="p">},</span>
        <span class="n">pb_b</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;D2Aguw&#39;</span>
        <span class="p">)</span>
    <span class="n">D2Sgwt</span><span class="p">,</span><span class="n">D2Sgwt_df</span><span class="o">=</span><span class="n">emeb</span><span class="o">.</span><span class="n">evaluation</span><span class="o">.</span><span class="n">YM_eva_method_D</span><span class="p">(</span>
        <span class="n">P_df</span><span class="o">=</span><span class="n">S_d0_inc_df</span><span class="p">,</span><span class="n">Force_ser</span><span class="o">=</span><span class="n">d_Force</span><span class="p">,</span>
        <span class="n">rel_steps</span> <span class="o">=</span> <span class="n">step_range_dic_inc</span><span class="p">,</span>
        <span class="n">Length</span><span class="o">=</span><span class="n">Length</span><span class="p">,</span> <span class="n">func_I</span><span class="o">=</span><span class="n">func_I</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
        <span class="n">weighted</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">weight_func</span><span class="o">=</span><span class="n">emeb</span><span class="o">.</span><span class="n">evaluation</span><span class="o">.</span><span class="n">Weight_func</span><span class="p">,</span>
        <span class="n">wargs</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Custom_cut&#39;</span><span class="p">,</span> <span class="n">bl</span><span class="p">[</span><span class="s1">&#39;w_S&#39;</span><span class="p">][</span><span class="s1">&#39;d0&#39;</span><span class="p">]],</span>
        <span class="n">wkwargs</span><span class="o">=</span><span class="n">Pre_inc_fit_df</span><span class="o">.</span><span class="n">loc</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)[</span><span class="s1">&#39;Fit_params_dict&#39;</span><span class="p">],</span>
        <span class="n">pb_b</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;D2Sgwt&#39;</span>
        <span class="p">)</span>
    <span class="n">D2Sguw</span><span class="p">,</span><span class="n">D2Sguw_df</span><span class="o">=</span><span class="n">emeb</span><span class="o">.</span><span class="n">evaluation</span><span class="o">.</span><span class="n">YM_eva_method_D</span><span class="p">(</span>
        <span class="n">P_df</span><span class="o">=</span><span class="n">S_d0_inc_df</span><span class="p">,</span><span class="n">Force_ser</span><span class="o">=</span><span class="n">d_Force</span><span class="p">,</span>
        <span class="n">rel_steps</span> <span class="o">=</span> <span class="n">step_range_dic_inc</span><span class="p">,</span>
        <span class="n">Length</span><span class="o">=</span><span class="n">Length</span><span class="p">,</span> <span class="n">func_I</span><span class="o">=</span><span class="n">func_I</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
        <span class="n">weighted</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">weight_func</span><span class="o">=</span><span class="n">emeb</span><span class="o">.</span><span class="n">evaluation</span><span class="o">.</span><span class="n">Weight_func</span><span class="p">,</span>
        <span class="n">wkwargs</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;option&#39;</span><span class="p">:</span><span class="s1">&#39;Cut&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;xmin&#39;</span><span class="p">:</span><span class="n">Bo_Le</span><span class="p">,</span><span class="s1">&#39;xmax&#39;</span><span class="p">:</span><span class="n">Bo_Ri</span><span class="p">},</span>
        <span class="n">pb_b</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;D2Sguw&#39;</span>
        <span class="p">)</span>
    <span class="n">D2Mgwt</span><span class="p">,</span><span class="n">D2Mgwt_df</span><span class="o">=</span><span class="n">emeb</span><span class="o">.</span><span class="n">evaluation</span><span class="o">.</span><span class="n">YM_eva_method_D</span><span class="p">(</span>
        <span class="n">P_df</span><span class="o">=</span><span class="n">M_d0_inc_df</span><span class="p">,</span><span class="n">Force_ser</span><span class="o">=</span><span class="n">d_Force</span><span class="p">,</span>
        <span class="n">rel_steps</span> <span class="o">=</span> <span class="n">step_range_dic_inc</span><span class="p">,</span>
        <span class="n">Length</span><span class="o">=</span><span class="n">Length</span><span class="p">,</span> <span class="n">func_I</span><span class="o">=</span><span class="n">func_I</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
        <span class="n">weighted</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">weight_func</span><span class="o">=</span><span class="n">emeb</span><span class="o">.</span><span class="n">evaluation</span><span class="o">.</span><span class="n">Weight_func</span><span class="p">,</span>
        <span class="n">wargs</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Custom_cut&#39;</span><span class="p">,</span> <span class="n">bl</span><span class="p">[</span><span class="s1">&#39;w_M&#39;</span><span class="p">][</span><span class="s1">&#39;d0&#39;</span><span class="p">]],</span>
        <span class="n">wkwargs</span><span class="o">=</span><span class="n">Bend_inc_fit_df</span><span class="o">.</span><span class="n">loc</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)[</span><span class="s1">&#39;Fit_params_dict&#39;</span><span class="p">],</span>
        <span class="n">pb_b</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;D2Mgwt&#39;</span>
        <span class="p">)</span>
    <span class="n">D2Mguw</span><span class="p">,</span><span class="n">D2Mguw_df</span><span class="o">=</span><span class="n">emeb</span><span class="o">.</span><span class="n">evaluation</span><span class="o">.</span><span class="n">YM_eva_method_D</span><span class="p">(</span>
        <span class="n">P_df</span><span class="o">=</span><span class="n">M_d0_inc_df</span><span class="p">,</span><span class="n">Force_ser</span><span class="o">=</span><span class="n">d_Force</span><span class="p">,</span>
        <span class="n">rel_steps</span> <span class="o">=</span> <span class="n">step_range_dic_inc</span><span class="p">,</span>
        <span class="n">Length</span><span class="o">=</span><span class="n">Length</span><span class="p">,</span> <span class="n">func_I</span><span class="o">=</span><span class="n">func_I</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
        <span class="n">weighted</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">weight_func</span><span class="o">=</span><span class="n">emeb</span><span class="o">.</span><span class="n">evaluation</span><span class="o">.</span><span class="n">Weight_func</span><span class="p">,</span>
        <span class="n">wkwargs</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;option&#39;</span><span class="p">:</span><span class="s1">&#39;Cut&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;xmin&#39;</span><span class="p">:</span><span class="n">Bo_Le</span><span class="p">,</span><span class="s1">&#39;xmax&#39;</span><span class="p">:</span><span class="n">Bo_Ri</span><span class="p">},</span>
        <span class="n">pb_b</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;D2Mguw&#39;</span>
        <span class="p">)</span>
    
    <span class="n">E_D_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">D1Agwt</span><span class="p">,</span><span class="n">D1Aguw</span><span class="p">,</span><span class="n">D1Sgwt</span><span class="p">,</span><span class="n">D1Sguw</span><span class="p">,</span><span class="n">D1Mgwt</span><span class="p">,</span><span class="n">D1Mguw</span><span class="p">,</span>
                        <span class="n">D2Agwt</span><span class="p">,</span><span class="n">D2Aguw</span><span class="p">,</span><span class="n">D2Sgwt</span><span class="p">,</span><span class="n">D2Sguw</span><span class="p">,</span><span class="n">D2Mgwt</span><span class="p">,</span><span class="n">D2Mguw</span><span class="p">],</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">E_D</span> <span class="o">=</span> <span class="n">emec</span><span class="o">.</span><span class="n">stat_ext</span><span class="o">.</span><span class="n">pd_agg</span><span class="p">(</span><span class="n">E_D_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">sr_eva_dic</span><span class="p">])</span>
    
    <span class="k">if</span> <span class="kc">True</span><span class="p">:</span>        
        <span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="n">ax1</span><span class="p">,</span><span class="n">ax2</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> 
                                      <span class="n">sharex</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> 
                                      <span class="n">figsize</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">figsize</span><span class="p">,[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">]))</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1"> - Compare method D&#39;</span><span class="o">%</span><span class="p">(</span><span class="n">plt_name</span><span class="p">))</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;All Steps&#39;</span><span class="p">)</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Step / -&#39;</span><span class="p">)</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;E / MPa&#39;</span><span class="p">)</span>
        <span class="n">cc</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;D1Agwt&#39;</span><span class="p">:</span><span class="s1">&#39;r:&#39;</span><span class="p">,</span><span class="s1">&#39;D1Sgwt&#39;</span><span class="p">:</span><span class="s1">&#39;b:&#39;</span><span class="p">,</span><span class="s1">&#39;D1Mguw&#39;</span><span class="p">:</span><span class="s1">&#39;m:&#39;</span><span class="p">,</span><span class="s1">&#39;D1Mgwt&#39;</span><span class="p">:</span><span class="s1">&#39;g:&#39;</span><span class="p">,</span>
            <span class="s1">&#39;D2Agwt&#39;</span><span class="p">:</span><span class="s1">&#39;r--&#39;</span><span class="p">,</span><span class="s1">&#39;D2Sgwt&#39;</span><span class="p">:</span><span class="s1">&#39;b--&#39;</span><span class="p">,</span><span class="s1">&#39;D2Mguw&#39;</span><span class="p">:</span><span class="s1">&#39;m--&#39;</span><span class="p">,</span><span class="s1">&#39;D2Mgwt&#39;</span><span class="p">:</span><span class="s1">&#39;g--&#39;</span><span class="p">}</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">cc</span><span class="p">:</span>
            <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">E_D_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:</span><span class="n">VIP_messu</span><span class="p">[</span><span class="s1">&#39;U&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">index</span><span class="p">,</span>
                     <span class="n">E_D_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:</span><span class="n">VIP_messu</span><span class="p">[</span><span class="s1">&#39;U&#39;</span><span class="p">]][</span><span class="n">k</span><span class="p">],</span>
                     <span class="n">cc</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1"> - </span><span class="si">%.2f</span><span class="s1"> MPa&#39;</span><span class="o">%</span><span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="n">E_D</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="s1">&#39;mean&#39;</span><span class="p">,</span><span class="n">k</span><span class="p">]))</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">VIP_dicu</span><span class="p">[</span><span class="s1">&#39;F3&#39;</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;olive&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">)</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">VIP_dicu</span><span class="p">[</span><span class="s1">&#39;F4&#39;</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;olive&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
        <span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Improved determination range&#39;</span><span class="p">)</span>
        <span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Step / -&#39;</span><span class="p">)</span>
        <span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;E / MPa&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">cc</span><span class="p">:</span>
            <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">sr_eva_dic</span><span class="p">,</span><span class="n">E_D_df</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">sr_eva_dic</span><span class="p">],</span>
                     <span class="n">cc</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1"> - </span><span class="si">%.2f</span><span class="s1"> MPa&#39;</span><span class="o">%</span><span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="n">E_D</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="s1">&#39;mean&#39;</span><span class="p">,</span><span class="n">k</span><span class="p">]))</span>
        <span class="n">plt_hsuf</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span><span class="n">path</span><span class="o">=</span><span class="n">out_full</span><span class="o">+</span><span class="s2">&quot;-YM-Me_D&quot;</span><span class="p">,</span><span class="o">**</span><span class="n">plt_scopt</span><span class="p">)</span>
    
    <span class="k">del</span> <span class="n">D1Agwt</span><span class="p">,</span><span class="n">D1Aguw</span><span class="p">,</span><span class="n">D1Sgwt</span><span class="p">,</span><span class="n">D1Sguw</span><span class="p">,</span><span class="n">D1Mgwt</span><span class="p">,</span><span class="n">D1Mguw</span>
    <span class="k">del</span> <span class="n">D2Agwt</span><span class="p">,</span><span class="n">D2Aguw</span><span class="p">,</span><span class="n">D2Sgwt</span><span class="p">,</span><span class="n">D2Sguw</span><span class="p">,</span><span class="n">D2Mgwt</span><span class="p">,</span><span class="n">D2Mguw</span>
    <span class="k">del</span> <span class="n">D1Agwt_df</span><span class="p">,</span><span class="n">D1Aguw_df</span><span class="p">,</span><span class="n">D1Sgwt_df</span><span class="p">,</span><span class="n">D1Sguw_df</span><span class="p">,</span><span class="n">D1Mgwt_df</span><span class="p">,</span><span class="n">D1Mguw_df</span>
    <span class="k">del</span> <span class="n">D2Agwt_df</span><span class="p">,</span><span class="n">D2Aguw_df</span><span class="p">,</span><span class="n">D2Sgwt_df</span><span class="p">,</span><span class="n">D2Sguw_df</span><span class="p">,</span><span class="n">D2Mgwt_df</span><span class="p">,</span><span class="n">D2Mguw_df</span>
    
    <span class="c1">#%%%% 6.4.5 Method E</span>
    <span class="n">timings</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mf">6.45</span><span class="p">]</span><span class="o">=</span><span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span>
    <span class="n">log_custom</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">   Timing </span><span class="si">%f</span><span class="s2">: </span><span class="si">%.5f</span><span class="s2"> s&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">timings</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span>
                                       <span class="n">timings</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">timings</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span>
                   <span class="o">**</span><span class="n">log_scopt</span><span class="p">)</span>    
    
    <span class="n">E4A</span> <span class="o">=</span> <span class="n">emeb</span><span class="o">.</span><span class="n">evaluation</span><span class="o">.</span><span class="n">YM_eva_method_E</span><span class="p">(</span>
        <span class="n">Force_ser</span><span class="o">=</span><span class="n">d_Force</span><span class="p">,</span> <span class="n">length</span><span class="o">=</span><span class="n">Length</span><span class="p">,</span>
        <span class="n">func_curve</span><span class="o">=</span><span class="n">bl</span><span class="p">[</span><span class="s1">&#39;w_A&#39;</span><span class="p">][</span><span class="s1">&#39;d2&#39;</span><span class="p">],</span> 
        <span class="n">params_curve</span><span class="o">=</span><span class="n">Pre_inc_fit_df</span><span class="o">.</span><span class="n">loc</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)[</span><span class="s1">&#39;Fit_params_dict&#39;</span><span class="p">],</span>
        <span class="n">func_MoI</span><span class="o">=</span><span class="n">func_I</span><span class="p">,</span>
        <span class="n">func_thick</span><span class="o">=</span><span class="n">func_t</span><span class="p">,</span> <span class="n">evopt</span><span class="o">=</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span>
        <span class="n">opt_det</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
        <span class="n">opt_g</span><span class="o">=</span><span class="s1">&#39;strain&#39;</span><span class="p">,</span> <span class="n">opt_g_lim</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;E4A&#39;</span>
        <span class="p">)</span>
    <span class="n">E4A_E_df</span><span class="p">,</span> <span class="n">E4A_sig_eps_df</span><span class="p">,</span> <span class="n">E4A_E_to_x</span><span class="p">,</span> <span class="n">E4A_stress_df</span><span class="p">,</span> <span class="n">E4A_strain_df</span><span class="p">,</span> <span class="n">E4A_E_to_x_g</span> <span class="o">=</span> <span class="n">E4A</span>

    <span class="n">E4S</span> <span class="o">=</span> <span class="n">emeb</span><span class="o">.</span><span class="n">evaluation</span><span class="o">.</span><span class="n">YM_eva_method_E</span><span class="p">(</span>
        <span class="n">Force_ser</span><span class="o">=</span><span class="n">d_Force</span><span class="p">,</span> <span class="n">length</span><span class="o">=</span><span class="n">Length</span><span class="p">,</span>
        <span class="n">func_curve</span><span class="o">=</span><span class="n">bl</span><span class="p">[</span><span class="s1">&#39;w_S&#39;</span><span class="p">][</span><span class="s1">&#39;d2&#39;</span><span class="p">],</span> 
        <span class="n">params_curve</span><span class="o">=</span><span class="n">Pre_inc_fit_df</span><span class="o">.</span><span class="n">loc</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)[</span><span class="s1">&#39;Fit_params_dict&#39;</span><span class="p">],</span>
        <span class="n">func_MoI</span><span class="o">=</span><span class="n">func_I</span><span class="p">,</span>
        <span class="n">func_thick</span><span class="o">=</span><span class="n">func_t</span><span class="p">,</span> <span class="n">evopt</span><span class="o">=</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span>
        <span class="n">opt_det</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
        <span class="n">opt_g</span><span class="o">=</span><span class="s1">&#39;strain&#39;</span><span class="p">,</span> <span class="n">opt_g_lim</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;E4S&#39;</span>
        <span class="p">)</span>
    <span class="n">E4S_E_df</span><span class="p">,</span> <span class="n">E4S_sig_eps_df</span><span class="p">,</span> <span class="n">E4S_E_to_x</span><span class="p">,</span> <span class="n">E4S_stress_df</span><span class="p">,</span> <span class="n">E4S_strain_df</span><span class="p">,</span> <span class="n">E4S_E_to_x_g</span> <span class="o">=</span> <span class="n">E4S</span>

    <span class="n">E4M</span> <span class="o">=</span> <span class="n">emeb</span><span class="o">.</span><span class="n">evaluation</span><span class="o">.</span><span class="n">YM_eva_method_E</span><span class="p">(</span>
        <span class="n">Force_ser</span><span class="o">=</span><span class="n">d_Force</span><span class="p">,</span> <span class="n">length</span><span class="o">=</span><span class="n">Length</span><span class="p">,</span>
        <span class="n">func_curve</span><span class="o">=</span><span class="n">bl</span><span class="p">[</span><span class="s1">&#39;w_M&#39;</span><span class="p">][</span><span class="s1">&#39;d2&#39;</span><span class="p">],</span> 
        <span class="n">params_curve</span><span class="o">=</span><span class="n">Bend_inc_fit_df</span><span class="o">.</span><span class="n">loc</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)[</span><span class="s1">&#39;Fit_params_dict&#39;</span><span class="p">],</span>
        <span class="n">func_MoI</span><span class="o">=</span><span class="n">func_I</span><span class="p">,</span> 
        <span class="n">func_thick</span><span class="o">=</span><span class="n">func_t</span><span class="p">,</span> <span class="n">evopt</span><span class="o">=</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span>
        <span class="n">opt_det</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
        <span class="n">opt_g</span><span class="o">=</span><span class="s1">&#39;strain&#39;</span><span class="p">,</span> <span class="n">opt_g_lim</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;E4M&#39;</span>
        <span class="p">)</span>
    <span class="n">E4M_E_df</span><span class="p">,</span> <span class="n">E4M_sig_eps_df</span><span class="p">,</span> <span class="n">E4M_E_to_x</span><span class="p">,</span> <span class="n">E4M_stress_df</span><span class="p">,</span> <span class="n">E4M_strain_df</span><span class="p">,</span> <span class="n">E4M_E_to_x_g</span> <span class="o">=</span> <span class="n">E4M</span>

    <span class="n">E_E_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">E4A_E_df</span><span class="p">,</span> <span class="n">E4S_E_df</span><span class="p">,</span> <span class="n">E4M_E_df</span><span class="p">],</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">E_E</span> <span class="o">=</span> <span class="n">emec</span><span class="o">.</span><span class="n">stat_ext</span><span class="o">.</span><span class="n">pd_agg</span><span class="p">(</span><span class="n">E_E_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">sr_eva_dic</span><span class="p">])</span>
    
    <span class="k">if</span> <span class="kc">True</span><span class="p">:</span>
        <span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="n">ax1</span><span class="p">,</span><span class="n">ax2</span><span class="p">,</span><span class="n">ax3</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> 
                                          <span class="n">sharex</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> 
                                          <span class="n">figsize</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">figsize</span><span class="p">,[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">]))</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> - M - Stress, Strain, Youngs-Modulus to x-coordinate for F3 to F4&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">plt_name</span><span class="p">))</span>
        <span class="n">ax1</span> <span class="o">=</span> <span class="n">emeb</span><span class="o">.</span><span class="n">plotting</span><span class="o">.</span><span class="n">colplt_common_ax</span><span class="p">(</span>
            <span class="n">xdata</span><span class="o">=</span><span class="n">E4M_stress_df</span><span class="o">.</span><span class="n">columns</span><span class="p">,</span>
            <span class="n">ydata</span><span class="o">=</span><span class="n">E4M_stress_df</span><span class="p">,</span>
            <span class="n">step_range</span><span class="o">=</span><span class="n">sr_eva_dic</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax1</span><span class="p">,</span>
            <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Stress to x over Increment&#39;</span><span class="p">,</span>
            <span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;x / mm&#39;</span><span class="p">,</span> 
            <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;$\sigma$ / MPa&#39;</span>
            <span class="p">)</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
        <span class="n">ax2</span> <span class="o">=</span> <span class="n">emeb</span><span class="o">.</span><span class="n">plotting</span><span class="o">.</span><span class="n">colplt_common_ax</span><span class="p">(</span>
            <span class="n">xdata</span><span class="o">=</span><span class="n">E4M_strain_df</span><span class="o">.</span><span class="n">columns</span><span class="p">,</span>
            <span class="n">ydata</span><span class="o">=</span><span class="n">E4M_strain_df</span><span class="p">,</span>
            <span class="n">step_range</span><span class="o">=</span><span class="n">sr_eva_dic</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax2</span><span class="p">,</span>
            <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Strain to x over Increment&#39;</span><span class="p">,</span>
            <span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;x / mm&#39;</span><span class="p">,</span> 
            <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;$\sigma$ / MPa&#39;</span>
            <span class="p">)</span>
        <span class="n">ax2</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
        <span class="n">ax3</span> <span class="o">=</span> <span class="n">emeb</span><span class="o">.</span><span class="n">plotting</span><span class="o">.</span><span class="n">colplt_common_ax</span><span class="p">(</span>
            <span class="n">xdata</span><span class="o">=</span><span class="n">E4M_E_to_x_g</span><span class="o">.</span><span class="n">columns</span><span class="p">,</span>
            <span class="n">ydata</span><span class="o">=</span><span class="n">E4M_E_to_x_g</span><span class="p">,</span>
            <span class="n">step_range</span><span class="o">=</span><span class="n">sr_eva_dic</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax3</span><span class="p">,</span>
            <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Youngs Modulus to x over Increment&#39;</span><span class="p">,</span>
            <span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;x / mm&#39;</span><span class="p">,</span>
            <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;E / MPa&#39;</span>
            <span class="p">)</span>
        <span class="n">ax3</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
        <span class="n">plt_hsuf</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span><span class="n">path</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="o">**</span><span class="n">plt_scopt</span><span class="p">)</span>
        
        <span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="n">ax1</span><span class="p">,</span><span class="n">ax2</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> 
                                      <span class="n">sharex</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> 
                                      <span class="n">figsize</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">figsize</span><span class="p">,[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">]))</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1"> - Compare method E&#39;</span><span class="o">%</span><span class="p">(</span><span class="n">plt_name</span><span class="p">))</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;All Steps&#39;</span><span class="p">)</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Step / -&#39;</span><span class="p">)</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;E / MPa&#39;</span><span class="p">)</span>
        <span class="n">cc</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;E4Sl&#39;</span><span class="p">:</span><span class="s1">&#39;r:&#39;</span><span class="p">,</span><span class="s1">&#39;E4Se&#39;</span><span class="p">:</span><span class="s1">&#39;b:&#39;</span><span class="p">,</span><span class="s1">&#39;E4Sg&#39;</span><span class="p">:</span><span class="s1">&#39;g:&#39;</span><span class="p">,</span>
            <span class="s1">&#39;E4Ml&#39;</span><span class="p">:</span><span class="s1">&#39;r--&#39;</span><span class="p">,</span><span class="s1">&#39;E4Me&#39;</span><span class="p">:</span><span class="s1">&#39;b--&#39;</span><span class="p">,</span><span class="s1">&#39;E4Mg&#39;</span><span class="p">:</span><span class="s1">&#39;g--&#39;</span><span class="p">}</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">cc</span><span class="p">:</span>
            <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">E_E_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:</span><span class="n">VIP_messu</span><span class="p">[</span><span class="s1">&#39;U&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">index</span><span class="p">,</span>
                     <span class="n">E_E_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:</span><span class="n">VIP_messu</span><span class="p">[</span><span class="s1">&#39;U&#39;</span><span class="p">]][</span><span class="n">k</span><span class="p">],</span>
                     <span class="n">cc</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1"> - </span><span class="si">%.2f</span><span class="s1"> MPa&#39;</span><span class="o">%</span><span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="n">E_E</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="s1">&#39;mean&#39;</span><span class="p">,</span><span class="n">k</span><span class="p">]))</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">VIP_dicu</span><span class="p">[</span><span class="s1">&#39;F3&#39;</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;olive&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">)</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">VIP_dicu</span><span class="p">[</span><span class="s1">&#39;F4&#39;</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;olive&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
        <span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Improved determination range&#39;</span><span class="p">)</span>
        <span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Step / -&#39;</span><span class="p">)</span>
        <span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;E / MPa&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">cc</span><span class="p">:</span>
            <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">sr_eva_dic</span><span class="p">,</span><span class="n">E_E_df</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">sr_eva_dic</span><span class="p">],</span> <span class="n">cc</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
        <span class="n">plt_hsuf</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span><span class="n">path</span><span class="o">=</span><span class="n">out_full</span><span class="o">+</span><span class="s2">&quot;-YM-Me_E&quot;</span><span class="p">,</span><span class="o">**</span><span class="n">plt_scopt</span><span class="p">)</span>
        
    <span class="k">del</span> <span class="n">E4A</span><span class="p">,</span> <span class="n">E4A_E_df</span><span class="p">,</span> <span class="n">E4A_sig_eps_df</span><span class="p">,</span> <span class="n">E4A_E_to_x</span><span class="p">,</span> <span class="n">E4A_stress_df</span><span class="p">,</span> <span class="n">E4A_strain_df</span><span class="p">,</span> <span class="n">E4A_E_to_x_g</span>
    <span class="k">del</span> <span class="n">E4S</span><span class="p">,</span> <span class="n">E4S_E_df</span><span class="p">,</span> <span class="n">E4S_sig_eps_df</span><span class="p">,</span> <span class="n">E4S_E_to_x</span><span class="p">,</span> <span class="n">E4S_stress_df</span><span class="p">,</span> <span class="n">E4S_strain_df</span><span class="p">,</span> <span class="n">E4S_E_to_x_g</span>
    <span class="k">del</span> <span class="n">E4M</span><span class="p">,</span> <span class="n">E4M_E_df</span><span class="p">,</span> <span class="n">E4M_sig_eps_df</span><span class="p">,</span> <span class="n">E4M_E_to_x</span><span class="p">,</span> <span class="n">E4M_stress_df</span><span class="p">,</span> <span class="n">E4M_strain_df</span><span class="p">,</span> <span class="n">E4M_E_to_x_g</span>

    <span class="c1">#%%%% 6.4.6 Method F</span>
    <span class="n">timings</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mf">6.46</span><span class="p">]</span><span class="o">=</span><span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span>
    <span class="n">log_custom</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">   Timing </span><span class="si">%f</span><span class="s2">: </span><span class="si">%.5f</span><span class="s2"> s&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">timings</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span>
                                       <span class="n">timings</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">timings</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span>
                   <span class="o">**</span><span class="n">log_scopt</span><span class="p">)</span>    
    
    <span class="n">F4A_df</span> <span class="o">=</span> <span class="n">emeb</span><span class="o">.</span><span class="n">evaluation</span><span class="o">.</span><span class="n">YM_eva_method_F</span><span class="p">(</span><span class="n">c_func</span><span class="o">=</span><span class="n">bl</span><span class="p">[</span><span class="s1">&#39;w_A&#39;</span><span class="p">][</span><span class="s1">&#39;d2&#39;</span><span class="p">],</span>
                              <span class="n">c_params</span><span class="o">=</span><span class="n">Pre_inc_fit_df</span><span class="o">.</span><span class="n">loc</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)[</span><span class="s1">&#39;Fit_params_dict&#39;</span><span class="p">],</span>
                              <span class="n">Force_ser</span><span class="o">=</span><span class="n">d_Force</span><span class="p">,</span> <span class="n">Length</span><span class="o">=</span><span class="n">Length</span><span class="p">,</span> <span class="n">func_I</span><span class="o">=</span><span class="n">func_I</span><span class="p">,</span>
                              <span class="n">weighted</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">weight_func</span><span class="o">=</span><span class="n">emeb</span><span class="o">.</span><span class="n">evaluation</span><span class="o">.</span><span class="n">Weight_func</span><span class="p">,</span>
                              <span class="n">wargs</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Custom_cut&#39;</span><span class="p">,</span> <span class="n">bl</span><span class="p">[</span><span class="s1">&#39;w_A&#39;</span><span class="p">][</span><span class="s1">&#39;d0&#39;</span><span class="p">]],</span>
                              <span class="n">wkwargs</span><span class="o">=</span><span class="n">Pre_inc_fit_df</span><span class="o">.</span><span class="n">loc</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)[</span><span class="s1">&#39;Fit_params_dict&#39;</span><span class="p">],</span>
                              <span class="n">xr_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;fu&#39;</span><span class="p">:</span><span class="mi">1</span><span class="o">/</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;ha&#39;</span><span class="p">:</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;th&#39;</span><span class="p">:</span><span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">},</span>
                              <span class="n">pb_b</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;F4Ag&#39;</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
    
    <span class="n">F4S_df</span> <span class="o">=</span> <span class="n">emeb</span><span class="o">.</span><span class="n">evaluation</span><span class="o">.</span><span class="n">YM_eva_method_F</span><span class="p">(</span><span class="n">c_func</span><span class="o">=</span><span class="n">bl</span><span class="p">[</span><span class="s1">&#39;w_S&#39;</span><span class="p">][</span><span class="s1">&#39;d2&#39;</span><span class="p">],</span>
                              <span class="n">c_params</span><span class="o">=</span><span class="n">Pre_inc_fit_df</span><span class="o">.</span><span class="n">loc</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)[</span><span class="s1">&#39;Fit_params_dict&#39;</span><span class="p">],</span>
                              <span class="n">Force_ser</span><span class="o">=</span><span class="n">d_Force</span><span class="p">,</span> <span class="n">Length</span><span class="o">=</span><span class="n">Length</span><span class="p">,</span> <span class="n">func_I</span><span class="o">=</span><span class="n">func_I</span><span class="p">,</span>
                              <span class="n">weighted</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">weight_func</span><span class="o">=</span><span class="n">emeb</span><span class="o">.</span><span class="n">evaluation</span><span class="o">.</span><span class="n">Weight_func</span><span class="p">,</span>
                              <span class="n">wargs</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Custom_cut&#39;</span><span class="p">,</span> <span class="n">bl</span><span class="p">[</span><span class="s1">&#39;w_S&#39;</span><span class="p">][</span><span class="s1">&#39;d0&#39;</span><span class="p">]],</span>
                              <span class="n">wkwargs</span><span class="o">=</span><span class="n">Pre_inc_fit_df</span><span class="o">.</span><span class="n">loc</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)[</span><span class="s1">&#39;Fit_params_dict&#39;</span><span class="p">],</span>
                              <span class="n">xr_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;fu&#39;</span><span class="p">:</span><span class="mi">1</span><span class="o">/</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;ha&#39;</span><span class="p">:</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;th&#39;</span><span class="p">:</span><span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">},</span>
                              <span class="n">pb_b</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;F4Sg&#39;</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
    
    <span class="n">F4M_df</span> <span class="o">=</span> <span class="n">emeb</span><span class="o">.</span><span class="n">evaluation</span><span class="o">.</span><span class="n">YM_eva_method_F</span><span class="p">(</span><span class="n">c_func</span><span class="o">=</span><span class="n">bl</span><span class="p">[</span><span class="s1">&#39;w_M&#39;</span><span class="p">][</span><span class="s1">&#39;d2&#39;</span><span class="p">],</span>
                              <span class="n">c_params</span><span class="o">=</span><span class="n">Bend_inc_fit_df</span><span class="o">.</span><span class="n">loc</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)[</span><span class="s1">&#39;Fit_params_dict&#39;</span><span class="p">],</span>
                              <span class="n">Force_ser</span><span class="o">=</span><span class="n">d_Force</span><span class="p">,</span> <span class="n">Length</span><span class="o">=</span><span class="n">Length</span><span class="p">,</span> <span class="n">func_I</span><span class="o">=</span><span class="n">func_I</span><span class="p">,</span>
                              <span class="n">weighted</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">weight_func</span><span class="o">=</span><span class="n">emeb</span><span class="o">.</span><span class="n">evaluation</span><span class="o">.</span><span class="n">Weight_func</span><span class="p">,</span>
                              <span class="n">wargs</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Custom_cut&#39;</span><span class="p">,</span> <span class="n">bl</span><span class="p">[</span><span class="s1">&#39;w_M&#39;</span><span class="p">][</span><span class="s1">&#39;d0&#39;</span><span class="p">]],</span>
                              <span class="n">wkwargs</span><span class="o">=</span><span class="n">Bend_inc_fit_df</span><span class="o">.</span><span class="n">loc</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)[</span><span class="s1">&#39;Fit_params_dict&#39;</span><span class="p">],</span>
                              <span class="n">xr_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;fu&#39;</span><span class="p">:</span><span class="mi">1</span><span class="o">/</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;ha&#39;</span><span class="p">:</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;th&#39;</span><span class="p">:</span><span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">},</span>
                              <span class="n">pb_b</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;F4Mg&#39;</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
    
    <span class="n">E_F_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">F4A_df</span><span class="p">,</span> <span class="n">F4S_df</span><span class="p">,</span> <span class="n">F4M_df</span><span class="p">],</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">E_F</span> <span class="o">=</span> <span class="n">emec</span><span class="o">.</span><span class="n">stat_ext</span><span class="o">.</span><span class="n">pd_agg</span><span class="p">(</span><span class="n">E_F_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">sr_eva_dic</span><span class="p">])</span>
    
    <span class="k">if</span> <span class="kc">True</span><span class="p">:</span>    
        <span class="n">cc</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;F4Agha&#39;</span><span class="p">:</span><span class="s1">&#39;r:&#39;</span><span class="p">,</span> <span class="s1">&#39;F4Agth&#39;</span><span class="p">:</span><span class="s1">&#39;r--&#39;</span><span class="p">,</span>
            <span class="s1">&#39;F4Sgha&#39;</span><span class="p">:</span><span class="s1">&#39;b:&#39;</span><span class="p">,</span> <span class="s1">&#39;F4Sgth&#39;</span><span class="p">:</span><span class="s1">&#39;b--&#39;</span><span class="p">,</span>
            <span class="s1">&#39;F4Mgha&#39;</span><span class="p">:</span><span class="s1">&#39;g:&#39;</span><span class="p">,</span> <span class="s1">&#39;F4Mgth&#39;</span><span class="p">:</span><span class="s1">&#39;g--&#39;</span><span class="p">}</span>
        <span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="n">ax1</span><span class="p">,</span><span class="n">ax2</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> 
                                      <span class="n">sharex</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> 
                                      <span class="n">figsize</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">figsize</span><span class="p">,[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">]))</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1"> - Compare method F&#39;</span><span class="o">%</span><span class="p">(</span><span class="n">plt_name</span><span class="p">))</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;All Steps&#39;</span><span class="p">)</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Step / -&#39;</span><span class="p">)</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;E / MPa&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">cc</span><span class="p">:</span>
            <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">E_F_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:</span><span class="n">VIP_messu</span><span class="p">[</span><span class="s1">&#39;U&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">index</span><span class="p">,</span>
                     <span class="n">E_F_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:</span><span class="n">VIP_messu</span><span class="p">[</span><span class="s1">&#39;U&#39;</span><span class="p">]][</span><span class="n">k</span><span class="p">],</span>
                     <span class="n">cc</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1"> - </span><span class="si">%.2f</span><span class="s1"> MPa&#39;</span><span class="o">%</span><span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="n">E_F</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="s1">&#39;mean&#39;</span><span class="p">,</span><span class="n">k</span><span class="p">]))</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">VIP_dicu</span><span class="p">[</span><span class="s1">&#39;F3&#39;</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;olive&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">)</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">VIP_dicu</span><span class="p">[</span><span class="s1">&#39;F4&#39;</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;olive&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
        <span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Improved determination range&#39;</span><span class="p">)</span>
        <span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Step / -&#39;</span><span class="p">)</span>
        <span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;E / MPa&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">cc</span><span class="p">:</span>
            <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">sr_eva_dic</span><span class="p">,</span><span class="n">E_F_df</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">sr_eva_dic</span><span class="p">],</span> <span class="n">cc</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
        <span class="n">plt_hsuf</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span><span class="n">path</span><span class="o">=</span><span class="n">out_full</span><span class="o">+</span><span class="s2">&quot;-YM-Me_F&quot;</span><span class="p">,</span><span class="o">**</span><span class="n">plt_scopt</span><span class="p">)</span>
        
    <span class="k">del</span> <span class="n">F4A_df</span><span class="p">,</span> <span class="n">F4S_df</span><span class="p">,</span> <span class="n">F4M_df</span>
    
    <span class="c1">#%%%% 6.4.7 Method G</span>
    <span class="n">timings</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mf">6.47</span><span class="p">]</span><span class="o">=</span><span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span>
    <span class="n">log_custom</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">   Timing </span><span class="si">%f</span><span class="s2">: </span><span class="si">%.5f</span><span class="s2"> s&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">timings</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span>
                                       <span class="n">timings</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">timings</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span>
                   <span class="o">**</span><span class="n">log_scopt</span><span class="p">)</span>    
    
    <span class="n">E_G3Ag_ser</span> <span class="o">=</span> <span class="n">emeb</span><span class="o">.</span><span class="n">evaluation</span><span class="o">.</span><span class="n">YM_eva_method_G</span><span class="p">(</span>
        <span class="n">Force_ser</span><span class="o">=</span><span class="n">d_Force</span><span class="p">,</span>
        <span class="n">w_func_f_0</span><span class="o">=</span><span class="n">bl</span><span class="p">[</span><span class="s1">&#39;w_A&#39;</span><span class="p">][</span><span class="s1">&#39;d0&#39;</span><span class="p">],</span> 
        <span class="n">w_params</span><span class="o">=</span><span class="n">Pre_inc_fit_df</span><span class="o">.</span><span class="n">loc</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)[</span><span class="s1">&#39;Fit_params_dict&#39;</span><span class="p">],</span>
        <span class="n">c_func</span><span class="o">=</span><span class="n">bl</span><span class="p">[</span><span class="s1">&#39;w_A&#39;</span><span class="p">][</span><span class="s1">&#39;d2&#39;</span><span class="p">],</span>
        <span class="n">r_func</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">c_params</span><span class="o">=</span><span class="n">Pre_inc_fit_df</span><span class="o">.</span><span class="n">loc</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)[</span><span class="s1">&#39;Fit_params_dict&#39;</span><span class="p">],</span>
        <span class="n">r_params</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">length</span><span class="o">=</span><span class="n">Length</span><span class="p">,</span> <span class="n">I_func</span><span class="o">=</span><span class="n">func_I</span><span class="p">,</span> <span class="n">A_func</span><span class="o">=</span><span class="n">func_A</span><span class="p">,</span>
        <span class="n">CS_type</span><span class="o">=</span><span class="s1">&#39;Rectangle&#39;</span><span class="p">,</span> <span class="n">kappa</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">poisson</span><span class="o">=</span><span class="n">_opts</span><span class="p">[</span><span class="s1">&#39;OPT_Poisson_prediction&#39;</span><span class="p">],</span>
        <span class="n">comp</span><span class="o">=</span><span class="n">_opts</span><span class="p">[</span><span class="s1">&#39;OPT_Compression&#39;</span><span class="p">],</span>
        <span class="n">option</span><span class="o">=</span><span class="s2">&quot;ignore_V&quot;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;G3Ag&quot;</span>
        <span class="p">)</span>
    <span class="n">E_G3Sg_ser</span> <span class="o">=</span> <span class="n">emeb</span><span class="o">.</span><span class="n">evaluation</span><span class="o">.</span><span class="n">YM_eva_method_G</span><span class="p">(</span>
        <span class="n">Force_ser</span><span class="o">=</span><span class="n">d_Force</span><span class="p">,</span>
        <span class="n">w_func_f_0</span><span class="o">=</span><span class="n">bl</span><span class="p">[</span><span class="s1">&#39;w_S&#39;</span><span class="p">][</span><span class="s1">&#39;d0&#39;</span><span class="p">],</span> 
        <span class="n">w_params</span><span class="o">=</span><span class="n">Pre_inc_fit_df</span><span class="o">.</span><span class="n">loc</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)[</span><span class="s1">&#39;Fit_params_dict&#39;</span><span class="p">],</span>
        <span class="n">c_func</span><span class="o">=</span><span class="n">bl</span><span class="p">[</span><span class="s1">&#39;w_S&#39;</span><span class="p">][</span><span class="s1">&#39;d2&#39;</span><span class="p">],</span>
        <span class="n">r_func</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">c_params</span><span class="o">=</span><span class="n">Pre_inc_fit_df</span><span class="o">.</span><span class="n">loc</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)[</span><span class="s1">&#39;Fit_params_dict&#39;</span><span class="p">],</span>
        <span class="n">r_params</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">length</span><span class="o">=</span><span class="n">Length</span><span class="p">,</span> <span class="n">I_func</span><span class="o">=</span><span class="n">func_I</span><span class="p">,</span> <span class="n">A_func</span><span class="o">=</span><span class="n">func_A</span><span class="p">,</span>
        <span class="n">CS_type</span><span class="o">=</span><span class="s1">&#39;Rectangle&#39;</span><span class="p">,</span> <span class="n">kappa</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">poisson</span><span class="o">=</span><span class="n">_opts</span><span class="p">[</span><span class="s1">&#39;OPT_Poisson_prediction&#39;</span><span class="p">],</span>
        <span class="n">comp</span><span class="o">=</span><span class="n">_opts</span><span class="p">[</span><span class="s1">&#39;OPT_Compression&#39;</span><span class="p">],</span>
        <span class="n">option</span><span class="o">=</span><span class="s2">&quot;ignore_V&quot;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;G3Sg&quot;</span>
        <span class="p">)</span>
    <span class="n">E_G3Mg_ser</span> <span class="o">=</span> <span class="n">emeb</span><span class="o">.</span><span class="n">evaluation</span><span class="o">.</span><span class="n">YM_eva_method_G</span><span class="p">(</span>
        <span class="n">Force_ser</span><span class="o">=</span><span class="n">d_Force</span><span class="p">,</span>
        <span class="n">w_func_f_0</span><span class="o">=</span><span class="n">bl</span><span class="p">[</span><span class="s1">&#39;w_M&#39;</span><span class="p">][</span><span class="s1">&#39;d0&#39;</span><span class="p">],</span> 
        <span class="n">w_params</span><span class="o">=</span><span class="n">Pre_inc_fit_df</span><span class="o">.</span><span class="n">loc</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)[</span><span class="s1">&#39;Fit_params_dict&#39;</span><span class="p">],</span>
        <span class="n">c_func</span><span class="o">=</span><span class="n">bl</span><span class="p">[</span><span class="s1">&#39;w_M&#39;</span><span class="p">][</span><span class="s1">&#39;d2&#39;</span><span class="p">],</span>
        <span class="n">r_func</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">c_params</span><span class="o">=</span><span class="n">Bend_inc_fit_df</span><span class="o">.</span><span class="n">loc</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)[</span><span class="s1">&#39;Fit_params_dict&#39;</span><span class="p">],</span>
        <span class="n">r_params</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">length</span><span class="o">=</span><span class="n">Length</span><span class="p">,</span> <span class="n">I_func</span><span class="o">=</span><span class="n">func_I</span><span class="p">,</span> <span class="n">A_func</span><span class="o">=</span><span class="n">func_A</span><span class="p">,</span>
        <span class="n">CS_type</span><span class="o">=</span><span class="s1">&#39;Rectangle&#39;</span><span class="p">,</span> <span class="n">kappa</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">poisson</span><span class="o">=</span><span class="n">_opts</span><span class="p">[</span><span class="s1">&#39;OPT_Poisson_prediction&#39;</span><span class="p">],</span>
        <span class="n">comp</span><span class="o">=</span><span class="n">_opts</span><span class="p">[</span><span class="s1">&#39;OPT_Compression&#39;</span><span class="p">],</span>
        <span class="n">option</span><span class="o">=</span><span class="s2">&quot;ignore_V&quot;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;G3Mg&quot;</span>
        <span class="p">)</span>
    <span class="n">E_G3Cg_ser</span> <span class="o">=</span> <span class="n">emeb</span><span class="o">.</span><span class="n">evaluation</span><span class="o">.</span><span class="n">YM_eva_method_G</span><span class="p">(</span>
        <span class="n">Force_ser</span><span class="o">=</span><span class="n">d_Force</span><span class="p">,</span>
        <span class="n">w_func_f_0</span><span class="o">=</span><span class="n">bl</span><span class="p">[</span><span class="s1">&#39;w_S&#39;</span><span class="p">][</span><span class="s1">&#39;d0&#39;</span><span class="p">],</span> 
        <span class="n">w_params</span><span class="o">=</span><span class="n">Pre_inc_fit_df</span><span class="o">.</span><span class="n">loc</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)[</span><span class="s1">&#39;Fit_params_dict&#39;</span><span class="p">],</span>
        <span class="n">c_func</span><span class="o">=</span><span class="n">bl</span><span class="p">[</span><span class="s1">&#39;w_M&#39;</span><span class="p">][</span><span class="s1">&#39;d2&#39;</span><span class="p">],</span>
        <span class="n">r_func</span><span class="o">=</span><span class="n">bl</span><span class="p">[</span><span class="s1">&#39;w_V&#39;</span><span class="p">][</span><span class="s1">&#39;d1&#39;</span><span class="p">],</span>
        <span class="n">c_params</span><span class="o">=</span><span class="n">Bend_inc_fit_df</span><span class="o">.</span><span class="n">loc</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)[</span><span class="s1">&#39;Fit_params_dict&#39;</span><span class="p">],</span>
        <span class="n">r_params</span><span class="o">=</span><span class="n">Pre_inc_fit_df</span><span class="o">.</span><span class="n">loc</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)[</span><span class="s1">&#39;Fit_params_dict&#39;</span><span class="p">],</span>
        <span class="n">length</span><span class="o">=</span><span class="n">Length</span><span class="p">,</span> <span class="n">I_func</span><span class="o">=</span><span class="n">func_I</span><span class="p">,</span> <span class="n">A_func</span><span class="o">=</span><span class="n">func_A</span><span class="p">,</span>
        <span class="n">CS_type</span><span class="o">=</span><span class="s1">&#39;Rectangle&#39;</span><span class="p">,</span> <span class="n">kappa</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">poisson</span><span class="o">=</span><span class="n">_opts</span><span class="p">[</span><span class="s1">&#39;OPT_Poisson_prediction&#39;</span><span class="p">],</span>
        <span class="n">comp</span><span class="o">=</span><span class="n">_opts</span><span class="p">[</span><span class="s1">&#39;OPT_Compression&#39;</span><span class="p">],</span>
        <span class="n">option</span><span class="o">=</span><span class="s2">&quot;M+V&quot;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;G3Cg&quot;</span>
        <span class="p">)</span>
    <span class="n">E_G_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">E_G3Ag_ser</span><span class="p">,</span> <span class="n">E_G3Sg_ser</span><span class="p">,</span> <span class="n">E_G3Mg_ser</span><span class="p">,</span> <span class="n">E_G3Cg_ser</span><span class="p">],</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">E_G</span> <span class="o">=</span> <span class="n">emec</span><span class="o">.</span><span class="n">stat_ext</span><span class="o">.</span><span class="n">pd_agg</span><span class="p">(</span><span class="n">E_G_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">sr_eva_dic</span><span class="p">])</span>
    
    <span class="k">if</span> <span class="kc">True</span><span class="p">:</span>    
        <span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="n">ax1</span><span class="p">,</span><span class="n">ax2</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> 
                                      <span class="n">sharex</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> 
                                      <span class="n">figsize</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">figsize</span><span class="p">,[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">]))</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1"> - Compare method G&#39;</span><span class="o">%</span><span class="p">(</span><span class="n">plt_name</span><span class="p">))</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;All Steps&#39;</span><span class="p">)</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Step / -&#39;</span><span class="p">)</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;E / MPa&#39;</span><span class="p">)</span>
        <span class="c1"># cc={&#39;G3Sg&#39;:&#39;r:&#39;,&#39;G3Mg&#39;:&#39;b--&#39;}</span>
        <span class="n">cc</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;G3Ag&#39;</span><span class="p">:</span><span class="s1">&#39;r:&#39;</span><span class="p">,</span> <span class="s1">&#39;G3Sg&#39;</span><span class="p">:</span><span class="s1">&#39;b:&#39;</span><span class="p">,</span> <span class="s1">&#39;G3Mg&#39;</span><span class="p">:</span><span class="s1">&#39;m--&#39;</span><span class="p">,</span> <span class="s1">&#39;G3Cg&#39;</span><span class="p">:</span><span class="s1">&#39;g--&#39;</span><span class="p">}</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">cc</span><span class="p">:</span>
            <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">E_G_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:</span><span class="n">VIP_messu</span><span class="p">[</span><span class="s1">&#39;U&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">index</span><span class="p">,</span>
                     <span class="n">E_G_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:</span><span class="n">VIP_messu</span><span class="p">[</span><span class="s1">&#39;U&#39;</span><span class="p">]][</span><span class="n">k</span><span class="p">],</span>
                     <span class="n">cc</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1"> - </span><span class="si">%.2f</span><span class="s1"> MPa&#39;</span><span class="o">%</span><span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="n">E_G</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="s1">&#39;mean&#39;</span><span class="p">,</span><span class="n">k</span><span class="p">]))</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">VIP_dicu</span><span class="p">[</span><span class="s1">&#39;F3&#39;</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;olive&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">)</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">VIP_dicu</span><span class="p">[</span><span class="s1">&#39;F4&#39;</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;olive&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
        <span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Improved determination range&#39;</span><span class="p">)</span>
        <span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Step / -&#39;</span><span class="p">)</span>
        <span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;E / MPa&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">cc</span><span class="p">:</span>
            <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">sr_eva_dic</span><span class="p">,</span><span class="n">E_G_df</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">sr_eva_dic</span><span class="p">],</span> <span class="n">cc</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
        <span class="n">plt_hsuf</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span><span class="n">path</span><span class="o">=</span><span class="n">out_full</span><span class="o">+</span><span class="s2">&quot;-YM-Me_G&quot;</span><span class="p">,</span><span class="o">**</span><span class="n">plt_scopt</span><span class="p">)</span>
    
    <span class="k">del</span> <span class="n">E_G3Ag_ser</span><span class="p">,</span> <span class="n">E_G3Sg_ser</span><span class="p">,</span> <span class="n">E_G3Mg_ser</span><span class="p">,</span> <span class="n">E_G3Cg_ser</span>

    <span class="c1">#%%%% 6.4.8 Method compare</span>
    <span class="n">timings</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mf">6.48</span><span class="p">]</span><span class="o">=</span><span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span>
    <span class="n">log_custom</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">   Timing </span><span class="si">%f</span><span class="s2">: </span><span class="si">%.5f</span><span class="s2"> s&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">timings</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span>
                                       <span class="n">timings</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">timings</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span>
                   <span class="o">**</span><span class="n">log_scopt</span><span class="p">)</span>    


    <span class="n">E_lsq</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">E_lsq_A</span><span class="p">,</span><span class="n">E_lsq_B</span><span class="p">],</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

    <span class="c1"># E_Methods = pd.concat([E_A,E_B,E_C,E_D,E_E,E_F,E_G],axis=1)</span>
    <span class="n">E_Methods_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">E_A_df</span><span class="p">,</span><span class="n">E_B_df</span><span class="p">,</span><span class="n">E_C_df</span><span class="p">,</span><span class="n">E_D_df</span><span class="p">,</span><span class="n">E_E_df</span><span class="p">,</span><span class="n">E_F_df</span><span class="p">,</span><span class="n">E_G_df</span><span class="p">],</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">E_agg_funcs</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;mean&#39;</span><span class="p">,</span><span class="n">emec</span><span class="o">.</span><span class="n">stat_ext</span><span class="o">.</span><span class="n">meanwoso</span><span class="p">,</span><span class="s1">&#39;median&#39;</span><span class="p">,</span>
                   <span class="s1">&#39;std&#39;</span><span class="p">,</span><span class="n">emec</span><span class="o">.</span><span class="n">stat_ext</span><span class="o">.</span><span class="n">stdwoso</span><span class="p">,</span><span class="s1">&#39;max&#39;</span><span class="p">,</span><span class="s1">&#39;min&#39;</span><span class="p">]</span>
    
    <span class="n">cols_con</span><span class="o">=</span><span class="n">E_Methods_df</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s1">&#39;0&#39;</span><span class="p">)</span>
    <span class="c1"># E_inc_F_comp_con = emec.pd_ext.pd_agg(E_Methods_df.loc[sf_eva_con,cols_con])</span>
    <span class="c1"># E_inc_F_comp_opt = emec.pd_ext.pd_agg(E_Methods_df.loc[sf_eva_dic,np.invert(cols_con)])</span>
    <span class="n">E_inc_F_comp_con</span> <span class="o">=</span> <span class="n">E_Methods_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">sf_eva_con</span><span class="p">,</span><span class="n">cols_con</span><span class="p">]</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span><span class="n">E_agg_funcs</span><span class="p">)</span>
    <span class="n">E_inc_F_comp_opt</span> <span class="o">=</span> <span class="n">E_Methods_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">sf_eva_dic</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">invert</span><span class="p">(</span><span class="n">cols_con</span><span class="p">)]</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span><span class="n">E_agg_funcs</span><span class="p">)</span>
    <span class="n">E_inc_F_comp</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">E_inc_F_comp_con</span><span class="p">,</span><span class="n">E_inc_F_comp_opt</span><span class="p">],</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">E_inc_F_comp</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;stdn&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">E_inc_F_comp</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;std&#39;</span><span class="p">]</span><span class="o">/</span><span class="n">E_inc_F_comp</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;mean&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">abs</span><span class="p">()</span>
    <span class="c1"># E_inc_F_comp.loc[&#39;stdnwoso&#39;]=E_inc_F_comp.loc[&#39;std&#39;]/E_inc_F_comp.loc[&#39;meanwoso&#39;].abs()</span>
    <span class="n">E_inc_F_comp</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;stdnwoso&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">E_inc_F_comp</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;stdwoso&#39;</span><span class="p">]</span><span class="o">/</span><span class="n">E_inc_F_comp</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;meanwoso&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">abs</span><span class="p">()</span>
    <span class="c1"># E_inc_F_comp = emec.pd_ext.pd_agg(E_Methods_df.loc[sf_eva_dic])</span>

    <span class="n">cols_con</span><span class="o">=</span><span class="n">E_Methods_df</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s1">&#39;0&#39;</span><span class="p">)</span>
    <span class="c1"># E_inc_R_comp_con = emec.pd_ext.pd_agg(E_Methods_df.loc[sr_eva_con,cols_con])</span>
    <span class="c1"># E_inc_R_comp_opt = emec.pd_ext.pd_agg(E_Methods_df.loc[sr_eva_dic,np.invert(cols_con)])</span>
    <span class="n">E_inc_R_comp_con</span> <span class="o">=</span> <span class="n">E_Methods_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">sr_eva_con</span><span class="p">,</span><span class="n">cols_con</span><span class="p">]</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span><span class="n">E_agg_funcs</span><span class="p">)</span>
    <span class="n">E_inc_R_comp_opt</span> <span class="o">=</span> <span class="n">E_Methods_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">sr_eva_dic</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">invert</span><span class="p">(</span><span class="n">cols_con</span><span class="p">)]</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span><span class="n">E_agg_funcs</span><span class="p">)</span>
    <span class="n">E_inc_R_comp</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">E_inc_R_comp_con</span><span class="p">,</span><span class="n">E_inc_R_comp_opt</span><span class="p">],</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">E_inc_R_comp</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;stdn&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">E_inc_R_comp</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;std&#39;</span><span class="p">]</span><span class="o">/</span><span class="n">E_inc_R_comp</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;mean&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">abs</span><span class="p">()</span>
    <span class="c1"># E_inc_R_comp.loc[&#39;stdnwoso&#39;]=E_inc_R_comp.loc[&#39;std&#39;]/E_inc_R_comp.loc[&#39;meanwoso&#39;].abs()</span>
    <span class="n">E_inc_R_comp</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;stdnwoso&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">E_inc_R_comp</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;stdwoso&#39;</span><span class="p">]</span><span class="o">/</span><span class="n">E_inc_R_comp</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;meanwoso&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">abs</span><span class="p">()</span>
    
    <span class="n">log_custom</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n\n</span><span class="s2">  Method comaparison:&quot;</span><span class="p">,</span><span class="o">**</span><span class="n">log_scoptf</span><span class="p">)</span>
    <span class="n">log_custom</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">  - least square fit&quot;</span><span class="p">,</span><span class="o">**</span><span class="n">log_scoptf</span><span class="p">)</span>
    <span class="n">log_custom</span><span class="p">(</span><span class="n">log_cind</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">+</span><span class="n">E_lsq</span><span class="o">.</span><span class="n">loc</span><span class="p">[[</span><span class="s1">&#39;E&#39;</span><span class="p">,</span><span class="s1">&#39;Rquad&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">to_string</span><span class="p">()),</span>
                   <span class="o">**</span><span class="n">log_scoptf</span><span class="p">)</span>
    <span class="n">log_custom</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n\n</span><span class="s2">  - incremental - fixed range:&quot;</span><span class="p">,</span>
                   <span class="o">**</span><span class="n">log_scoptf</span><span class="p">)</span>
    <span class="n">log_custom</span><span class="p">(</span><span class="n">log_cind</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">+</span><span class="n">E_inc_F_comp</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">to_string</span><span class="p">()),</span>
                   <span class="o">**</span><span class="n">log_scoptf</span><span class="p">)</span>
    <span class="n">log_custom</span><span class="p">(</span><span class="n">log_cind</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">+</span><span class="n">E_inc_F_comp</span><span class="o">.</span><span class="n">agg</span><span class="p">([</span><span class="s1">&#39;idxmax&#39;</span><span class="p">,</span><span class="s1">&#39;idxmin&#39;</span><span class="p">],</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">to_string</span><span class="p">()),</span>
                   <span class="o">**</span><span class="n">log_scoptf</span><span class="p">)</span>
    <span class="n">log_custom</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n\n</span><span class="s2">  - incremental - refined range:&quot;</span><span class="p">,</span><span class="o">**</span><span class="n">log_scoptf</span><span class="p">)</span>
    <span class="n">log_custom</span><span class="p">(</span><span class="n">log_cind</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">+</span><span class="n">E_inc_R_comp</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">to_string</span><span class="p">()),</span>
                   <span class="o">**</span><span class="n">log_scoptf</span><span class="p">)</span>
    <span class="n">log_custom</span><span class="p">(</span><span class="n">log_cind</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">+</span><span class="n">E_inc_R_comp</span><span class="o">.</span><span class="n">agg</span><span class="p">([</span><span class="s1">&#39;idxmax&#39;</span><span class="p">,</span><span class="s1">&#39;idxmin&#39;</span><span class="p">],</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">to_string</span><span class="p">()),</span>
                   <span class="o">**</span><span class="n">log_scoptf</span><span class="p">)</span>

    <span class="n">check_M_tmp</span><span class="o">=</span><span class="n">E_Methods_df</span><span class="o">.</span><span class="n">loc</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)[</span><span class="n">E_Methods_df</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s1">&#39;M|Cl|Ce|Cg&#39;</span><span class="p">)]</span>
    <span class="n">check_M_dict</span><span class="o">=</span><span class="p">{</span><span class="n">i</span><span class="p">:</span> <span class="n">check_M_tmp</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">check_M_tmp</span><span class="o">.</span><span class="n">columns</span><span class="p">}</span>
    <span class="n">Check_M</span> <span class="o">=</span> <span class="n">emeb</span><span class="o">.</span><span class="n">evaluation</span><span class="o">.</span><span class="n">YM_check_many_with_method_D</span><span class="p">(</span>
        <span class="n">E_dict</span><span class="o">=</span><span class="n">check_M_dict</span><span class="p">,</span> <span class="n">F</span><span class="o">=</span><span class="n">d_Force</span><span class="p">,</span>
        <span class="n">Length</span><span class="o">=</span><span class="n">Length</span><span class="p">,</span><span class="n">I_func</span><span class="o">=</span><span class="n">func_I</span><span class="p">,</span>
        <span class="n">w_func</span><span class="o">=</span><span class="n">bl</span><span class="p">[</span><span class="s1">&#39;w_M&#39;</span><span class="p">][</span><span class="s1">&#39;d0&#39;</span><span class="p">],</span>
        <span class="n">w_params</span><span class="o">=</span><span class="n">Bend_inc_fit_df</span><span class="p">[</span><span class="s1">&#39;Fit_params_dict&#39;</span><span class="p">],</span>
        <span class="n">rel_steps</span><span class="o">=</span><span class="n">sr_eva_dic</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">pb_b</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;M&#39;</span>
        <span class="p">)</span>
    <span class="n">check_MtoD_g</span><span class="p">,</span> <span class="n">check_MtoD_x</span><span class="p">,</span> <span class="n">check_M</span><span class="p">,</span> <span class="n">w_D_to_M</span> <span class="o">=</span> <span class="n">Check_M</span>
    
    <span class="n">log_custom</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n\n</span><span class="s2">  Check Methods with D (M-Displacement deviation):&quot;</span><span class="p">,</span>
                   <span class="o">**</span><span class="n">log_scoptf</span><span class="p">)</span>
    <span class="n">log_custom</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">  - mean over all (except first and last):&quot;</span><span class="p">,</span>
                   <span class="o">**</span><span class="n">log_scoptf</span><span class="p">)</span>
    <span class="n">log_custom</span><span class="p">(</span><span class="n">log_cind</span><span class="p">(</span><span class="n">check_MtoD_g</span><span class="o">.</span><span class="n">mean</span><span class="p">()),</span>
                   <span class="o">**</span><span class="n">log_scoptf</span><span class="p">)</span>
    <span class="n">log_custom</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">  - only in mid:&quot;</span><span class="p">,</span>
                   <span class="o">**</span><span class="n">log_scoptf</span><span class="p">)</span>
    <span class="n">log_custom</span><span class="p">(</span><span class="n">log_cind</span><span class="p">(</span><span class="n">check_MtoD_x</span><span class="o">.</span><span class="n">mean</span><span class="p">()),</span>
                   <span class="o">**</span><span class="n">log_scoptf</span><span class="p">)</span>
    
    <span class="n">check_S_tmp</span><span class="o">=</span><span class="n">E_Methods_df</span><span class="o">.</span><span class="n">loc</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)[</span><span class="n">E_Methods_df</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s1">&#39;S&#39;</span><span class="p">)]</span>
    <span class="n">check_S_dict</span><span class="o">=</span><span class="p">{</span><span class="n">i</span><span class="p">:</span> <span class="n">check_S_tmp</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">check_S_tmp</span><span class="o">.</span><span class="n">columns</span><span class="p">}</span>
    <span class="n">Check_S</span> <span class="o">=</span> <span class="n">emeb</span><span class="o">.</span><span class="n">evaluation</span><span class="o">.</span><span class="n">YM_check_many_with_method_D</span><span class="p">(</span>
        <span class="n">E_dict</span><span class="o">=</span><span class="n">check_S_dict</span><span class="p">,</span> <span class="n">F</span><span class="o">=</span><span class="n">d_Force</span><span class="p">,</span>
        <span class="n">Length</span><span class="o">=</span><span class="n">Length</span><span class="p">,</span><span class="n">I_func</span><span class="o">=</span><span class="n">func_I</span><span class="p">,</span>
        <span class="n">w_func</span><span class="o">=</span><span class="n">bl</span><span class="p">[</span><span class="s1">&#39;w_S&#39;</span><span class="p">][</span><span class="s1">&#39;d0&#39;</span><span class="p">],</span>
        <span class="n">w_params</span><span class="o">=</span><span class="n">Pre_inc_fit_df</span><span class="p">[</span><span class="s1">&#39;Fit_params_dict&#39;</span><span class="p">],</span>
        <span class="n">rel_steps</span><span class="o">=</span><span class="n">sr_eva_dic</span><span class="p">,</span>
        <span class="n">n</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">pb_b</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;S&#39;</span>
        <span class="p">)</span>
    <span class="n">check_StoD_g</span><span class="p">,</span> <span class="n">check_StoD_x</span><span class="p">,</span> <span class="n">check_S</span><span class="p">,</span> <span class="n">w_D_to_S</span> <span class="o">=</span> <span class="n">Check_S</span>
    
    <span class="n">log_custom</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n\n</span><span class="s2">  Check Methods with D (S-Displacement deviation):&quot;</span><span class="p">,</span>
                   <span class="o">**</span><span class="n">log_scoptf</span><span class="p">)</span>
    <span class="n">log_custom</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">  - mean over all (except first and last):&quot;</span><span class="p">,</span>
                   <span class="o">**</span><span class="n">log_scoptf</span><span class="p">)</span>
    <span class="n">log_custom</span><span class="p">(</span><span class="n">log_cind</span><span class="p">(</span><span class="n">check_StoD_g</span><span class="o">.</span><span class="n">mean</span><span class="p">()),</span>
                   <span class="o">**</span><span class="n">log_scoptf</span><span class="p">)</span>
    <span class="n">log_custom</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">  - only in mid:&quot;</span><span class="p">,</span>
                   <span class="o">**</span><span class="n">log_scoptf</span><span class="p">)</span>
    <span class="n">log_custom</span><span class="p">(</span><span class="n">log_cind</span><span class="p">(</span><span class="n">check_StoD_x</span><span class="o">.</span><span class="n">mean</span><span class="p">()),</span>
                   <span class="o">**</span><span class="n">log_scoptf</span><span class="p">)</span>
    
    <span class="n">check_A_tmp</span><span class="o">=</span><span class="n">E_Methods_df</span><span class="o">.</span><span class="n">loc</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)[</span><span class="n">E_Methods_df</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s1">&#39;Al|Ae|Ag&#39;</span><span class="p">)]</span>
    <span class="n">check_A_dict</span><span class="o">=</span><span class="p">{</span><span class="n">i</span><span class="p">:</span> <span class="n">check_A_tmp</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">check_A_tmp</span><span class="o">.</span><span class="n">columns</span><span class="p">}</span>
    <span class="n">Check_A</span> <span class="o">=</span> <span class="n">emeb</span><span class="o">.</span><span class="n">evaluation</span><span class="o">.</span><span class="n">YM_check_many_with_method_D</span><span class="p">(</span>
        <span class="n">E_dict</span><span class="o">=</span><span class="n">check_A_dict</span><span class="p">,</span> <span class="n">F</span><span class="o">=</span><span class="n">d_Force</span><span class="p">,</span>
        <span class="n">Length</span><span class="o">=</span><span class="n">Length</span><span class="p">,</span><span class="n">I_func</span><span class="o">=</span><span class="n">func_I</span><span class="p">,</span>
        <span class="n">w_func</span><span class="o">=</span><span class="n">bl</span><span class="p">[</span><span class="s1">&#39;w_A&#39;</span><span class="p">][</span><span class="s1">&#39;d0&#39;</span><span class="p">],</span>
        <span class="n">w_params</span><span class="o">=</span><span class="n">Pre_inc_fit_df</span><span class="p">[</span><span class="s1">&#39;Fit_params_dict&#39;</span><span class="p">],</span>
        <span class="n">rel_steps</span><span class="o">=</span><span class="n">sr_eva_dic</span><span class="p">,</span>
        <span class="n">n</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">pb_b</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;A&#39;</span>
        <span class="p">)</span>
    <span class="n">check_AtoD_g</span><span class="p">,</span> <span class="n">check_AtoD_x</span><span class="p">,</span> <span class="n">check_A</span><span class="p">,</span> <span class="n">w_D_to_A</span> <span class="o">=</span> <span class="n">Check_A</span>
    
    <span class="n">log_custom</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n\n</span><span class="s2">  Check Methods with D (A-Displacement deviation):&quot;</span><span class="p">,</span>
                   <span class="o">**</span><span class="n">log_scoptf</span><span class="p">)</span>
    <span class="n">log_custom</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">  - mean over all (except first and last):&quot;</span><span class="p">,</span>
                   <span class="o">**</span><span class="n">log_scoptf</span><span class="p">)</span>
    <span class="n">log_custom</span><span class="p">(</span><span class="n">log_cind</span><span class="p">(</span><span class="n">check_AtoD_g</span><span class="o">.</span><span class="n">mean</span><span class="p">()),</span>
                   <span class="o">**</span><span class="n">log_scoptf</span><span class="p">)</span>
    <span class="n">log_custom</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">  - only in mid:&quot;</span><span class="p">,</span>
                   <span class="o">**</span><span class="n">log_scoptf</span><span class="p">)</span>
    <span class="n">log_custom</span><span class="p">(</span><span class="n">log_cind</span><span class="p">(</span><span class="n">check_AtoD_x</span><span class="o">.</span><span class="n">mean</span><span class="p">()),</span>
                   <span class="o">**</span><span class="n">log_scoptf</span><span class="p">)</span>
    
    <span class="n">Check_to_D</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">({</span><span class="s1">&#39;MtoD_g&#39;</span><span class="p">:</span><span class="n">check_MtoD_g</span><span class="p">,</span> <span class="s1">&#39;MtoD_x&#39;</span><span class="p">:</span> <span class="n">check_MtoD_x</span><span class="p">,</span>
                            <span class="s1">&#39;M&#39;</span><span class="p">:</span><span class="n">check_M</span><span class="p">,</span> <span class="s1">&#39;MwD&#39;</span><span class="p">:</span> <span class="n">w_D_to_M</span><span class="p">,</span>
                            <span class="s1">&#39;StoD_g&#39;</span><span class="p">:</span><span class="n">check_StoD_g</span><span class="p">,</span> <span class="s1">&#39;StoD_x&#39;</span><span class="p">:</span> <span class="n">check_StoD_x</span><span class="p">,</span>
                            <span class="s1">&#39;S&#39;</span><span class="p">:</span><span class="n">check_S</span><span class="p">,</span> <span class="s1">&#39;SwD&#39;</span><span class="p">:</span> <span class="n">w_D_to_S</span><span class="p">,</span>
                            <span class="s1">&#39;AtoD_g&#39;</span><span class="p">:</span><span class="n">check_AtoD_g</span><span class="p">,</span> <span class="s1">&#39;AtoD_x&#39;</span><span class="p">:</span> <span class="n">check_AtoD_x</span><span class="p">,</span>
                            <span class="s1">&#39;A&#39;</span><span class="p">:</span><span class="n">check_A</span><span class="p">,</span> <span class="s1">&#39;AwD&#39;</span><span class="p">:</span> <span class="n">w_D_to_A</span><span class="p">},</span><span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;O&#39;</span><span class="p">)</span>
    
    <span class="c1"># set preffered Method</span>
    <span class="n">YM_pref_con</span><span class="o">=</span><span class="n">E_lsq_A</span><span class="p">[</span><span class="s1">&#39;E_lsq_R_A0Al&#39;</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">loc_Yd_tmp</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;E_lsq&#39;</span><span class="p">):</span>
        <span class="n">YM_pref_opt</span><span class="o">=</span><span class="n">E_lsq</span><span class="p">[</span><span class="n">loc_Yd_tmp</span><span class="p">]</span>
    <span class="k">elif</span> <span class="n">loc_Yd_tmp</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;E_inc_R&#39;</span><span class="p">):</span>
        <span class="n">YM_pref_opt</span><span class="o">=</span><span class="n">emec</span><span class="o">.</span><span class="n">fitting</span><span class="o">.</span><span class="n">Refit_YM_vals</span><span class="p">(</span>
            <span class="n">m_df</span><span class="o">=</span><span class="n">messu</span><span class="p">,</span> 
            <span class="n">YM</span> <span class="o">=</span> <span class="n">E_inc_R_comp</span><span class="p">[</span><span class="n">loc_Yd_tmp</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]][</span><span class="s1">&#39;meanwoso&#39;</span><span class="p">],</span> 
            <span class="n">VIP</span><span class="o">=</span><span class="n">VIP_dicu</span><span class="p">,</span>
            <span class="n">n_strain</span><span class="o">=</span><span class="n">dic_used_Strain</span><span class="p">,</span> <span class="n">n_stress</span><span class="o">=</span><span class="s1">&#39;Stress&#39;</span><span class="p">,</span>
            <span class="n">n_loBo</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;F3&#39;</span><span class="p">],</span> <span class="n">n_upBo</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;F4&#39;</span><span class="p">]</span>
            <span class="p">)</span>
    <span class="k">elif</span> <span class="n">loc_Yd_tmp</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;E_inc_F&#39;</span><span class="p">):</span>
        <span class="n">YM_pref_opt</span><span class="o">=</span><span class="n">emec</span><span class="o">.</span><span class="n">fitting</span><span class="o">.</span><span class="n">Refit_YM_vals</span><span class="p">(</span>
            <span class="n">m_df</span><span class="o">=</span><span class="n">messu</span><span class="p">,</span> 
            <span class="n">YM</span> <span class="o">=</span> <span class="n">E_inc_F_comp</span><span class="p">[</span><span class="n">loc_Yd_tmp</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]][</span><span class="s1">&#39;meanwoso&#39;</span><span class="p">],</span> 
            <span class="n">VIP</span><span class="o">=</span><span class="n">VIP_dicu</span><span class="p">,</span>
            <span class="n">n_strain</span><span class="o">=</span><span class="n">dic_used_Strain</span><span class="p">,</span> <span class="n">n_stress</span><span class="o">=</span><span class="s1">&#39;Stress&#39;</span><span class="p">,</span>
            <span class="n">n_loBo</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;F1&#39;</span><span class="p">],</span> <span class="n">n_upBo</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;F2&#39;</span><span class="p">]</span>
            <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s1">&#39;Prefered YM-method not selectable!&#39;</span><span class="p">)</span>
    <span class="c1"># --------------------------------------------------------------------------</span>
    <span class="c1">#%%% 6.5 Determine yield point</span>
    <span class="n">log_custom</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2"> &quot;</span><span class="o">+</span><span class="s2">&quot;-&quot;</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span><span class="o">**</span><span class="n">log_scopt</span><span class="p">)</span>
    <span class="n">log_custom</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2"> ### -6.5 Determine yield point ###&quot;</span><span class="p">,</span><span class="o">**</span><span class="n">log_scopt</span><span class="p">)</span>
    <span class="n">timings</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mf">6.5</span><span class="p">]</span><span class="o">=</span><span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span>
    <span class="n">log_custom</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">   Timing </span><span class="si">%f</span><span class="s2">: </span><span class="si">%.5f</span><span class="s2"> s&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">timings</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span>
                                       <span class="n">timings</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">timings</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span>
                   <span class="o">**</span><span class="n">log_scopt</span><span class="p">)</span>    
    

    <span class="n">strain_osd</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;YK&#39;</span><span class="p">:</span><span class="mf">0.0</span><span class="p">,</span><span class="s1">&#39;Y0&#39;</span><span class="p">:</span><span class="mf">0.0</span><span class="p">,</span><span class="s1">&#39;Y1&#39;</span><span class="p">:</span><span class="mf">0.007</span><span class="o">/</span><span class="mi">100</span><span class="p">,</span><span class="s1">&#39;Y2&#39;</span><span class="p">:</span><span class="mf">0.1</span><span class="o">/</span><span class="mi">100</span><span class="p">,</span><span class="s1">&#39;Y&#39;</span><span class="p">:</span><span class="mf">0.2</span><span class="o">/</span><span class="mi">100</span><span class="p">}</span> <span class="c1">#acc. Zhang et al. 2021, DOI: 10.1007/s10439-020-02719-2</span>
    <span class="n">strain_osdf</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;YK&#39;</span><span class="p">:</span><span class="s1">&#39;F4&#39;</span><span class="p">}</span>
        
    <span class="n">log_custom</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">  Determination of yield strain-conventional:&quot;</span><span class="p">,</span><span class="o">**</span><span class="n">log_scoptf</span><span class="p">)</span>
    <span class="n">tmp</span><span class="o">=</span><span class="n">emec</span><span class="o">.</span><span class="n">mc_yield</span><span class="o">.</span><span class="n">Yield_redet2_Multi</span><span class="p">(</span>
        <span class="n">m_df</span><span class="o">=</span><span class="n">messu</span><span class="p">,</span> <span class="n">VIP</span><span class="o">=</span><span class="n">VIP_messu</span><span class="p">,</span>
        <span class="n">strain_osd</span><span class="o">=</span><span class="n">strain_osd</span><span class="p">,</span> <span class="n">strain_osdf</span><span class="o">=</span><span class="n">strain_osdf</span><span class="p">,</span>
        <span class="n">n_strain</span><span class="o">=</span><span class="s1">&#39;Strain&#39;</span><span class="p">,</span> <span class="n">n_stress</span><span class="o">=</span><span class="s1">&#39;Stress&#39;</span><span class="p">,</span>
        <span class="n">n_loBo</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;F3&#39;</span><span class="p">],</span> <span class="n">n_upBo</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;U&#39;</span><span class="p">],</span> <span class="n">n_loBo_int</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;F3&#39;</span><span class="p">],</span>
        <span class="n">YM</span>     <span class="o">=</span> <span class="n">YM_pref_con</span><span class="p">[</span><span class="s1">&#39;E&#39;</span><span class="p">],</span>
        <span class="n">YM_abs</span> <span class="o">=</span> <span class="n">YM_pref_con</span><span class="p">[</span><span class="s1">&#39;E_abs&#39;</span><span class="p">],</span>
        <span class="n">use_rd</span> <span class="o">=</span><span class="kc">True</span><span class="p">,</span> 
        <span class="n">rise_det</span><span class="o">=</span><span class="p">[</span>
            <span class="n">_opts</span><span class="p">[</span><span class="s1">&#39;OPT_Rise_Smoothing&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span>
            <span class="n">_opts</span><span class="p">[</span><span class="s1">&#39;OPT_Rise_Smoothing&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
            <span class="p">],</span> 
        <span class="n">ywhere</span><span class="o">=</span><span class="s1">&#39;n&#39;</span>
        <span class="p">)</span>
    <span class="n">VIP_messu</span><span class="p">,</span> <span class="n">yield_df_con</span><span class="p">,</span> <span class="n">txt</span> <span class="o">=</span> <span class="n">tmp</span>
    <span class="n">log_custom</span><span class="p">(</span><span class="n">log_cind</span><span class="p">(</span><span class="n">txt</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span> <span class="o">**</span><span class="n">log_scoptf</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">_opts</span><span class="p">[</span><span class="s1">&#39;OPT_DIC&#39;</span><span class="p">]:</span>
        <span class="n">log_custom</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">  Determination of yield strain-optical:&quot;</span><span class="p">,</span><span class="o">**</span><span class="n">log_scoptf</span><span class="p">)</span>
        <span class="n">tmp</span><span class="o">=</span><span class="n">emec</span><span class="o">.</span><span class="n">mc_yield</span><span class="o">.</span><span class="n">Yield_redet2_Multi</span><span class="p">(</span>
            <span class="n">m_df</span><span class="o">=</span><span class="n">messu</span><span class="p">,</span> <span class="n">VIP</span><span class="o">=</span><span class="n">VIP_dicu</span><span class="p">,</span>
            <span class="n">strain_osd</span><span class="o">=</span><span class="n">strain_osd</span><span class="p">,</span> <span class="n">strain_osdf</span><span class="o">=</span><span class="n">strain_osdf</span><span class="p">,</span>
            <span class="n">n_strain</span><span class="o">=</span><span class="n">dic_used_Strain</span><span class="p">,</span> <span class="n">n_stress</span><span class="o">=</span><span class="s1">&#39;Stress&#39;</span><span class="p">,</span>
            <span class="n">n_loBo</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;F3&#39;</span><span class="p">],</span> <span class="n">n_upBo</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;U&#39;</span><span class="p">],</span> <span class="n">n_loBo_int</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;F3&#39;</span><span class="p">],</span>
            <span class="n">YM</span>     <span class="o">=</span> <span class="n">YM_pref_opt</span><span class="p">[</span><span class="s1">&#39;E&#39;</span><span class="p">],</span>
            <span class="n">YM_abs</span> <span class="o">=</span> <span class="n">YM_pref_opt</span><span class="p">[</span><span class="s1">&#39;E_abs&#39;</span><span class="p">],</span>
            <span class="n">use_rd</span> <span class="o">=</span><span class="kc">True</span><span class="p">,</span> 
            <span class="n">rise_det</span><span class="o">=</span><span class="p">[</span>
                <span class="n">_opts</span><span class="p">[</span><span class="s1">&#39;OPT_Rise_Smoothing&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span>
                <span class="n">_opts</span><span class="p">[</span><span class="s1">&#39;OPT_Rise_Smoothing&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
                <span class="p">],</span> 
            <span class="n">ywhere</span><span class="o">=</span><span class="s1">&#39;n&#39;</span>
            <span class="p">)</span>
        <span class="n">VIP_dicu</span><span class="p">,</span> <span class="n">yield_df_opt</span><span class="p">,</span> <span class="n">txt</span> <span class="o">=</span> <span class="n">tmp</span>
        <span class="n">log_custom</span><span class="p">(</span><span class="n">log_cind</span><span class="p">(</span><span class="n">txt</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span> <span class="o">**</span><span class="n">log_scoptf</span><span class="p">)</span>
        
    <span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="n">ax1</span><span class="p">,</span><span class="n">ax2</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> 
                                  <span class="n">sharex</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> 
                                  <span class="n">figsize</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">figsize</span><span class="p">,[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">]))</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1"> - Stress vs. strain curve - yield point determination&#39;</span><span class="o">%</span><span class="n">plt_name</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Conventional strain&#39;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Strain / -&#39;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Stress / MPa&#39;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">messu</span><span class="o">.</span><span class="n">loc</span><span class="p">[:</span><span class="n">VIP_messu</span><span class="p">[</span><span class="s1">&#39;B&#39;</span><span class="p">]][</span><span class="s1">&#39;Strain&#39;</span><span class="p">],</span> <span class="n">messu</span><span class="o">.</span><span class="n">loc</span><span class="p">[:</span><span class="n">VIP_messu</span><span class="p">[</span><span class="s1">&#39;B&#39;</span><span class="p">]][</span><span class="s1">&#39;Stress&#39;</span><span class="p">],</span> <span class="s1">&#39;r--&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;con&#39;</span><span class="p">)</span>
    <span class="n">tmp</span><span class="o">=</span><span class="n">ax1</span><span class="o">.</span><span class="n">get_xlim</span><span class="p">(),</span><span class="n">ax1</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">strain_osd</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">emec</span><span class="o">.</span><span class="n">fitting</span><span class="o">.</span><span class="n">strain_linfit</span><span class="p">(</span>
            <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1000</span><span class="p">],</span>
            <span class="n">YM_pref_con</span><span class="p">[</span><span class="s1">&#39;E&#39;</span><span class="p">],</span> 
            <span class="n">YM_pref_con</span><span class="p">[</span><span class="s1">&#39;E_abs&#39;</span><span class="p">],</span> 
            <span class="n">strain_offset</span><span class="o">=</span><span class="n">strain_osd</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="p">),[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1000</span><span class="p">],</span> <span class="s1">&#39;-&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;$E_{off-</span><span class="si">%.3f</span><span class="s1">p}$&#39;</span><span class="o">%</span><span class="p">(</span><span class="n">strain_osd</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="mi">100</span><span class="p">))</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">tmp</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">tmp</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="n">messu</span><span class="o">.</span><span class="n">Strain</span><span class="p">[</span><span class="n">VIP_messu</span><span class="p">[:</span><span class="s1">&#39;B&#39;</span><span class="p">]],</span><span class="n">messu</span><span class="o">.</span><span class="n">Stress</span><span class="p">[</span><span class="n">VIP_messu</span><span class="p">[:</span><span class="s1">&#39;B&#39;</span><span class="p">]]</span>
    <span class="n">j</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int64</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="s1">&#39;bx&#39;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">VIP_messu</span><span class="p">[:</span><span class="s1">&#39;B&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="p">:</span>
        <span class="n">j</span><span class="o">+=</span><span class="mi">1</span>
        <span class="k">if</span> <span class="n">j</span><span class="o">%</span><span class="mi">2</span><span class="p">:</span> <span class="n">c</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="o">-</span><span class="mi">6</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>   <span class="n">c</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">6</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">x</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">j</span><span class="p">],</span><span class="n">b</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">j</span><span class="p">]),</span> <span class="n">xycoords</span><span class="o">=</span><span class="s1">&#39;data&#39;</span><span class="p">,</span>
                      <span class="n">xytext</span><span class="o">=</span><span class="n">c</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span> <span class="n">textcoords</span><span class="o">=</span><span class="s1">&#39;offset points&#39;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Optical strain&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">_opts</span><span class="p">[</span><span class="s1">&#39;OPT_DIC&#39;</span><span class="p">]:</span>
        <span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Strain / -&#39;</span><span class="p">)</span>
        <span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Stress / MPa&#39;</span><span class="p">)</span>
        <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">messu</span><span class="o">.</span><span class="n">loc</span><span class="p">[:</span><span class="n">VIP_dicu</span><span class="p">[</span><span class="s1">&#39;B&#39;</span><span class="p">]][</span><span class="n">dic_used_Strain</span><span class="p">],</span> <span class="n">messu</span><span class="o">.</span><span class="n">loc</span><span class="p">[:</span><span class="n">VIP_dicu</span><span class="p">[</span><span class="s1">&#39;B&#39;</span><span class="p">]][</span><span class="s1">&#39;Stress&#39;</span><span class="p">],</span> 
                 <span class="s1">&#39;r--&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;opt&#39;</span><span class="p">)</span>
        <span class="n">tmp</span><span class="o">=</span><span class="n">ax2</span><span class="o">.</span><span class="n">get_xlim</span><span class="p">(),</span><span class="n">ax1</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">strain_osd</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">emec</span><span class="o">.</span><span class="n">fitting</span><span class="o">.</span><span class="n">strain_linfit</span><span class="p">(</span>
                <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1000</span><span class="p">],</span>
                <span class="n">YM_pref_opt</span><span class="p">[</span><span class="s1">&#39;E&#39;</span><span class="p">],</span> 
                <span class="n">YM_pref_opt</span><span class="p">[</span><span class="s1">&#39;E_abs&#39;</span><span class="p">],</span> 
                <span class="n">strain_offset</span><span class="o">=</span><span class="n">strain_osd</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                <span class="p">),[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1000</span><span class="p">],</span> <span class="s1">&#39;-&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;$E_{off-</span><span class="si">%.3f</span><span class="s1">p}$&#39;</span><span class="o">%</span><span class="p">(</span><span class="n">strain_osd</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="mi">100</span><span class="p">))</span>
        <span class="n">ax2</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">tmp</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">ax2</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">tmp</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="n">messu</span><span class="p">[</span><span class="n">dic_used_Strain</span><span class="p">][</span><span class="n">VIP_dicu</span><span class="p">[:</span><span class="s1">&#39;B&#39;</span><span class="p">]],</span><span class="n">messu</span><span class="o">.</span><span class="n">Stress</span><span class="p">[</span><span class="n">VIP_dicu</span><span class="p">[:</span><span class="s1">&#39;B&#39;</span><span class="p">]]</span>
        <span class="n">j</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int64</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="s1">&#39;bx&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">VIP_dicu</span><span class="p">[:</span><span class="s1">&#39;B&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="p">:</span>
            <span class="n">j</span><span class="o">+=</span><span class="mi">1</span>
            <span class="k">if</span> <span class="n">j</span><span class="o">%</span><span class="mi">2</span><span class="p">:</span> <span class="n">c</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="o">-</span><span class="mi">6</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>   <span class="n">c</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">6</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span>
            <span class="n">ax2</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">x</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">j</span><span class="p">],</span><span class="n">b</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">j</span><span class="p">]),</span> <span class="n">xycoords</span><span class="o">=</span><span class="s1">&#39;data&#39;</span><span class="p">,</span>
                          <span class="n">xytext</span><span class="o">=</span><span class="n">c</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span> <span class="n">textcoords</span><span class="o">=</span><span class="s1">&#39;offset points&#39;</span><span class="p">)</span>
        <span class="n">ax2</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">plt_hsuf</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span><span class="n">path</span><span class="o">=</span><span class="n">out_full</span><span class="o">+</span><span class="s2">&quot;-sigeps_yielddet&quot;</span><span class="p">,</span><span class="o">**</span><span class="n">plt_scopt</span><span class="p">)</span>
    
    <span class="c1"># ============================================================================</span>
    <span class="c1">#%%% 6.6 Determine final curve</span>
    <span class="n">log_custom</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2"> &quot;</span><span class="o">+</span><span class="s2">&quot;-&quot;</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span><span class="o">**</span><span class="n">log_scopt</span><span class="p">)</span>
    <span class="n">log_custom</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2"> ### -6.6 Determine final stress-strain curve ###&quot;</span><span class="p">,</span><span class="o">**</span><span class="n">log_scopt</span><span class="p">)</span>
    <span class="n">timings</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mf">6.6</span><span class="p">]</span><span class="o">=</span><span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span>
    <span class="n">log_custom</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">   Timing </span><span class="si">%f</span><span class="s2">: </span><span class="si">%.5f</span><span class="s2"> s&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">timings</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span>
                                       <span class="n">timings</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">timings</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span>
                   <span class="o">**</span><span class="n">log_scopt</span><span class="p">)</span>
    <span class="n">FinSSC</span> <span class="o">=</span> <span class="kc">True</span> <span class="c1"># finale kurve für werteermittlung auf Ym linearisieren an anfang</span>
    <span class="k">if</span> <span class="n">FinSSC</span><span class="p">:</span>
        <span class="n">messu_FP</span><span class="p">,</span><span class="n">linstrainos_con</span><span class="o">=</span><span class="n">emec</span><span class="o">.</span><span class="n">mc_man</span><span class="o">.</span><span class="n">DetFinSSC</span><span class="p">(</span>
            <span class="n">mdf</span><span class="o">=</span><span class="n">messu</span><span class="p">,</span> <span class="n">YM</span><span class="o">=</span><span class="n">YM_pref_con</span><span class="p">,</span> 
            <span class="n">iS</span><span class="o">=</span><span class="n">VIP_messu</span><span class="p">[</span><span class="s1">&#39;F3&#39;</span><span class="p">],</span> <span class="n">iLE</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">StressN</span><span class="o">=</span><span class="s1">&#39;Stress&#39;</span><span class="p">,</span> <span class="n">StrainN</span><span class="o">=</span><span class="s1">&#39;Strain&#39;</span><span class="p">,</span> 
            <span class="n">addzero</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">izero</span><span class="o">=</span><span class="n">VIP_messu</span><span class="p">[</span><span class="s1">&#39;S&#39;</span><span class="p">]</span>
            <span class="p">)</span>
        <span class="n">yield_df_con</span><span class="p">[</span><span class="s1">&#39;Strain&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">yield_df_con</span><span class="p">[</span><span class="s1">&#39;Strain&#39;</span><span class="p">]</span><span class="o">-</span><span class="n">linstrainos_con</span>
        <span class="n">yield_df_con</span><span class="p">[</span><span class="s1">&#39;Force&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">yield_df_con</span><span class="p">[</span><span class="s1">&#39;Stress&#39;</span><span class="p">]</span><span class="o">/</span><span class="n">emeb</span><span class="o">.</span><span class="n">evaluation</span><span class="o">.</span><span class="n">stress_perF</span><span class="p">(</span>
            <span class="mf">0.0</span><span class="p">,</span><span class="n">func_I</span><span class="p">,</span><span class="n">func_t</span><span class="p">,</span><span class="n">Bo_Le</span><span class="p">,</span><span class="n">Bo_Ri</span>
            <span class="p">)</span>
        <span class="n">yield_df_con</span><span class="p">[</span><span class="s1">&#39;Way&#39;</span><span class="p">]</span><span class="o">=</span><span class="p">(</span><span class="n">yield_df_con</span><span class="p">[</span><span class="s1">&#39;Strain&#39;</span><span class="p">]</span><span class="o">*</span><span class="n">Length</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">6</span><span class="o">*</span><span class="n">prot_ser</span><span class="p">[</span><span class="s1">&#39;thickness_2&#39;</span><span class="p">])</span>
        <span class="n">log_custom</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">   Strain offset (conventional) about </span><span class="si">%.5f</span><span class="s2">&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">linstrainos_con</span><span class="p">),</span>
                   <span class="o">**</span><span class="n">log_scopt</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">_opts</span><span class="p">[</span><span class="s1">&#39;OPT_DIC&#39;</span><span class="p">]:</span>
            <span class="n">tmp</span><span class="p">,</span> <span class="n">linstrainos_opt</span><span class="o">=</span><span class="n">emec</span><span class="o">.</span><span class="n">mc_man</span><span class="o">.</span><span class="n">DetFinSSC</span><span class="p">(</span>
                <span class="n">mdf</span><span class="o">=</span><span class="n">messu</span><span class="p">,</span> <span class="n">YM</span><span class="o">=</span><span class="n">YM_pref_opt</span><span class="p">,</span> 
                <span class="n">iS</span><span class="o">=</span><span class="n">VIP_dicu</span><span class="p">[</span><span class="s1">&#39;F3&#39;</span><span class="p">],</span> <span class="n">iLE</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                <span class="n">StressN</span><span class="o">=</span><span class="s1">&#39;Stress&#39;</span><span class="p">,</span> <span class="n">StrainN</span><span class="o">=</span><span class="n">dic_used_Strain</span><span class="p">,</span> 
                <span class="n">addzero</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">izero</span><span class="o">=</span><span class="n">VIP_messu</span><span class="p">[</span><span class="s1">&#39;S&#39;</span><span class="p">]</span>
                <span class="p">)</span>
            <span class="n">messu_FP</span><span class="o">=</span><span class="n">messu_FP</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">tmp</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;outer&#39;</span><span class="p">,</span> <span class="n">lsuffix</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">rsuffix</span><span class="o">=</span><span class="s1">&#39;_opt&#39;</span><span class="p">)</span>
            <span class="n">messu_FP</span><span class="p">[</span><span class="s1">&#39;Stress&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">messu_FP</span><span class="p">[</span><span class="s1">&#39;Stress_opt&#39;</span><span class="p">],</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">yield_df_opt</span><span class="p">[</span><span class="n">dic_used_Strain</span><span class="p">]</span><span class="o">=</span><span class="n">yield_df_opt</span><span class="p">[</span><span class="n">dic_used_Strain</span><span class="p">]</span><span class="o">-</span><span class="n">linstrainos_opt</span>
            <span class="k">del</span> <span class="n">messu_FP</span><span class="p">[</span><span class="s1">&#39;Stress_opt&#39;</span><span class="p">]</span>
            <span class="n">yield_df_opt</span><span class="p">[</span><span class="s1">&#39;Force&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">yield_df_opt</span><span class="p">[</span><span class="s1">&#39;Stress&#39;</span><span class="p">]</span><span class="o">/</span><span class="n">emeb</span><span class="o">.</span><span class="n">evaluation</span><span class="o">.</span><span class="n">stress_perF</span><span class="p">(</span>
                <span class="mf">0.0</span><span class="p">,</span><span class="n">func_I</span><span class="p">,</span><span class="n">func_t</span><span class="p">,</span><span class="n">Bo_Le</span><span class="p">,</span><span class="n">Bo_Ri</span>
                <span class="p">)</span>
            <span class="n">yield_df_opt</span><span class="p">[</span><span class="n">dic_used_Disp</span><span class="p">]</span><span class="o">=</span><span class="p">(</span><span class="n">yield_df_opt</span><span class="p">[</span><span class="n">dic_used_Strain</span><span class="p">]</span><span class="o">*</span><span class="n">Length</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">6</span><span class="o">*</span><span class="n">prot_ser</span><span class="p">[</span><span class="s1">&#39;thickness_2&#39;</span><span class="p">])</span>
        <span class="n">log_custom</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">   Strain offset (optical) about </span><span class="si">%.5f</span><span class="s2">&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">linstrainos_opt</span><span class="p">),</span><span class="o">**</span><span class="n">log_scopt</span><span class="p">)</span>
    
        <span class="n">messu_FP</span><span class="p">[</span><span class="s1">&#39;Force&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">messu_FP</span><span class="p">[</span><span class="s1">&#39;Stress&#39;</span><span class="p">]</span><span class="o">/</span><span class="n">emeb</span><span class="o">.</span><span class="n">evaluation</span><span class="o">.</span><span class="n">stress_perF</span><span class="p">(</span>
            <span class="mf">0.0</span><span class="p">,</span><span class="n">func_I</span><span class="p">,</span><span class="n">func_t</span><span class="p">,</span><span class="n">Bo_Le</span><span class="p">,</span><span class="n">Bo_Ri</span>
            <span class="p">)</span>
        <span class="n">messu_FP</span><span class="p">[</span><span class="s1">&#39;Way&#39;</span><span class="p">]</span><span class="o">=</span><span class="p">(</span><span class="n">messu_FP</span><span class="p">[</span><span class="s1">&#39;Strain&#39;</span><span class="p">]</span><span class="o">*</span><span class="n">Length</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">6</span><span class="o">*</span><span class="n">prot_ser</span><span class="p">[</span><span class="s1">&#39;thickness_2&#39;</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">_opts</span><span class="p">[</span><span class="s1">&#39;OPT_DIC&#39;</span><span class="p">]:</span> 
            <span class="n">messu_FP</span><span class="p">[</span><span class="n">dic_used_Disp</span><span class="p">]</span><span class="o">=</span><span class="p">(</span><span class="n">messu_FP</span><span class="p">[</span><span class="n">dic_used_Strain</span><span class="p">]</span><span class="o">*</span><span class="n">Length</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">6</span><span class="o">*</span><span class="n">prot_ser</span><span class="p">[</span><span class="s1">&#39;thickness_2&#39;</span><span class="p">])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">messu_FP</span> <span class="o">=</span>  <span class="n">messu</span>
        <span class="n">linstrainos_con</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">linstrainos_opt</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">log_custom</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">   No linear start of final stress-strain-curve&quot;</span><span class="p">,</span><span class="o">**</span><span class="n">log_scopt</span><span class="p">)</span>
        
    <span class="c1"># ============================================================================</span>
    <span class="c1">#%% 7 Outputs</span>
    <span class="n">log_custom</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2"> &quot;</span><span class="o">+</span><span class="s2">&quot;=&quot;</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span><span class="o">**</span><span class="n">log_scopt</span><span class="p">)</span>
    <span class="n">log_custom</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2"> ### 7 Outputs ###&quot;</span><span class="p">,</span><span class="o">**</span><span class="n">log_scoptf</span><span class="p">)</span>
    <span class="n">timings</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mf">7.0</span><span class="p">]</span><span class="o">=</span><span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span>
    <span class="n">log_custom</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">   Timing </span><span class="si">%f</span><span class="s2">: </span><span class="si">%.5f</span><span class="s2"> s&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">timings</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span>
                                       <span class="n">timings</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">timings</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span>
                   <span class="o">**</span><span class="n">log_scopt</span><span class="p">)</span>    
    <span class="c1"># ============================================================================</span>
    <span class="c1">#%%% 7.1 Prepare outputs</span>
    <span class="n">timings</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mf">7.1</span><span class="p">]</span><span class="o">=</span><span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span>
    <span class="n">log_custom</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">   Timing </span><span class="si">%f</span><span class="s2">: </span><span class="si">%.5f</span><span class="s2"> s&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">timings</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span>
                                       <span class="n">timings</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">timings</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span>
                   <span class="o">**</span><span class="n">log_scopt</span><span class="p">)</span>    

    <span class="n">out_tab</span>               <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([],</span><span class="n">name</span><span class="o">=</span><span class="n">prot_ser</span><span class="o">.</span><span class="n">name</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;float64&#39;</span><span class="p">)</span>
    <span class="n">out_tab</span><span class="p">[</span><span class="s1">&#39;Date_eva&#39;</span><span class="p">]</span>   <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%d</span><span class="s1">.%m.%Y&#39;</span><span class="p">)</span>
    <span class="n">out_tab</span><span class="p">[</span><span class="s1">&#39;geo_MoI_max&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">func_I</span><span class="p">(</span><span class="n">xlin</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
    <span class="n">out_tab</span><span class="p">[</span><span class="s1">&#39;geo_MoI_min&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">func_I</span><span class="p">(</span><span class="n">xlin</span><span class="p">)</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
    <span class="n">out_tab</span><span class="p">[</span><span class="s1">&#39;geo_MoI_mid&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">func_I</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">_opts</span><span class="p">[</span><span class="s1">&#39;OPT_DIC&#39;</span><span class="p">]:</span>
        <span class="n">out_tab</span><span class="p">[</span><span class="s1">&#39;geo_curve_max&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">geo_d2_max</span>
        <span class="n">out_tab</span><span class="p">[</span><span class="s1">&#39;geo_curve_min&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">geo_d2_min</span>
        <span class="n">out_tab</span><span class="p">[</span><span class="s1">&#39;geo_curve_mid&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">geo_d2_mid</span>
        
        <span class="n">t</span><span class="o">=</span><span class="n">bl</span><span class="p">[</span><span class="s1">&#39;w_I&#39;</span><span class="p">][</span><span class="s1">&#39;d0&#39;</span><span class="p">](</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">Bo_Le</span><span class="p">,</span><span class="n">Bo_Ri</span><span class="p">]),</span>
                          <span class="n">Pre_fit_df</span><span class="o">.</span><span class="n">loc</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)[</span><span class="s1">&#39;Fit_params_dict&#39;</span><span class="p">])</span>
        <span class="n">steps</span> <span class="o">=</span> <span class="n">emec</span><span class="o">.</span><span class="n">pd_ext</span><span class="o">.</span><span class="n">pd_combine_index</span><span class="p">(</span>
            <span class="n">messu</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">VIP_messu</span><span class="p">[</span><span class="s1">&#39;S&#39;</span><span class="p">]:</span><span class="n">VIP_messu</span><span class="p">[</span><span class="s1">&#39;U&#39;</span><span class="p">]],</span>
            <span class="n">Pre_fit_df</span>
            <span class="p">)[[</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span>
        
        <span class="c1"># tl, tr = t.loc[[VIP_messu[&#39;S&#39;]+1,VIP_messu[&#39;U&#39;]]].diff().iloc[-1].values</span>
        <span class="n">tl</span><span class="p">,</span> <span class="n">tr</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">steps</span><span class="p">]</span><span class="o">.</span><span class="n">diff</span><span class="p">()</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
        <span class="n">out_tab</span><span class="p">[</span><span class="s1">&#39;ind_U_l&#39;</span><span class="p">],</span>       <span class="n">out_tab</span><span class="p">[</span><span class="s1">&#39;ind_U_r&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">tl</span><span class="p">,</span> <span class="n">tr</span>
        <span class="n">tl</span><span class="p">,</span> <span class="n">tr</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">sf_eva_con</span><span class="p">[[</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">]]]</span><span class="o">.</span><span class="n">diff</span><span class="p">()</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
        <span class="n">out_tab</span><span class="p">[</span><span class="s1">&#39;ind_Fcon_l&#39;</span><span class="p">],</span> <span class="n">out_tab</span><span class="p">[</span><span class="s1">&#39;ind_Fcon_r&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">tl</span><span class="p">,</span> <span class="n">tr</span>
        <span class="n">tl</span><span class="p">,</span> <span class="n">tr</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">sf_eva_dic</span><span class="p">[[</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">]]]</span><span class="o">.</span><span class="n">diff</span><span class="p">()</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
        <span class="n">out_tab</span><span class="p">[</span><span class="s1">&#39;ind_Fopt_l&#39;</span><span class="p">],</span> <span class="n">out_tab</span><span class="p">[</span><span class="s1">&#39;ind_Fopt_r&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">tl</span><span class="p">,</span> <span class="n">tr</span>
        <span class="n">tl</span><span class="p">,</span> <span class="n">tr</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">sr_eva_con</span><span class="p">[[</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">]]]</span><span class="o">.</span><span class="n">diff</span><span class="p">()</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
        <span class="n">out_tab</span><span class="p">[</span><span class="s1">&#39;ind_Rcon_l&#39;</span><span class="p">],</span> <span class="n">out_tab</span><span class="p">[</span><span class="s1">&#39;ind_Rcon_r&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">tl</span><span class="p">,</span> <span class="n">tr</span>
        <span class="n">tl</span><span class="p">,</span> <span class="n">tr</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">sr_eva_dic</span><span class="p">[[</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">]]]</span><span class="o">.</span><span class="n">diff</span><span class="p">()</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
        <span class="n">out_tab</span><span class="p">[</span><span class="s1">&#39;ind_Ropt_l&#39;</span><span class="p">],</span> <span class="n">out_tab</span><span class="p">[</span><span class="s1">&#39;ind_Ropt_r&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">tl</span><span class="p">,</span> <span class="n">tr</span>
    
    <span class="n">out_tab</span><span class="p">[</span><span class="s1">&#39;leos_con&#39;</span><span class="p">]</span>   <span class="o">=</span> <span class="n">linstrainos_con</span>
    <span class="k">if</span> <span class="n">_opts</span><span class="p">[</span><span class="s1">&#39;OPT_DIC&#39;</span><span class="p">]:</span> <span class="n">out_tab</span><span class="p">[</span><span class="s1">&#39;leos_opt&#39;</span><span class="p">]</span>   <span class="o">=</span> <span class="n">linstrainos_opt</span>

    <span class="n">relVS</span> <span class="o">=</span> <span class="p">[</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">([</span><span class="o">*</span><span class="n">strain_osd</span><span class="o">.</span><span class="n">keys</span><span class="p">()]),</span><span class="s1">&#39;U&#39;</span><span class="p">,</span><span class="s1">&#39;B&#39;</span><span class="p">]</span>
    <span class="n">tmp</span><span class="o">=</span><span class="n">emec</span><span class="o">.</span><span class="n">output</span><span class="o">.</span><span class="n">Otvalgetter_Multi</span><span class="p">(</span>
        <span class="n">messu_FP</span><span class="p">,</span> <span class="n">Vs</span><span class="o">=</span><span class="n">relVS</span><span class="p">,</span>
        <span class="n">datasep</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;con&#39;</span><span class="p">,</span><span class="s1">&#39;opt&#39;</span><span class="p">],</span> 
        <span class="n">VIPs</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;con&#39;</span><span class="p">:</span><span class="n">VIP_messu</span><span class="p">,</span><span class="s1">&#39;opt&#39;</span><span class="p">:</span><span class="n">VIP_dicu</span><span class="p">},</span> 
        <span class="n">exacts</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;con&#39;</span><span class="p">:</span><span class="n">yield_df_con</span><span class="p">,</span><span class="s1">&#39;opt&#39;</span><span class="p">:</span><span class="n">yield_df_opt</span><span class="p">},</span> 
        <span class="n">orders</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;con&#39;</span><span class="p">:[</span><span class="s1">&#39;f&#39;</span><span class="p">,</span><span class="s1">&#39;e&#39;</span><span class="p">,</span><span class="s1">&#39;U&#39;</span><span class="p">],</span><span class="s1">&#39;opt&#39;</span><span class="p">:[</span><span class="s1">&#39;e&#39;</span><span class="p">,</span><span class="s1">&#39;U&#39;</span><span class="p">]},</span> 
        <span class="n">add_esufs</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;con&#39;</span><span class="p">:</span><span class="s1">&#39;_con&#39;</span><span class="p">,</span><span class="s1">&#39;opt&#39;</span><span class="p">:</span><span class="s1">&#39;_opt&#39;</span><span class="p">},</span>
        <span class="n">n_strains</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;con&#39;</span><span class="p">:</span><span class="s1">&#39;Strain&#39;</span><span class="p">,</span><span class="s1">&#39;opt&#39;</span><span class="p">:</span><span class="n">dic_used_Strain</span><span class="p">},</span> 
        <span class="n">n_stresss</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;con&#39;</span><span class="p">:</span><span class="s1">&#39;Stress&#39;</span><span class="p">,</span><span class="s1">&#39;opt&#39;</span><span class="p">:</span><span class="s1">&#39;Stress&#39;</span><span class="p">},</span>
        <span class="n">use_exacts</span><span class="o">=</span><span class="kc">True</span>
        <span class="p">)</span>
    <span class="n">tmp</span><span class="o">.</span><span class="n">name</span><span class="o">=</span><span class="n">prot_ser</span><span class="o">.</span><span class="n">name</span>
    <span class="n">out_tab</span><span class="o">=</span><span class="n">out_tab</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tmp</span><span class="p">)</span>
    <span class="n">tmp</span><span class="o">=</span><span class="n">emec</span><span class="o">.</span><span class="n">output</span><span class="o">.</span><span class="n">Otvalgetter_Multi</span><span class="p">(</span>
        <span class="n">messu_FP</span><span class="p">,</span> <span class="n">Vs</span><span class="o">=</span><span class="n">relVS</span><span class="p">,</span>
        <span class="n">datasep</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;con&#39;</span><span class="p">,</span><span class="s1">&#39;opt&#39;</span><span class="p">],</span> 
        <span class="n">VIPs</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;con&#39;</span><span class="p">:</span><span class="n">VIP_messu</span><span class="p">,</span><span class="s1">&#39;opt&#39;</span><span class="p">:</span><span class="n">VIP_dicu</span><span class="p">},</span> 
        <span class="n">exacts</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;con&#39;</span><span class="p">:</span><span class="n">yield_df_con</span><span class="p">,</span><span class="s1">&#39;opt&#39;</span><span class="p">:</span><span class="n">yield_df_opt</span><span class="p">},</span> 
        <span class="n">orders</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;con&#39;</span><span class="p">:[</span><span class="s1">&#39;F&#39;</span><span class="p">,</span><span class="s1">&#39;s&#39;</span><span class="p">,</span><span class="s1">&#39;W&#39;</span><span class="p">],</span><span class="s1">&#39;opt&#39;</span><span class="p">:[</span><span class="s1">&#39;s&#39;</span><span class="p">,</span><span class="s1">&#39;W&#39;</span><span class="p">]},</span> 
        <span class="n">add_esufs</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;con&#39;</span><span class="p">:</span><span class="s1">&#39;_con&#39;</span><span class="p">,</span><span class="s1">&#39;opt&#39;</span><span class="p">:</span><span class="s1">&#39;_opt&#39;</span><span class="p">},</span>
        <span class="n">n_strains</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;con&#39;</span><span class="p">:</span><span class="s1">&#39;Way&#39;</span><span class="p">,</span><span class="s1">&#39;opt&#39;</span><span class="p">:</span> <span class="n">dic_used_Disp</span><span class="p">},</span> 
        <span class="n">n_stresss</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;con&#39;</span><span class="p">:</span><span class="s1">&#39;Force&#39;</span><span class="p">,</span><span class="s1">&#39;opt&#39;</span><span class="p">:</span><span class="s1">&#39;Force&#39;</span><span class="p">},</span>
        <span class="n">use_exacts</span><span class="o">=</span><span class="kc">True</span>
        <span class="p">)</span>
    <span class="n">tmp</span><span class="o">.</span><span class="n">name</span><span class="o">=</span><span class="n">prot_ser</span><span class="o">.</span><span class="n">name</span>
    <span class="n">out_tab</span><span class="o">=</span><span class="n">out_tab</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tmp</span><span class="p">)</span>
    <span class="c1"># ============================================================================</span>
    <span class="c1">#%%% 7.2 Generate plots</span>
    <span class="n">timings</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mf">7.2</span><span class="p">]</span><span class="o">=</span><span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span>
    <span class="n">log_custom</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">   Timing </span><span class="si">%f</span><span class="s2">: </span><span class="si">%.5f</span><span class="s2"> s&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">timings</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span>
                                       <span class="n">timings</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">timings</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span>
                   <span class="o">**</span><span class="n">log_scopt</span><span class="p">)</span>    
        
    <span class="n">fig</span><span class="p">,</span> <span class="n">ax1</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1"> - Analyzing meas. force&#39;</span><span class="o">%</span><span class="n">plt_name</span><span class="p">)</span>
    <span class="n">color1</span> <span class="o">=</span> <span class="s1">&#39;tab:red&#39;</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Time / s&#39;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Force / N&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color1</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">messu</span><span class="o">.</span><span class="n">Time</span><span class="p">,</span> <span class="n">messu</span><span class="o">.</span><span class="n">Force</span><span class="p">,</span> <span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Force&#39;</span><span class="p">)</span>
    <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="n">messu</span><span class="o">.</span><span class="n">Time</span><span class="p">[</span><span class="n">VIP_messu</span><span class="p">],</span><span class="n">messu</span><span class="o">.</span><span class="n">Force</span><span class="p">[</span><span class="n">VIP_messu</span><span class="p">]</span>
    <span class="n">j</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int64</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="s1">&#39;bx&#39;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">VIP_messu</span><span class="o">.</span><span class="n">index</span><span class="p">:</span>
        <span class="n">j</span><span class="o">+=</span><span class="mi">1</span>
        <span class="k">if</span> <span class="n">j</span><span class="o">%</span><span class="mi">2</span><span class="p">:</span> <span class="n">c</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="o">-</span><span class="mi">6</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>   <span class="n">c</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">6</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">x</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">j</span><span class="p">],</span><span class="n">b</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">j</span><span class="p">]),</span> <span class="n">xycoords</span><span class="o">=</span><span class="s1">&#39;data&#39;</span><span class="p">,</span>
                     <span class="n">xytext</span><span class="o">=</span><span class="n">c</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span> <span class="n">textcoords</span><span class="o">=</span><span class="s1">&#39;offset points&#39;</span><span class="p">)</span>
        <span class="c1"># ax1.annotate(&#39;%s&#39; % x, xy=(a.iloc[j],b.iloc[j]), xycoords=&#39;data&#39;,</span>
        <span class="c1">#              xytext=(5, -5), textcoords=&#39;offset points&#39;)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">labelcolor</span><span class="o">=</span><span class="n">color1</span><span class="p">)</span>
    <span class="c1">#ax1.xticks([x for x in range(100) if x%10==0])</span>
    <span class="n">ax2</span> <span class="o">=</span> <span class="n">ax1</span><span class="o">.</span><span class="n">twinx</span><span class="p">()</span>  <span class="c1"># instantiate a second axes that shares the same x-axis</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">color2</span> <span class="o">=</span> <span class="s1">&#39;tab:blue&#39;</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Rise / curve /  (N/s)&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color2</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">messu</span><span class="o">.</span><span class="n">Time</span><span class="p">,</span> <span class="n">messu</span><span class="o">.</span><span class="n">driF</span><span class="p">,</span> <span class="s1">&#39;b:&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Force-rise&#39;</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">messu</span><span class="o">.</span><span class="n">Time</span><span class="p">,</span> <span class="n">messu</span><span class="o">.</span><span class="n">dcuF</span><span class="p">,</span> <span class="s1">&#39;g:&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Force-curve&#39;</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">labelcolor</span><span class="o">=</span><span class="n">color2</span><span class="p">)</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;lower right&#39;</span><span class="p">,</span> <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mf">0.85</span><span class="p">,</span> <span class="mf">0.15</span><span class="p">))</span>
    <span class="n">plt_hsuf</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span><span class="n">path</span><span class="o">=</span><span class="n">out_full</span><span class="o">+</span><span class="s2">&quot;-Fdricu&quot;</span><span class="p">,</span><span class="o">**</span><span class="n">plt_scopt</span><span class="p">)</span>
    
    <span class="k">if</span> <span class="n">_opts</span><span class="p">[</span><span class="s1">&#39;OPT_DIC&#39;</span><span class="p">]:</span>
        <span class="n">fig</span><span class="p">,</span> <span class="n">ax1</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1"> - Stress vs. strain curve of different opt. strain calculations&#39;</span><span class="o">%</span><span class="n">plt_name</span><span class="p">)</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Strain / -&#39;</span><span class="p">)</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Stress / MPa&#39;</span><span class="p">)</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">messu</span><span class="o">.</span><span class="n">loc</span><span class="p">[:</span><span class="n">VIP_messu</span><span class="p">[</span><span class="s1">&#39;B&#39;</span><span class="p">]][</span><span class="s1">&#39;Strain_opt_d_A&#39;</span><span class="p">],</span> 
                 <span class="n">messu</span><span class="o">.</span><span class="n">loc</span><span class="p">[:</span><span class="n">VIP_messu</span><span class="p">[</span><span class="s1">&#39;B&#39;</span><span class="p">]][</span><span class="s1">&#39;Stress&#39;</span><span class="p">],</span> 
                 <span class="s1">&#39;r:&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;displacement A&#39;</span><span class="p">)</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">messu</span><span class="o">.</span><span class="n">loc</span><span class="p">[:</span><span class="n">VIP_messu</span><span class="p">[</span><span class="s1">&#39;B&#39;</span><span class="p">]][</span><span class="s1">&#39;Strain_opt_d_S&#39;</span><span class="p">],</span> 
                 <span class="n">messu</span><span class="o">.</span><span class="n">loc</span><span class="p">[:</span><span class="n">VIP_messu</span><span class="p">[</span><span class="s1">&#39;B&#39;</span><span class="p">]][</span><span class="s1">&#39;Stress&#39;</span><span class="p">],</span> 
                 <span class="s1">&#39;b:&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;displacement S&#39;</span><span class="p">)</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">messu</span><span class="o">.</span><span class="n">loc</span><span class="p">[:</span><span class="n">VIP_messu</span><span class="p">[</span><span class="s1">&#39;B&#39;</span><span class="p">]][</span><span class="s1">&#39;Strain_opt_d_M&#39;</span><span class="p">],</span>
                 <span class="n">messu</span><span class="o">.</span><span class="n">loc</span><span class="p">[:</span><span class="n">VIP_messu</span><span class="p">[</span><span class="s1">&#39;B&#39;</span><span class="p">]][</span><span class="s1">&#39;Stress&#39;</span><span class="p">],</span>
                 <span class="s1">&#39;g:&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;displacement M&#39;</span><span class="p">)</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">messu</span><span class="o">.</span><span class="n">loc</span><span class="p">[:</span><span class="n">VIP_messu</span><span class="p">[</span><span class="s1">&#39;B&#39;</span><span class="p">]][</span><span class="s1">&#39;Strain_opt_c_A&#39;</span><span class="p">],</span>
                 <span class="n">messu</span><span class="o">.</span><span class="n">loc</span><span class="p">[:</span><span class="n">VIP_messu</span><span class="p">[</span><span class="s1">&#39;B&#39;</span><span class="p">]][</span><span class="s1">&#39;Stress&#39;</span><span class="p">],</span>
                 <span class="s1">&#39;r--&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;curvature A&#39;</span><span class="p">)</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">messu</span><span class="o">.</span><span class="n">loc</span><span class="p">[:</span><span class="n">VIP_messu</span><span class="p">[</span><span class="s1">&#39;B&#39;</span><span class="p">]][</span><span class="s1">&#39;Strain_opt_c_S&#39;</span><span class="p">],</span>
                 <span class="n">messu</span><span class="o">.</span><span class="n">loc</span><span class="p">[:</span><span class="n">VIP_messu</span><span class="p">[</span><span class="s1">&#39;B&#39;</span><span class="p">]][</span><span class="s1">&#39;Stress&#39;</span><span class="p">],</span>
                 <span class="s1">&#39;b--&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;curvature S&#39;</span><span class="p">)</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">messu</span><span class="o">.</span><span class="n">loc</span><span class="p">[:</span><span class="n">VIP_messu</span><span class="p">[</span><span class="s1">&#39;B&#39;</span><span class="p">]][</span><span class="s1">&#39;Strain_opt_c_M&#39;</span><span class="p">],</span>
                 <span class="n">messu</span><span class="o">.</span><span class="n">loc</span><span class="p">[:</span><span class="n">VIP_messu</span><span class="p">[</span><span class="s1">&#39;B&#39;</span><span class="p">]][</span><span class="s1">&#39;Stress&#39;</span><span class="p">],</span>
                 <span class="s1">&#39;g--&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;curvature M&#39;</span><span class="p">)</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="p">[</span><span class="mf">0.45</span><span class="p">,</span> <span class="mf">0.135</span><span class="p">])</span>
        <span class="c1"># ftxt=(&#39;$E_{curve}$ = % 8.3f MPa &#39;%(ED2_vgl1),</span>
        <span class="c1">#       &#39;$E_{fork-C}$ = % 8.3f MPa &#39;%(ED2_vgl2),</span>
        <span class="c1">#       &#39;$E_{fork-P}$ = % 8.3f MPa &#39;%(ED2_vgl3),</span>
        <span class="c1">#       &#39;$E_{curve-P4O}$ = % 8.3f MPa &#39;%(ED2_vgl4))</span>
        <span class="c1"># fig.text(0.97,0.15,&#39;\n&#39;.join(ftxt),</span>
        <span class="c1">#          ha=&#39;right&#39;,va=&#39;bottom&#39;, bbox=dict(boxstyle=&#39;round&#39;, edgecolor=&#39;0.8&#39;, facecolor=&#39;white&#39;, alpha=0.8))</span>
        <span class="n">plt_hsuf</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span><span class="n">path</span><span class="o">=</span><span class="n">out_full</span><span class="o">+</span><span class="s2">&quot;-sigeps_dicvgl&quot;</span><span class="p">,</span><span class="o">**</span><span class="n">plt_scopt</span><span class="p">)</span>
    
        <span class="c1"># Pre-Fit -----------------------------------------------------------------</span>
        <span class="n">plot_range_dic</span><span class="o">=</span><span class="n">messu</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span>
            <span class="n">VIP_dicu</span><span class="p">[(</span><span class="n">VIP_dicu</span><span class="p">[[</span><span class="s1">&#39;F1&#39;</span><span class="p">,</span><span class="s1">&#39;F3&#39;</span><span class="p">]])</span><span class="o">.</span><span class="n">idxmin</span><span class="p">()]:</span><span class="n">VIP_dicu</span><span class="p">[(</span><span class="n">VIP_dicu</span><span class="p">[[</span><span class="s1">&#39;F2&#39;</span><span class="p">,</span><span class="s1">&#39;F4&#39;</span><span class="p">]])</span><span class="o">.</span><span class="n">idxmax</span><span class="p">()]</span>
            <span class="p">]</span><span class="o">.</span><span class="n">index</span>
        <span class="n">cbtick</span><span class="o">=</span><span class="n">VIP_dicu</span><span class="o">.</span><span class="n">to_dict</span><span class="p">()</span>
        <span class="n">emeb</span><span class="o">.</span><span class="n">plotting</span><span class="o">.</span><span class="n">colplt_funcs_all</span><span class="p">(</span>
            <span class="n">x</span><span class="o">=</span><span class="n">xlin</span><span class="p">,</span> <span class="n">func_cohort</span><span class="o">=</span><span class="n">bl</span><span class="p">[</span><span class="s1">&#39;w_A&#39;</span><span class="p">],</span>
            <span class="n">params</span><span class="o">=</span><span class="n">Pre_fit_df</span><span class="o">.</span><span class="n">loc</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)[</span><span class="s1">&#39;Fit_params_dict&#39;</span><span class="p">],</span>
            <span class="n">step_range</span><span class="o">=</span><span class="n">plot_range_dic</span><span class="p">,</span> 
            <span class="n">title</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1"> - Fit-full - evaluation range&#39;</span><span class="o">%</span><span class="n">plt_name</span><span class="p">),</span>
            <span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;x / mm&#39;</span><span class="p">,</span>
            <span class="n">Point_df</span><span class="o">=</span><span class="n">P_xcoord_ydisp_meas</span><span class="p">,</span>
            <span class="n">cblabel</span><span class="o">=</span><span class="s1">&#39;VIP&#39;</span><span class="p">,</span> <span class="n">cbtick</span><span class="o">=</span><span class="n">cbtick</span><span class="p">,</span>
            <span class="n">path</span><span class="o">=</span><span class="n">out_full</span><span class="o">+</span><span class="s1">&#39;-DIC_fit-A-eva&#39;</span><span class="p">,</span>
            <span class="n">plt_scopt</span><span class="o">=</span><span class="n">plt_scopt</span>
            <span class="p">)</span>
        <span class="c1"># Bending-Fit -------------------------------------------------------------</span>
        <span class="n">emeb</span><span class="o">.</span><span class="n">plotting</span><span class="o">.</span><span class="n">colplt_funcs_all</span><span class="p">(</span>
            <span class="n">x</span><span class="o">=</span><span class="n">xlin</span><span class="p">,</span> <span class="n">func_cohort</span><span class="o">=</span><span class="n">bl</span><span class="p">[</span><span class="s1">&#39;w_M&#39;</span><span class="p">],</span>
            <span class="n">params</span><span class="o">=</span><span class="n">Bend_fit_df</span><span class="o">.</span><span class="n">loc</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)[</span><span class="s1">&#39;Fit_params_dict&#39;</span><span class="p">],</span>
            <span class="n">step_range</span><span class="o">=</span><span class="n">plot_range_dic</span><span class="p">,</span> 
            <span class="n">title</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1"> - Fit-Bending - evaluation range&#39;</span><span class="o">%</span><span class="n">plt_name</span><span class="p">),</span>
            <span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;x / mm&#39;</span><span class="p">,</span>
            <span class="n">Point_df</span><span class="o">=</span><span class="n">P_xcoord_ydisp_meas_M</span><span class="p">,</span>
            <span class="n">cblabel</span><span class="o">=</span><span class="s1">&#39;VIP&#39;</span><span class="p">,</span> <span class="n">cbtick</span><span class="o">=</span><span class="n">cbtick</span><span class="p">,</span>
            <span class="n">path</span><span class="o">=</span><span class="n">out_full</span><span class="o">+</span><span class="s1">&#39;-DIC_fit-M-eva&#39;</span><span class="p">,</span>
            <span class="n">plt_scopt</span><span class="o">=</span><span class="n">plt_scopt</span>
            <span class="p">)</span>
        <span class="c1"># Pre-Fit -----------------------------------------------------------------</span>
        <span class="n">emeb</span><span class="o">.</span><span class="n">plotting</span><span class="o">.</span><span class="n">colplt_funcs_all</span><span class="p">(</span>
            <span class="n">x</span><span class="o">=</span><span class="n">xlin</span><span class="p">,</span> <span class="n">func_cohort</span><span class="o">=</span><span class="n">bl</span><span class="p">[</span><span class="s1">&#39;w_A&#39;</span><span class="p">],</span>
            <span class="n">params</span><span class="o">=</span><span class="n">Pre_inc_fit_df</span><span class="o">.</span><span class="n">loc</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)[</span><span class="s1">&#39;Fit_params_dict&#39;</span><span class="p">],</span>
            <span class="n">step_range</span><span class="o">=</span><span class="n">plot_range_dic</span><span class="p">,</span> 
            <span class="n">title</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1"> - Incremental Fit-full - evaluation range&#39;</span><span class="o">%</span><span class="n">plt_name</span><span class="p">),</span>
            <span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;x / mm&#39;</span><span class="p">,</span>
            <span class="n">Point_df</span><span class="o">=</span><span class="n">P_xcoord_ydiff_meas</span><span class="p">,</span>
            <span class="n">cblabel</span><span class="o">=</span><span class="s1">&#39;VIP&#39;</span><span class="p">,</span> <span class="n">cbtick</span><span class="o">=</span><span class="n">cbtick</span><span class="p">,</span>
            <span class="n">path</span><span class="o">=</span><span class="n">out_full</span><span class="o">+</span><span class="s1">&#39;-INC_fit-A-eva&#39;</span><span class="p">,</span>
            <span class="n">plt_scopt</span><span class="o">=</span><span class="n">plt_scopt</span>
            <span class="p">)</span>
        <span class="c1"># Bending-Fit -------------------------------------------------------------</span>
        <span class="n">emeb</span><span class="o">.</span><span class="n">plotting</span><span class="o">.</span><span class="n">colplt_funcs_all</span><span class="p">(</span>
            <span class="n">x</span><span class="o">=</span><span class="n">xlin</span><span class="p">,</span> <span class="n">func_cohort</span><span class="o">=</span><span class="n">bl</span><span class="p">[</span><span class="s1">&#39;w_M&#39;</span><span class="p">],</span>
            <span class="n">params</span><span class="o">=</span><span class="n">Bend_inc_fit_df</span><span class="o">.</span><span class="n">loc</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)[</span><span class="s1">&#39;Fit_params_dict&#39;</span><span class="p">],</span>
            <span class="n">step_range</span><span class="o">=</span><span class="n">plot_range_dic</span><span class="p">,</span> 
            <span class="n">title</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1"> - Incremental Fit-Bending - evaluation range&#39;</span><span class="o">%</span><span class="n">plt_name</span><span class="p">),</span>
            <span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;x / mm&#39;</span><span class="p">,</span>
            <span class="n">Point_df</span><span class="o">=</span><span class="n">P_xcoord_ydiff_meas_M</span><span class="p">,</span>
            <span class="n">cblabel</span><span class="o">=</span><span class="s1">&#39;VIP&#39;</span><span class="p">,</span> <span class="n">cbtick</span><span class="o">=</span><span class="n">cbtick</span><span class="p">,</span>
            <span class="n">path</span><span class="o">=</span><span class="n">out_full</span><span class="o">+</span><span class="s1">&#39;-INC_fit-M-eva&#39;</span><span class="p">,</span>
            <span class="n">plt_scopt</span><span class="o">=</span><span class="n">plt_scopt</span>
            <span class="p">)</span>

    <span class="n">fig</span><span class="p">,</span> <span class="n">ax1</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1"> - Stress vs. strain curve with labels&#39;</span><span class="o">%</span><span class="n">plt_name</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Strain / -&#39;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Stress / MPa&#39;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">messu</span><span class="o">.</span><span class="n">loc</span><span class="p">[:</span><span class="n">VIP_messu</span><span class="p">[</span><span class="s1">&#39;B&#39;</span><span class="p">]][</span><span class="s1">&#39;Strain&#39;</span><span class="p">],</span>
             <span class="n">messu</span><span class="o">.</span><span class="n">loc</span><span class="p">[:</span><span class="n">VIP_messu</span><span class="p">[</span><span class="s1">&#39;B&#39;</span><span class="p">]][</span><span class="s1">&#39;Stress&#39;</span><span class="p">],</span> <span class="s1">&#39;r--&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;con&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">_opts</span><span class="p">[</span><span class="s1">&#39;OPT_DIC&#39;</span><span class="p">]:</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">messu</span><span class="o">.</span><span class="n">loc</span><span class="p">[:</span><span class="n">VIP_messu</span><span class="p">[</span><span class="s1">&#39;B&#39;</span><span class="p">]][</span><span class="n">dic_used_Strain</span><span class="p">],</span> 
                 <span class="n">messu</span><span class="o">.</span><span class="n">loc</span><span class="p">[:</span><span class="n">VIP_messu</span><span class="p">[</span><span class="s1">&#39;B&#39;</span><span class="p">]][</span><span class="s1">&#39;Stress&#39;</span><span class="p">],</span> <span class="s1">&#39;m--&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;opt&#39;</span><span class="p">)</span>
    <span class="n">t</span><span class="o">=</span><span class="n">messu</span><span class="o">.</span><span class="n">Strain</span><span class="o">.</span><span class="n">loc</span><span class="p">[[</span><span class="n">VIP_messu</span><span class="p">[</span><span class="s1">&#39;F3&#39;</span><span class="p">]</span> <span class="p">,</span> <span class="n">VIP_messu</span><span class="p">[</span><span class="s1">&#39;F4&#39;</span><span class="p">]]]</span><span class="o">.</span><span class="n">values</span>
    <span class="n">t</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="mf">0.1</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">])),</span>
                <span class="nb">min</span><span class="p">(</span><span class="n">messu</span><span class="o">.</span><span class="n">Strain</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span><span class="n">t</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="mf">0.1</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">]))])</span>
    <span class="c1"># ax1.plot(t, np.polyval(E2_pf_tmp[0][:],t), &#39;g-&#39;,label=&#39;$E_{con}$&#39;)</span>
    <span class="c1"># ax1.plot(t, E2_fit.eval(x=t), &#39;g-&#39;,label=&#39;$E_{con}$&#39;)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">YM_pref_con</span><span class="p">[</span><span class="s1">&#39;E&#39;</span><span class="p">]</span><span class="o">*</span><span class="n">t</span><span class="o">+</span><span class="n">YM_pref_con</span><span class="p">[</span><span class="s1">&#39;E_abs&#39;</span><span class="p">],</span>
             <span class="s1">&#39;g-&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;$E_</span><span class="si">{con}</span><span class="s1">$&#39;</span><span class="p">)</span>
    <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="n">messu</span><span class="o">.</span><span class="n">Strain</span><span class="p">[</span><span class="n">VIP_messu</span><span class="p">[:</span><span class="s1">&#39;B&#39;</span><span class="p">]],</span><span class="n">messu</span><span class="o">.</span><span class="n">Stress</span><span class="p">[</span><span class="n">VIP_messu</span><span class="p">[:</span><span class="s1">&#39;B&#39;</span><span class="p">]]</span>
    <span class="n">j</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int64</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="s1">&#39;bx&#39;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">VIP_messu</span><span class="p">[:</span><span class="s1">&#39;B&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="p">:</span>
        <span class="n">j</span><span class="o">+=</span><span class="mi">1</span>
        <span class="k">if</span> <span class="n">j</span><span class="o">%</span><span class="mi">2</span><span class="p">:</span> <span class="n">c</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="o">-</span><span class="mi">6</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>   <span class="n">c</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">6</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">x</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">j</span><span class="p">],</span><span class="n">b</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">j</span><span class="p">]),</span> <span class="n">xycoords</span><span class="o">=</span><span class="s1">&#39;data&#39;</span><span class="p">,</span>
                      <span class="n">xytext</span><span class="o">=</span><span class="n">c</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span> <span class="n">textcoords</span><span class="o">=</span><span class="s1">&#39;offset points&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">_opts</span><span class="p">[</span><span class="s1">&#39;OPT_DIC&#39;</span><span class="p">]:</span>
        <span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="o">=</span><span class="n">messu</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">VIP_dicu</span><span class="p">[:</span><span class="s1">&#39;B&#39;</span><span class="p">],</span><span class="n">dic_used_Strain</span><span class="p">],</span><span class="n">messu</span><span class="o">.</span><span class="n">Stress</span><span class="p">[</span><span class="n">VIP_dicu</span><span class="p">[:</span><span class="s1">&#39;B&#39;</span><span class="p">]]</span>
        <span class="n">j</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int64</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="s1">&#39;yx&#39;</span><span class="p">)</span>
        <span class="n">t</span><span class="o">=</span><span class="n">messu</span><span class="o">.</span><span class="n">loc</span><span class="p">[[</span><span class="n">VIP_dicu</span><span class="p">[</span><span class="s1">&#39;F3&#39;</span><span class="p">]</span> <span class="p">,</span> <span class="n">VIP_dicu</span><span class="p">[</span><span class="s1">&#39;F4&#39;</span><span class="p">]],</span><span class="n">dic_used_Strain</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
        <span class="n">t</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
            <span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="mf">0.1</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">])),</span>
            <span class="nb">min</span><span class="p">(</span><span class="n">messu</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="n">dic_used_Strain</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span><span class="n">t</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="mf">0.1</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
            <span class="p">])</span>
        <span class="c1"># ax1.plot(t, np.polyval(ED2_pf_tmp[0][:],t), &#39;b-&#39;,label=&#39;$E_{opt}$&#39;)</span>
        <span class="c1"># ax1.plot(t, ED2_fit.eval(x=t), &#39;b-&#39;,label=&#39;$E_{opt}$&#39;)</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">YM_pref_opt</span><span class="p">[</span><span class="s1">&#39;E&#39;</span><span class="p">]</span><span class="o">*</span><span class="n">t</span><span class="o">+</span><span class="n">YM_pref_opt</span><span class="p">[</span><span class="s1">&#39;E_abs&#39;</span><span class="p">],</span>
             <span class="s1">&#39;b-&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;$E_</span><span class="si">{opt}</span><span class="s1">$&#39;</span><span class="p">)</span>
    <span class="n">ftxt</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;$f_</span><span class="si">{y}</span><span class="s1">$ = </span><span class="si">% 6.3f</span><span class="s1"> MPa ($\epsilon_</span><span class="si">{y}</span><span class="s1">$ = </span><span class="si">%4.3f</span><span class="s1"> </span><span class="si">%%</span><span class="s1">)&#39;</span><span class="o">%</span><span class="p">(</span>
            <span class="n">out_tab</span><span class="p">[</span><span class="s1">&#39;fy&#39;</span><span class="p">],</span>
            <span class="n">out_tab</span><span class="p">[</span><span class="s1">&#39;ey_opt&#39;</span><span class="p">]</span><span class="o">*</span><span class="mi">100</span>
            <span class="p">),</span>
          <span class="s1">&#39;$f_</span><span class="si">{u}</span><span class="s1">$ = </span><span class="si">% 6.3f</span><span class="s1"> MPa ($\epsilon_</span><span class="si">{u}</span><span class="s1">$ = </span><span class="si">%4.3f</span><span class="s1"> </span><span class="si">%%</span><span class="s1">)&#39;</span><span class="o">%</span><span class="p">(</span>
            <span class="n">out_tab</span><span class="p">[</span><span class="s1">&#39;fu&#39;</span><span class="p">],</span>
            <span class="n">out_tab</span><span class="p">[</span><span class="s1">&#39;eu_opt&#39;</span><span class="p">]</span><span class="o">*</span><span class="mi">100</span>
            <span class="p">),</span>
          <span class="s1">&#39;$E_</span><span class="si">{con}</span><span class="s1">$ = </span><span class="si">% 8.3f</span><span class="s1"> MPa ($R²$ = </span><span class="si">%4.3f</span><span class="s1">)&#39;</span><span class="o">%</span><span class="p">(</span><span class="o">*</span><span class="n">YM_pref_con</span><span class="p">[[</span><span class="s1">&#39;E&#39;</span><span class="p">,</span><span class="s1">&#39;Rquad&#39;</span><span class="p">]],),</span>
          <span class="s1">&#39;$E_</span><span class="si">{opt}</span><span class="s1">$ = </span><span class="si">% 8.3f</span><span class="s1"> MPa ($R²$ = </span><span class="si">%4.3f</span><span class="s1">)&#39;</span><span class="o">%</span><span class="p">(</span><span class="o">*</span><span class="n">YM_pref_opt</span><span class="p">[[</span><span class="s1">&#39;E&#39;</span><span class="p">,</span><span class="s1">&#39;Rquad&#39;</span><span class="p">]],))</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.95</span><span class="p">,</span><span class="mf">0.15</span><span class="p">,</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">ftxt</span><span class="p">),</span>
              <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">,</span><span class="n">va</span><span class="o">=</span><span class="s1">&#39;bottom&#39;</span><span class="p">,</span> 
              <span class="n">bbox</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">boxstyle</span><span class="o">=</span><span class="s1">&#39;round&#39;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;0.8&#39;</span><span class="p">,</span> 
                        <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">))</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper left&#39;</span><span class="p">,</span> <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mf">0.10</span><span class="p">,</span> <span class="mf">0.91</span><span class="p">))</span>
    <span class="n">plt_hsuf</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span><span class="n">path</span><span class="o">=</span><span class="n">out_full</span><span class="o">+</span><span class="s2">&quot;-sigeps_wl&quot;</span><span class="p">,</span><span class="o">**</span><span class="n">plt_scopt</span><span class="p">)</span>
    
    <span class="n">fig</span><span class="p">,</span> <span class="n">ax1</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1"> - Stress vs. strain curve, final part, with labels&#39;</span><span class="o">%</span><span class="n">plt_name</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Strain / -&#39;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Stress / MPa&#39;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">messu_FP</span><span class="p">[</span><span class="s1">&#39;Strain&#39;</span><span class="p">],</span> <span class="n">messu_FP</span><span class="p">[</span><span class="s1">&#39;Stress&#39;</span><span class="p">],</span> <span class="s1">&#39;r--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;con&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">_opts</span><span class="p">[</span><span class="s1">&#39;OPT_DIC&#39;</span><span class="p">]:</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">messu_FP</span><span class="p">[</span><span class="n">dic_used_Strain</span><span class="p">],</span> <span class="n">messu_FP</span><span class="p">[</span><span class="s1">&#39;Stress&#39;</span><span class="p">],</span> <span class="s1">&#39;m--&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;opt&#39;</span><span class="p">)</span>
    <span class="n">a</span><span class="p">,</span><span class="n">b</span> <span class="o">=</span> <span class="n">emec</span><span class="o">.</span><span class="n">fitting</span><span class="o">.</span><span class="n">stress_linfit_plt</span><span class="p">(</span>
        <span class="n">messu_FP</span><span class="p">[</span><span class="s1">&#39;Strain&#39;</span><span class="p">],</span> <span class="n">VIP_messu</span><span class="p">[[</span><span class="s1">&#39;F3&#39;</span><span class="p">,</span><span class="s1">&#39;F4&#39;</span><span class="p">]],</span> <span class="n">YM_pref_con</span><span class="p">[</span><span class="s1">&#39;E&#39;</span><span class="p">],</span> <span class="mi">0</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="s1">&#39;g-&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;$E_</span><span class="si">{con}</span><span class="s1">$&#39;</span><span class="p">)</span>
    <span class="n">tmp</span><span class="o">=</span><span class="n">VIP_messu</span><span class="p">[[</span><span class="s1">&#39;S&#39;</span><span class="p">,</span><span class="s1">&#39;F3&#39;</span><span class="p">,</span><span class="s1">&#39;F4&#39;</span><span class="p">,</span><span class="s1">&#39;Y&#39;</span><span class="p">,</span><span class="s1">&#39;Y0&#39;</span><span class="p">,</span><span class="s1">&#39;Y1&#39;</span><span class="p">,</span><span class="s1">&#39;U&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">sort_values</span><span class="p">()</span>
    <span class="k">if</span> <span class="s1">&#39;B&#39;</span> <span class="ow">in</span> <span class="n">VIP_messu</span><span class="o">.</span><span class="n">index</span><span class="p">:</span> <span class="n">tmp</span><span class="o">=</span><span class="n">tmp</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">VIP_messu</span><span class="p">[[</span><span class="s1">&#39;B&#39;</span><span class="p">]])</span>
    <span class="n">tmp</span><span class="o">=</span><span class="n">tmp</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">VIP_messu</span><span class="p">[[</span><span class="s1">&#39;E&#39;</span><span class="p">]])</span>
    <span class="n">tmp</span><span class="o">=</span><span class="n">tmp</span><span class="o">.</span><span class="n">sort_values</span><span class="p">()</span>
    <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="n">messu_FP</span><span class="o">.</span><span class="n">Strain</span><span class="p">[</span><span class="n">tmp</span><span class="p">],</span><span class="n">messu_FP</span><span class="o">.</span><span class="n">Stress</span><span class="p">[</span><span class="n">tmp</span><span class="p">]</span>
    <span class="n">j</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int64</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="s1">&#39;bx&#39;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">tmp</span><span class="o">.</span><span class="n">index</span><span class="p">:</span>
        <span class="n">j</span><span class="o">+=</span><span class="mi">1</span>
        <span class="k">if</span> <span class="n">j</span><span class="o">%</span><span class="mi">2</span><span class="p">:</span> <span class="n">c</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="o">-</span><span class="mi">6</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>   <span class="n">c</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">6</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">x</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">j</span><span class="p">],</span><span class="n">b</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">j</span><span class="p">]),</span> <span class="n">xycoords</span><span class="o">=</span><span class="s1">&#39;data&#39;</span><span class="p">,</span> 
                     <span class="n">xytext</span><span class="o">=</span><span class="n">c</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span> <span class="n">textcoords</span><span class="o">=</span><span class="s1">&#39;offset points&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">_opts</span><span class="p">[</span><span class="s1">&#39;OPT_DIC&#39;</span><span class="p">]:</span>
        <span class="n">tmp</span><span class="o">=</span><span class="n">VIP_dicu</span><span class="p">[[</span><span class="s1">&#39;S&#39;</span><span class="p">,</span><span class="s1">&#39;F3&#39;</span><span class="p">,</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">([</span><span class="o">*</span><span class="n">strain_osd</span><span class="o">.</span><span class="n">keys</span><span class="p">()]),</span><span class="s1">&#39;U&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">sort_values</span><span class="p">()</span>
        <span class="k">if</span> <span class="s1">&#39;B&#39;</span> <span class="ow">in</span> <span class="n">VIP_dicu</span><span class="o">.</span><span class="n">index</span><span class="p">:</span> <span class="n">tmp</span><span class="o">=</span><span class="n">tmp</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">VIP_dicu</span><span class="p">[[</span><span class="s1">&#39;B&#39;</span><span class="p">]])</span>
        <span class="n">tmp</span><span class="o">=</span><span class="n">tmp</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">VIP_dicu</span><span class="p">[[</span><span class="s1">&#39;E&#39;</span><span class="p">]])</span>
        <span class="n">tmp</span><span class="o">=</span><span class="n">tmp</span><span class="o">.</span><span class="n">sort_values</span><span class="p">()</span>
        <span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="o">=</span><span class="n">messu_FP</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">tmp</span><span class="p">,</span><span class="n">dic_used_Strain</span><span class="p">],</span><span class="n">messu_FP</span><span class="o">.</span><span class="n">Stress</span><span class="p">[</span><span class="n">tmp</span><span class="p">]</span>
        <span class="n">j</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int64</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="s1">&#39;yx&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">tmp</span><span class="o">.</span><span class="n">index</span><span class="p">:</span>
            <span class="n">j</span><span class="o">+=</span><span class="mi">1</span>
            <span class="k">if</span> <span class="n">j</span><span class="o">%</span><span class="mi">2</span><span class="p">:</span> <span class="n">c</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="o">-</span><span class="mi">6</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>   <span class="n">c</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">6</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span>
            <span class="n">ax1</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">x</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">j</span><span class="p">],</span><span class="n">b</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">j</span><span class="p">]),</span> <span class="n">xycoords</span><span class="o">=</span><span class="s1">&#39;data&#39;</span><span class="p">,</span> 
                         <span class="n">xytext</span><span class="o">=</span><span class="n">c</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span> <span class="n">textcoords</span><span class="o">=</span><span class="s1">&#39;offset points&#39;</span><span class="p">)</span>
        <span class="n">a</span><span class="p">,</span><span class="n">b</span> <span class="o">=</span> <span class="n">emec</span><span class="o">.</span><span class="n">fitting</span><span class="o">.</span><span class="n">stress_linfit_plt</span><span class="p">(</span>
            <span class="n">messu_FP</span><span class="p">[</span><span class="n">dic_used_Strain</span><span class="p">],</span> <span class="n">VIP_dicu</span><span class="p">[[</span><span class="s1">&#39;F3&#39;</span><span class="p">,</span><span class="s1">&#39;F4&#39;</span><span class="p">]],</span> <span class="n">YM_pref_opt</span><span class="p">[</span><span class="s1">&#39;E&#39;</span><span class="p">],</span> <span class="mi">0</span><span class="p">)</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;$E_</span><span class="si">{opt}</span><span class="s1">$&#39;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">plt_hsuf</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span><span class="n">path</span><span class="o">=</span><span class="n">out_full</span><span class="o">+</span><span class="s2">&quot;-sigeps_fin&quot;</span><span class="p">,</span><span class="o">**</span><span class="n">plt_scopt</span><span class="p">)</span>
    
    <span class="n">mun_tmp</span> <span class="o">=</span> <span class="n">messu</span><span class="o">.</span><span class="n">loc</span><span class="p">[:</span><span class="n">VIP_messu</span><span class="p">[</span><span class="s1">&#39;U&#39;</span><span class="p">]]</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">ax1</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1"> - Stress vs. strain curve comparison to selected YM-Methods&#39;</span><span class="o">%</span><span class="n">plt_name</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Strain / -&#39;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Stress / MPa&#39;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">mun_tmp</span><span class="p">[</span><span class="s1">&#39;Strain&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">())</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">mun_tmp</span><span class="p">[</span><span class="s1">&#39;Strain&#39;</span><span class="p">],</span> <span class="n">mun_tmp</span><span class="p">[</span><span class="s1">&#39;Stress&#39;</span><span class="p">],</span> <span class="s1">&#39;r--&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;con&#39;</span><span class="p">)</span>
    <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="n">messu</span><span class="o">.</span><span class="n">Strain</span><span class="p">[</span><span class="n">VIP_messu</span><span class="p">[:</span><span class="s1">&#39;U&#39;</span><span class="p">]],</span><span class="n">messu</span><span class="o">.</span><span class="n">Stress</span><span class="p">[</span><span class="n">VIP_messu</span><span class="p">[:</span><span class="s1">&#39;U&#39;</span><span class="p">]]</span>
    <span class="n">j</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int64</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="s1">&#39;bx&#39;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">VIP_messu</span><span class="p">[:</span><span class="s1">&#39;U&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="p">:</span>
        <span class="n">j</span><span class="o">+=</span><span class="mi">1</span>
        <span class="k">if</span> <span class="n">j</span><span class="o">%</span><span class="mi">2</span><span class="p">:</span> <span class="n">c</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="o">-</span><span class="mi">6</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>   <span class="n">c</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">6</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">x</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">j</span><span class="p">],</span><span class="n">b</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">j</span><span class="p">]),</span> <span class="n">xycoords</span><span class="o">=</span><span class="s1">&#39;data&#39;</span><span class="p">,</span>
                      <span class="n">xytext</span><span class="o">=</span><span class="n">c</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span> <span class="n">textcoords</span><span class="o">=</span><span class="s1">&#39;offset points&#39;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">mun_tmp</span><span class="p">[</span><span class="n">dic_used_Strain</span><span class="p">],</span> <span class="n">mun_tmp</span><span class="p">[</span><span class="s1">&#39;Stress&#39;</span><span class="p">],</span><span class="s1">&#39;m--&#39;</span><span class="p">,</span>
             <span class="n">label</span><span class="o">=</span><span class="s1">&#39;opt </span><span class="si">%s</span><span class="s1">&#39;</span><span class="o">%</span><span class="n">_opts</span><span class="p">[</span><span class="s1">&#39;OPT_YM_Determination_refinement&#39;</span><span class="p">][</span><span class="mi">3</span><span class="p">])</span>
    <span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="o">=</span><span class="n">messu</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">VIP_dicu</span><span class="p">[:</span><span class="s1">&#39;U&#39;</span><span class="p">],</span><span class="n">dic_used_Strain</span><span class="p">],</span><span class="n">messu</span><span class="o">.</span><span class="n">Stress</span><span class="p">[</span><span class="n">VIP_dicu</span><span class="p">[:</span><span class="s1">&#39;U&#39;</span><span class="p">]]</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="s1">&#39;yx&#39;</span><span class="p">)</span>    
    <span class="n">t</span> <span class="o">=</span> <span class="n">mun_tmp</span><span class="o">.</span><span class="n">Stress</span> <span class="o">/</span> <span class="n">E_Methods_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">mun_tmp</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="mi">1</span><span class="p">:]][</span><span class="s1">&#39;A0Al&#39;</span><span class="p">]</span>
    <span class="n">tra</span> <span class="o">=</span> <span class="n">emec</span><span class="o">.</span><span class="n">fitting</span><span class="o">.</span><span class="n">Rquad</span><span class="p">(</span><span class="n">mun_tmp</span><span class="o">.</span><span class="n">Strain</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span>
    <span class="n">trf</span> <span class="o">=</span> <span class="n">emec</span><span class="o">.</span><span class="n">fitting</span><span class="o">.</span><span class="n">Rquad</span><span class="p">(</span><span class="n">mun_tmp</span><span class="o">.</span><span class="n">Strain</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">sf_eva_con</span><span class="p">],</span> 
                             <span class="n">t</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">sf_eva_con</span><span class="p">])</span>
    <span class="n">trr</span> <span class="o">=</span> <span class="n">emec</span><span class="o">.</span><span class="n">fitting</span><span class="o">.</span><span class="n">Rquad</span><span class="p">(</span><span class="n">mun_tmp</span><span class="o">.</span><span class="n">Strain</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">sr_eva_con</span><span class="p">],</span> 
                             <span class="n">t</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">sr_eva_con</span><span class="p">])</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">mun_tmp</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">t</span><span class="o">.</span><span class="n">index</span><span class="p">][</span><span class="s1">&#39;Stress&#39;</span><span class="p">],</span> <span class="s1">&#39;r:&#39;</span><span class="p">,</span>
             <span class="n">label</span><span class="o">=</span><span class="s1">&#39;A0Al </span><span class="si">%1.4f</span><span class="s1">|</span><span class="si">%1.4f</span><span class="s1">|</span><span class="si">%1.4f</span><span class="s1">&#39;</span><span class="o">%</span><span class="p">(</span><span class="n">tra</span><span class="p">,</span><span class="n">trf</span><span class="p">,</span><span class="n">trr</span><span class="p">))</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">mun_tmp</span><span class="o">.</span><span class="n">Stress</span> <span class="o">/</span> <span class="n">E_Methods_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">mun_tmp</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="mi">1</span><span class="p">:]][</span><span class="s1">&#39;B2Ml&#39;</span><span class="p">]</span>
    <span class="n">tra</span> <span class="o">=</span> <span class="n">emec</span><span class="o">.</span><span class="n">fitting</span><span class="o">.</span><span class="n">Rquad</span><span class="p">(</span><span class="n">mun_tmp</span><span class="p">[</span><span class="n">dic_used_Strain</span><span class="p">],</span> <span class="n">t</span><span class="p">)</span>
    <span class="n">trf</span> <span class="o">=</span> <span class="n">emec</span><span class="o">.</span><span class="n">fitting</span><span class="o">.</span><span class="n">Rquad</span><span class="p">(</span><span class="n">mun_tmp</span><span class="p">[</span><span class="n">dic_used_Strain</span><span class="p">]</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">sf_eva_dic</span><span class="p">],</span>
                             <span class="n">t</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">sf_eva_dic</span><span class="p">])</span>
    <span class="n">trr</span> <span class="o">=</span> <span class="n">emec</span><span class="o">.</span><span class="n">fitting</span><span class="o">.</span><span class="n">Rquad</span><span class="p">(</span><span class="n">mun_tmp</span><span class="p">[</span><span class="n">dic_used_Strain</span><span class="p">]</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">sr_eva_dic</span><span class="p">],</span> 
                             <span class="n">t</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">sr_eva_dic</span><span class="p">])</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">mun_tmp</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">t</span><span class="o">.</span><span class="n">index</span><span class="p">][</span><span class="s1">&#39;Stress&#39;</span><span class="p">],</span> <span class="s1">&#39;y:&#39;</span><span class="p">,</span>
             <span class="n">label</span><span class="o">=</span><span class="s1">&#39;B2Ml </span><span class="si">%1.4f</span><span class="s1">|</span><span class="si">%1.4f</span><span class="s1">|</span><span class="si">%1.4f</span><span class="s1">&#39;</span><span class="o">%</span><span class="p">(</span><span class="n">tra</span><span class="p">,</span><span class="n">trf</span><span class="p">,</span><span class="n">trr</span><span class="p">))</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">mun_tmp</span><span class="o">.</span><span class="n">Stress</span> <span class="o">/</span> <span class="n">E_Methods_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">mun_tmp</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="mi">1</span><span class="p">:]][</span><span class="s1">&#39;E4Mg&#39;</span><span class="p">]</span>
    <span class="n">tra</span> <span class="o">=</span> <span class="n">emec</span><span class="o">.</span><span class="n">fitting</span><span class="o">.</span><span class="n">Rquad</span><span class="p">(</span><span class="n">mun_tmp</span><span class="p">[</span><span class="n">dic_used_Strain</span><span class="p">],</span> <span class="n">t</span><span class="p">)</span>
    <span class="n">trf</span> <span class="o">=</span> <span class="n">emec</span><span class="o">.</span><span class="n">fitting</span><span class="o">.</span><span class="n">Rquad</span><span class="p">(</span><span class="n">mun_tmp</span><span class="p">[</span><span class="n">dic_used_Strain</span><span class="p">]</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">sf_eva_dic</span><span class="p">],</span> 
                             <span class="n">t</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">sf_eva_dic</span><span class="p">])</span>
    <span class="n">trr</span> <span class="o">=</span> <span class="n">emec</span><span class="o">.</span><span class="n">fitting</span><span class="o">.</span><span class="n">Rquad</span><span class="p">(</span><span class="n">mun_tmp</span><span class="p">[</span><span class="n">dic_used_Strain</span><span class="p">]</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">sr_eva_dic</span><span class="p">],</span> 
                             <span class="n">t</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">sr_eva_dic</span><span class="p">])</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">mun_tmp</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">t</span><span class="o">.</span><span class="n">index</span><span class="p">][</span><span class="s1">&#39;Stress&#39;</span><span class="p">],</span> <span class="s1">&#39;m:&#39;</span><span class="p">,</span>
             <span class="n">label</span><span class="o">=</span><span class="s1">&#39;E4Mg </span><span class="si">%1.4f</span><span class="s1">|</span><span class="si">%1.4f</span><span class="s1">|</span><span class="si">%1.4f</span><span class="s1">&#39;</span><span class="o">%</span><span class="p">(</span><span class="n">tra</span><span class="p">,</span><span class="n">trf</span><span class="p">,</span><span class="n">trr</span><span class="p">))</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">mun_tmp</span><span class="o">.</span><span class="n">Stress</span> <span class="o">/</span> <span class="n">E_Methods_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">mun_tmp</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="mi">1</span><span class="p">:]][</span><span class="s1">&#39;G3Mg&#39;</span><span class="p">]</span>
    <span class="n">tra</span> <span class="o">=</span> <span class="n">emec</span><span class="o">.</span><span class="n">fitting</span><span class="o">.</span><span class="n">Rquad</span><span class="p">(</span><span class="n">mun_tmp</span><span class="p">[</span><span class="n">dic_used_Strain</span><span class="p">],</span> <span class="n">t</span><span class="p">)</span>
    <span class="n">trf</span> <span class="o">=</span> <span class="n">emec</span><span class="o">.</span><span class="n">fitting</span><span class="o">.</span><span class="n">Rquad</span><span class="p">(</span><span class="n">mun_tmp</span><span class="p">[</span><span class="n">dic_used_Strain</span><span class="p">]</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">sf_eva_dic</span><span class="p">],</span>
                             <span class="n">t</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">sf_eva_dic</span><span class="p">])</span>
    <span class="n">trr</span> <span class="o">=</span> <span class="n">emec</span><span class="o">.</span><span class="n">fitting</span><span class="o">.</span><span class="n">Rquad</span><span class="p">(</span><span class="n">mun_tmp</span><span class="p">[</span><span class="n">dic_used_Strain</span><span class="p">]</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">sr_eva_dic</span><span class="p">],</span> 
                             <span class="n">t</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">sr_eva_dic</span><span class="p">])</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">mun_tmp</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">t</span><span class="o">.</span><span class="n">index</span><span class="p">][</span><span class="s1">&#39;Stress&#39;</span><span class="p">],</span> <span class="s1">&#39;b:&#39;</span><span class="p">,</span>
             <span class="n">label</span><span class="o">=</span><span class="s1">&#39;G3Mg </span><span class="si">%1.4f</span><span class="s1">|</span><span class="si">%1.4f</span><span class="s1">|</span><span class="si">%1.4f</span><span class="s1">&#39;</span><span class="o">%</span><span class="p">(</span><span class="n">tra</span><span class="p">,</span><span class="n">trf</span><span class="p">,</span><span class="n">trr</span><span class="p">))</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">mun_tmp</span><span class="o">.</span><span class="n">Stress</span> <span class="o">/</span> <span class="n">E_Methods_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">mun_tmp</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="mi">1</span><span class="p">:]][</span><span class="s1">&#39;D2Mgwt&#39;</span><span class="p">]</span>
    <span class="n">tra</span> <span class="o">=</span> <span class="n">emec</span><span class="o">.</span><span class="n">fitting</span><span class="o">.</span><span class="n">Rquad</span><span class="p">(</span><span class="n">mun_tmp</span><span class="p">[</span><span class="n">dic_used_Strain</span><span class="p">],</span> <span class="n">t</span><span class="p">)</span>
    <span class="n">trf</span> <span class="o">=</span> <span class="n">emec</span><span class="o">.</span><span class="n">fitting</span><span class="o">.</span><span class="n">Rquad</span><span class="p">(</span><span class="n">mun_tmp</span><span class="p">[</span><span class="n">dic_used_Strain</span><span class="p">]</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">sf_eva_dic</span><span class="p">],</span> 
                             <span class="n">t</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">sf_eva_dic</span><span class="p">])</span>
    <span class="n">trr</span> <span class="o">=</span> <span class="n">emec</span><span class="o">.</span><span class="n">fitting</span><span class="o">.</span><span class="n">Rquad</span><span class="p">(</span><span class="n">mun_tmp</span><span class="p">[</span><span class="n">dic_used_Strain</span><span class="p">]</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">sr_eva_dic</span><span class="p">],</span> 
                             <span class="n">t</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">sr_eva_dic</span><span class="p">])</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">mun_tmp</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">t</span><span class="o">.</span><span class="n">index</span><span class="p">][</span><span class="s1">&#39;Stress&#39;</span><span class="p">],</span> <span class="s1">&#39;g:&#39;</span><span class="p">,</span>
             <span class="n">label</span><span class="o">=</span><span class="s1">&#39;D2Mgwt </span><span class="si">%1.4f</span><span class="s1">|</span><span class="si">%1.4f</span><span class="s1">|</span><span class="si">%1.4f</span><span class="s1">&#39;</span><span class="o">%</span><span class="p">(</span><span class="n">tra</span><span class="p">,</span><span class="n">trf</span><span class="p">,</span><span class="n">trr</span><span class="p">))</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">plt_hsuf</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span><span class="n">path</span><span class="o">=</span><span class="n">out_full</span><span class="o">+</span><span class="s2">&quot;-sigeps_YMcomp&quot;</span><span class="p">,</span><span class="o">**</span><span class="n">plt_scopt</span><span class="p">)</span>

    <span class="c1"># =============================================================================</span>
    <span class="c1">#%%% 7.3 Generate outputs</span>
    <span class="n">timings</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mf">7.3</span><span class="p">]</span><span class="o">=</span><span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span>
    <span class="n">log_custom</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">   Timing </span><span class="si">%f</span><span class="s2">: </span><span class="si">%.5f</span><span class="s2"> s&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">timings</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span>
                                       <span class="n">timings</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">timings</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span>
                   <span class="o">**</span><span class="n">log_scopt</span><span class="p">)</span>    
    
    
    <span class="n">t</span><span class="o">=</span><span class="n">E_lsq</span><span class="o">.</span><span class="n">loc</span><span class="p">[[</span><span class="s1">&#39;E&#39;</span><span class="p">,</span><span class="s1">&#39;Rquad&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">stack</span><span class="p">()</span>
    <span class="n">t</span><span class="o">.</span><span class="n">index</span><span class="o">=</span><span class="n">t</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">to_series</span><span class="p">()</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="s1">&#39;</span><span class="si">{0}</span><span class="s1">_</span><span class="si">{1}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="o">*</span><span class="n">x</span><span class="p">))</span><span class="o">.</span><span class="n">values</span>
    <span class="n">t</span><span class="o">.</span><span class="n">name</span><span class="o">=</span><span class="n">prot_ser</span><span class="o">.</span><span class="n">name</span>
    <span class="n">out_tab</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">out_tab</span><span class="p">,</span><span class="n">t</span><span class="p">])</span>
    
    <span class="n">t</span><span class="o">=</span><span class="n">E_inc_F_comp</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">stack</span><span class="p">()</span>
    <span class="n">t</span><span class="o">.</span><span class="n">index</span><span class="o">=</span><span class="n">t</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">to_series</span><span class="p">()</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="s1">&#39;</span><span class="si">{0}</span><span class="s1">_</span><span class="si">{1}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="o">*</span><span class="n">x</span><span class="p">))</span><span class="o">.</span><span class="n">values</span>
    <span class="n">t</span><span class="o">.</span><span class="n">name</span><span class="o">=</span><span class="n">prot_ser</span><span class="o">.</span><span class="n">name</span>
    <span class="n">t</span><span class="o">=</span><span class="n">t</span><span class="o">.</span><span class="n">add_prefix</span><span class="p">(</span><span class="s1">&#39;E_inc_F_&#39;</span><span class="p">)</span>
    <span class="n">out_tab</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">out_tab</span><span class="p">,</span><span class="n">t</span><span class="p">])</span>

    <span class="n">t</span><span class="o">=</span><span class="n">E_inc_R_comp</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">stack</span><span class="p">()</span>
    <span class="n">t</span><span class="o">.</span><span class="n">index</span><span class="o">=</span><span class="n">t</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">to_series</span><span class="p">()</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="s1">&#39;</span><span class="si">{0}</span><span class="s1">_</span><span class="si">{1}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="o">*</span><span class="n">x</span><span class="p">))</span><span class="o">.</span><span class="n">values</span>
    <span class="n">t</span><span class="o">.</span><span class="n">name</span><span class="o">=</span><span class="n">prot_ser</span><span class="o">.</span><span class="n">name</span>
    <span class="n">t</span><span class="o">=</span><span class="n">t</span><span class="o">.</span><span class="n">add_prefix</span><span class="p">(</span><span class="s1">&#39;E_inc_R_&#39;</span><span class="p">)</span>
    <span class="n">out_tab</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">out_tab</span><span class="p">,</span><span class="n">t</span><span class="p">])</span>
    
    <span class="n">t</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">Check_to_D</span><span class="p">[</span><span class="s1">&#39;AtoD_g&#39;</span><span class="p">],</span><span class="n">Check_to_D</span><span class="p">[</span><span class="s1">&#39;StoD_g&#39;</span><span class="p">],</span>
                   <span class="n">Check_to_D</span><span class="p">[</span><span class="s1">&#39;MtoD_g&#39;</span><span class="p">]],</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">add_prefix</span><span class="p">(</span><span class="s1">&#39;Check_g_&#39;</span><span class="p">)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">name</span><span class="o">=</span><span class="n">prot_ser</span><span class="o">.</span><span class="n">name</span>
    <span class="n">t2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">Check_to_D</span><span class="p">[</span><span class="s1">&#39;AtoD_x&#39;</span><span class="p">],</span><span class="n">Check_to_D</span><span class="p">[</span><span class="s1">&#39;StoD_x&#39;</span><span class="p">],</span>
                    <span class="n">Check_to_D</span><span class="p">[</span><span class="s1">&#39;MtoD_x&#39;</span><span class="p">]],</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
    <span class="n">t2</span> <span class="o">=</span> <span class="n">t2</span><span class="o">.</span><span class="n">add_prefix</span><span class="p">(</span><span class="s1">&#39;Check_l_&#39;</span><span class="p">)</span>
    <span class="n">t2</span><span class="o">.</span><span class="n">name</span><span class="o">=</span><span class="n">prot_ser</span><span class="o">.</span><span class="n">name</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">t</span><span class="p">,</span><span class="n">t2</span><span class="p">])</span>
    <span class="n">out_tab</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">out_tab</span><span class="p">,</span><span class="n">t</span><span class="p">])</span>
    
    <span class="n">out_tab</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([</span><span class="n">out_tab</span><span class="p">])</span>

    <span class="n">vnew</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">VIP_messu</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">()</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
                   <span class="n">index</span><span class="o">=</span><span class="n">VIP_messu</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">(),</span><span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;O&#39;</span><span class="p">)</span>
    <span class="n">VIP_messu</span><span class="o">=</span><span class="n">VIP_messu</span><span class="o">.</span><span class="n">sort_values</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">VIP_messu</span><span class="o">.</span><span class="n">index</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">VIP_messu</span><span class="o">.</span><span class="n">duplicated</span><span class="p">()</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
            <span class="n">vnew</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">VIP_messu</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span><span class="o">=</span><span class="n">vnew</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">VIP_messu</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span><span class="o">+</span><span class="s1">&#39;,&#39;</span><span class="o">+</span><span class="n">i</span>
    <span class="n">messu</span><span class="p">[</span><span class="s1">&#39;VIP_m&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">vnew</span>
    <span class="n">messu</span><span class="o">.</span><span class="n">VIP_m</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    
    <span class="n">vnew</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">VIP_dicu</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">()</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
                   <span class="n">index</span><span class="o">=</span><span class="n">VIP_dicu</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">(),</span><span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;O&#39;</span><span class="p">)</span>
    <span class="n">VIP_dicu</span><span class="o">=</span><span class="n">VIP_dicu</span><span class="o">.</span><span class="n">sort_values</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">VIP_dicu</span><span class="o">.</span><span class="n">index</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">VIP_dicu</span><span class="o">.</span><span class="n">duplicated</span><span class="p">()</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
            <span class="n">vnew</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">VIP_dicu</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span><span class="o">=</span><span class="n">vnew</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">VIP_dicu</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span><span class="o">+</span><span class="s1">&#39;,&#39;</span><span class="o">+</span><span class="n">i</span>
    <span class="n">messu</span><span class="p">[</span><span class="s1">&#39;VIP_d&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">vnew</span>
    <span class="n">messu</span><span class="o">.</span><span class="n">VIP_d</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    
    <span class="n">messu</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">out_full</span><span class="o">+</span><span class="s1">&#39;.csv&#39;</span><span class="p">,</span><span class="n">sep</span><span class="o">=</span><span class="s1">&#39;;&#39;</span><span class="p">)</span>   
    <span class="n">out_tab</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">out_full</span><span class="o">+</span><span class="s1">&#39;-Mat.csv&#39;</span><span class="p">,</span><span class="n">sep</span><span class="o">=</span><span class="s1">&#39;;&#39;</span><span class="p">)</span>
    
    <span class="n">HDFst</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">HDFStore</span><span class="p">(</span><span class="n">out_full</span><span class="o">+</span><span class="s1">&#39;.h5&#39;</span><span class="p">)</span>
    <span class="n">HDFst</span><span class="p">[</span><span class="s1">&#39;Measurement&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">messu</span>
    <span class="n">HDFst</span><span class="p">[</span><span class="s1">&#39;Measurement_FP&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">messu_FP</span>
    <span class="n">HDFst</span><span class="p">[</span><span class="s1">&#39;Material_Parameters&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">out_tab</span>
    <span class="n">HDFst</span><span class="p">[</span><span class="s1">&#39;Geometrie_functions&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">({</span>
        <span class="s1">&#39;func_t&#39;</span><span class="p">:</span> <span class="n">func_t</span><span class="p">,</span><span class="s1">&#39;func_w&#39;</span><span class="p">:</span> <span class="n">func_w</span><span class="p">,</span> 
        <span class="s1">&#39;func_A&#39;</span><span class="p">:</span> <span class="n">func_A</span><span class="p">,</span> <span class="s1">&#39;func_I&#39;</span><span class="p">:</span> <span class="n">func_I</span>
        <span class="p">})</span>
    <span class="n">HDFst</span><span class="p">[</span><span class="s1">&#39;Timings&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">timings</span>
    
    <span class="c1"># HDFst[&#39;Bending_Legion&#39;] = bl</span>
    <span class="n">HDFst</span><span class="p">[</span><span class="s1">&#39;Opt_Geo_Fit&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">geo_fit</span>
    <span class="n">HDFst</span><span class="p">[</span><span class="s1">&#39;Opt_Pre_Fit&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Pre_fit_df</span>
    <span class="n">HDFst</span><span class="p">[</span><span class="s1">&#39;Opt_Bend_Fit&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Bend_fit_df</span>
    <span class="n">HDFst</span><span class="p">[</span><span class="s1">&#39;Inc_Pre_Fit&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Pre_inc_fit_df</span>
    <span class="n">HDFst</span><span class="p">[</span><span class="s1">&#39;Inc_Bend_Fit&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Bend_inc_fit_df</span>
    
    <span class="n">HDFst</span><span class="p">[</span><span class="s1">&#39;Points_transformed&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Points_T_stacked</span>
    <span class="n">HDFst</span><span class="p">[</span><span class="s1">&#39;Points_lot_transformed&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Points_L_T_stacked</span>
    <span class="n">HDFst</span><span class="p">[</span><span class="s1">&#39;Points_A_disp&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">P_xcoord_ydisp</span>
    <span class="n">HDFst</span><span class="p">[</span><span class="s1">&#39;Points_S_disp&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">P_xcoord_ydisp_meas_S</span>
    <span class="n">HDFst</span><span class="p">[</span><span class="s1">&#39;Points_M_disp&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">P_xcoord_ydisp_meas_M</span>
    <span class="n">HDFst</span><span class="p">[</span><span class="s1">&#39;Points_A_diff&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">P_xcoord_ydiff</span>
    <span class="n">HDFst</span><span class="p">[</span><span class="s1">&#39;Points_S_diff&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">P_xcoord_ydiff_meas_S</span>
    <span class="n">HDFst</span><span class="p">[</span><span class="s1">&#39;Points_M_diff&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">P_xcoord_ydiff_meas_M</span>
    
    <span class="n">HDFst</span><span class="p">[</span><span class="s1">&#39;VIP&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">VIP_messu</span><span class="p">,</span><span class="n">VIP_dicu</span><span class="p">],</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    
    <span class="n">HDFst</span><span class="p">[</span><span class="s1">&#39;Exact_VIP_con&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">yield_df_con</span>
    <span class="n">HDFst</span><span class="p">[</span><span class="s1">&#39;Exact_VIP_opt&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">yield_df_opt</span>
    
    <span class="n">HDFst</span><span class="p">[</span><span class="s1">&#39;DQcon&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">DQcon</span>
    <span class="n">HDFst</span><span class="p">[</span><span class="s1">&#39;DQopt&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">DQopt</span>
    
    <span class="n">HDFst</span><span class="p">[</span><span class="s1">&#39;E_lsq&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">E_lsq</span>
    <span class="n">HDFst</span><span class="p">[</span><span class="s1">&#39;E_inc_df&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">E_Methods_df</span>
    <span class="n">HDFst</span><span class="p">[</span><span class="s1">&#39;E_inc&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">E_inc_F_comp</span><span class="o">.</span><span class="n">add_prefix</span><span class="p">(</span><span class="s1">&#39;E_inc_F_&#39;</span><span class="p">),</span>
                                <span class="n">E_inc_R_comp</span><span class="o">.</span><span class="n">add_prefix</span><span class="p">(</span><span class="s1">&#39;E_inc_R_&#39;</span><span class="p">)],</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">HDFst</span><span class="p">[</span><span class="s1">&#39;Check_to_D&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Check_to_D</span>
    
    <span class="n">HDFst</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    
    <span class="n">timings</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mf">10.0</span><span class="p">]</span><span class="o">=</span><span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">log_scopt</span><span class="p">[</span><span class="s1">&#39;output_lvl&#39;</span><span class="p">]</span><span class="o">&gt;=</span><span class="mi">1</span><span class="p">:</span>
        <span class="n">log_scopt</span><span class="p">[</span><span class="s1">&#39;logfp&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="n">log_scopt</span><span class="p">[</span><span class="s1">&#39;logfp&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span> <span class="c1"># workaround (Error _io.TextIOWrapper while series run)</span>
    
    <span class="k">return</span> <span class="n">timings</span><span class="p">,</span> <span class="n">cout</span></div>
</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, MarcGebhardt.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>